<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.17" id="1">
    <property name="createdBy">Eclipse BIRT Designer Version 2.3.2.r232_20090202 Build &lt;2.3.2.v20090218-0730></property>
    <property name="units">in</property>
    <property name="comments">IBM Confidential

OCO Source Materials

5724-M19

(C) COPYRIGHT IBM CORP. 2006

The source code for this program is not published or otherwise
divested of its trade secrets, irrespective of what has been
deposited with the U.S. Copyright Office.</property>
    <html-property name="description">This template will create a report with one or more groups, each having identical data fields, and contains three styles of charts.</html-property>
    <list-property name="userProperties">
        <structure>
            <property name="name">Data Cube.11.x</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.11.y</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
    </list-property>
    <property name="Data Cube.11.x">135</property>
    <property name="Data Cube.11.y">80</property>
    <method name="initialize"><![CDATA[importPackage(Packages.com.ibm.tivoli.maximo.report.script);

mxReportScriptContext = MXReportScriptContext.initialize(reportContext);


mxReportScriptContext = MXReportScriptContext.initialize(reportContext);
mxReportScriptContext.setDefaultLogLevel("DEBUG");
mxReportScriptContext.setDefaultLogFile("c:/temp/tetttt.txt");
]]></method>
    <method name="afterFactory"><![CDATA[MXReportScriptContext.close();]]></method>
    <property name="theme">MaximoSystemLibrary.maximoTheme</property>
    <text-property name="displayName">Tivoli Maximo Grouped Chart Template</text-property>
    <list-property name="libraries">
        <structure>
            <property name="fileName">MaximoSystemLibrary.rptlibrary</property>
            <property name="namespace">MaximoSystemLibrary</property>
        </structure>
    </list-property>
    <parameters>
        <scalar-parameter name="where" id="25">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <property name="defaultValue">1=1</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="appname" id="240">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="mroSite" id="7964">
            <property name="valueType">static</property>
            <property name="dataType">integer</property>
            <property name="paramType">simple</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="podr" id="12531">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <text-property name="promptText">Подразделение</text-property>
            <property name="isRequired">true</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="osmotr" id="12532">
            <text-property name="helpText">1 или 2</text-property>
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <text-property name="promptText">Тип осмотра</text-property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="asset" id="13069">
            <text-property name="helpText">При значении 1, выводится стартовая страница</text-property>
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <text-property name="promptText">Актив</text-property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <property name="defaultValue">1</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="km" id="13070">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <text-property name="promptText">Километр</text-property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="year" id="13264">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <text-property name="promptText">Год</text-property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="tip_p" id="13277">
            <text-property name="helpText">(1- бесстыковой, 2 - звеньевой, 3 - смешанный)</text-property>
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <text-property name="promptText">Тип пути</text-property>
            <property name="isRequired">true</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <script-data-source name="maximoDataSource" id="64" extends="MaximoSystemLibrary.maximoDataSource"/>
    </data-sources>
    <data-sets>
        <script-data-set name="11" id="7971">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">ASSETNUM</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">WONUM</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">KM</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">ZVENO</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">ASSETATTRID</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">NUMVALUE</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">7</property>
                    <property name="name">NUM</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">8</property>
                    <property name="name">ED_IZM</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">9</property>
                    <property name="name">NUM_SORT</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">10</property>
                    <property name="name">TEMP</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">11</property>
                    <property name="name">N_PUT</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">PREZIDENT</property>
                </structure>
                <structure>
                    <property name="columnName">ST_DAY</property>
                </structure>
                <structure>
                    <property name="columnName">INSPECSTART</property>
                </structure>
                <structure>
                    <property name="columnName">ST_MONTH</property>
                </structure>
                <structure>
                    <property name="columnName">INSPECSTOP</property>
                </structure>
                <structure>
                    <property name="columnName">MON</property>
                </structure>
                <structure>
                    <property name="columnName">ROUTE_LOC_NOM</property>
                </structure>
                <structure>
                    <property name="columnName">ASSETNUM</property>
                </structure>
                <structure>
                    <property name="columnName">WONUM</property>
                </structure>
                <structure>
                    <property name="columnName">KM</property>
                </structure>
                <structure>
                    <property name="columnName">ZVENO</property>
                </structure>
                <structure>
                    <property name="columnName">ASSETATTRID</property>
                </structure>
                <structure>
                    <property name="columnName">NUMVALUE</property>
                </structure>
                <structure>
                    <property name="columnName">NUM</property>
                </structure>
                <structure>
                    <property name="columnName">ED_IZM</property>
                </structure>
                <structure>
                    <property name="columnName">NUM_SORT</property>
                </structure>
                <structure>
                    <property name="columnName">TEMP</property>
                </structure>
                <structure>
                    <property name="columnName">N_PUT</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">ASSETNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">WONUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">KM</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">ZVENO</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">ASSETATTRID</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">NUMVALUE</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">NUM</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">ED_IZM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">NUM_SORT</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">10</property>
                        <property name="name">TEMP</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">11</property>
                        <property name="name">N_PUT</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[maximoDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());
maximoDataSet.open();

//if(params["date2"]=='' || params["date2"] == null || params["date2"] == '""' )
//{params["date2"]=  "sysdate";}
//else if(params["date2"]!='')
//{params["date2"]=  "'"+params["date2"]+"'";}

params["tip_p"]=params["tip_p"].replace("=","");

if(params["tip_p"]=='1')
{tip_p = "170, 200";}
if(params["tip_p"]=='2')
{tip_p = "171, 172, 200";}
if(params["tip_p"]=='3')
{tip_p = "170, 171, 172, 200";}


params["podr"]=params["podr"].replace("=","");
params["asset"]=params["asset"].replace("=","");
params["osmotr"] = (params["osmotr"]).replace("=","");

if(params["year"]=='' || params["year"] == null || params["year"] == '""' )
params["year"]=BirtDateTime.year(BirtDateTime.now());

var sqlText = new String();

sqlText = " "     
  +" WITH defect AS "
 +"      (SELECT wo.pmnum "
 +" 	,ast.assetnum "
 +" 	,wo.wonum "
 +" 	,mal_i.MEASUREKM km "
 +" 	,point.element zveno "
 +" 	,POINT_SPC.ASSETATTRID "
 +" 	,CASE  "
 +" 		WHEN 1 =" + params["osmotr"]
 +" 			THEN CASE  "
 +" 					WHEN DC.CLASSSTRUCTUREID = '010002000100' "
 +" 						THEN CASE  "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'DEFECT_PRUGIN_RELS_SOEDINITEL' "
 +" 										,'DEFECT_SHTEPSELNY_RELS_SOEDINITEL' "
 +" 										,'DEFECT_PRIVARNOY_RELS_SOEDINITEL' "
 +" 										,'OTSUT_PRUGIN_RELS_SOEDINITEL' "
 +" 										,'OTSUT_PRIVARN_RELS_SOEDINITEL' "
 +" 										,'OTSUT_SHTEPSEL_RELS_SOEDINITEL' "
 +" 										) "
 +" 									THEN '21Требуется  приварить  соединителей весной' "
 +" 								WHEN point_spc.assetattrid IN ('NEDOST_KOLICHESTVO_STYK_BOLT') "
 +" 									THEN '31Недостает стыковых болтов весной' "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'NEGOD_PODREL_PROKLADKI' "
 +" 										,'OTSUT_PODREL_PROKLADKI' "
 +" 										) "
 +" 									THEN '41Требуется заменить подрельсовой прокладки весной' "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'NEGOD_PROKLADKI_POD_PODKLADK' "
 +" 										,'OTSUT_PROKLADKI_POD_PODKLADK' "
 +" 										) "
 +" 									THEN '51Требуется заменить нашпальной прокладки весной' "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'DEFECT_PODKLADKI' "
 +" 										,'IZLOM_PODKLADKI' "
 +" 										,'OTSUT_PODKLADKI' "
 +" 										) "
 +" 									THEN '61Наличие дефектных подкладок весной' "
 +" 								WHEN point_spc.assetattrid IN ('OSLAB_ZAKLADN_BOLT') "
 +" 									THEN '71Закрепить закладных болтов весной' "
 +" 								WHEN point_spc.assetattrid IN ('OSLAB_KLEMMBOLT') "
 +" 									THEN '72Закрепить клеммных болтов весной' "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'OTSUT_GAYKI_ZAKLADN_BOLT' "
 +" 										,'OTSUT_SHAYBY_ZAKLADN_BOLT' "
 +" 										) "
 +" 									THEN '73Заменить и дополнить  закладных болтов весной' "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'DEFORM_KLEMMBOLT' "
 +" 										,'OTSUT_KLEMMBOLT' "
 +" 										) "
 +" 									THEN '74Заменить и дополнить клеммных болтов весной' "
 +" 								END "
 +" 					WHEN DC.CLASSSTRUCTUREID = '010002000101' "
 +" 						THEN CASE  "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'DEFECT_PRUGIN_RELS_SOEDINITEL' "
 +" 										,'DEFECT_SHTEPSELNY_RELS_SOEDINITEL' "
 +" 										,'DEFECT_PRIVARNOY_RELS_SOEDINITEL' "
 +" 										,'OTSUT_PRUGIN_RELS_SOEDINITEL' "
 +" 										,'OTSUT_PRIVARN_RELS_SOEDINITEL' "
 +" 										,'OTSUT_SHTEPSEL_RELS_SOEDINITEL' "
 +" 										) "
 +" 									THEN '23Требуется  приварить  соединителей осенью' "
 +" 								WHEN POINT_SPC.ASSETATTRID IN ('NEDOST_KOLICHESTVO_STYK_BOLT') "
 +" 									THEN '32Недостает стыковых болтов осенью' "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'NEGOD_PODREL_PROKLADKI' "
 +" 										,'OTSUT_PODREL_PROKLADKI' "
 +" 										) "
 +" 									THEN '42Требуется заменить подрельсовой прокладки осенью' "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'NEGOD_PROKLADKI_POD_PODKLADK' "
 +" 										,'OTSUT_PROKLADKI_POD_PODKLADK' "
 +" 										) "
 +" 									THEN '52Требуется заменить нашпальной прокладки осенью' "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'DEFECT_PODKLADKI' "
 +" 										,'IZLOM_PODKLADKI' "
 +" 										,'OTSUT_PODKLADKI' "
 +" 										) "
 +" 									THEN '62Наличие дефектных подкладок осенью' "
 +" 								WHEN POINT_SPC.ASSETATTRID IN ('OSLAB_ZAKLADN_BOLT') "
 +" 									THEN '75Закрепить закладных болтов осенью' "
 +" 								WHEN point_spc.assetattrid IN ('OSLAB_KLEMMBOLT') "
 +" 									THEN '76Закрепить клеммных болтов осенью' "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'OTSUT_GAYKI_ZAKLADN_BOLT' "
 +" 										,'OTSUT_SHAYBY_ZAKLADN_BOLT' "
 +" 										) "
 +" 									THEN '77Заменить и дополнить  закладных болтов осенью' "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'DEFORM_KLEMMBOLT' "
 +" 										,'OTSUT_KLEMMBOLT' "
 +" 										) "
 +" 									THEN '78Заменить и дополнить клеммных болтов осенью' "
 +" 								END "
 +" 					END "
 +" 		WHEN 2 =" + params["osmotr"]
 +" 			THEN CASE  "
 +" 					WHEN DC.CLASSSTRUCTUREID = '010002000101' "
 +" 						THEN CASE  "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'DEFECT_PRUGIN_RELS_SOEDINITEL' "
 +" 										,'DEFECT_SHTEPSELNY_RELS_SOEDINITEL' "
 +" 										,'DEFECT_PRIVARNOY_RELS_SOEDINITEL' "
 +" 										,'OTSUT_PRUGIN_RELS_SOEDINITEL' "
 +" 										,'OTSUT_PRIVARN_RELS_SOEDINITEL' "
 +" 										,'OTSUT_SHTEPSEL_RELS_SOEDINITEL' "
 +" 										) "
 +" 									THEN '21Требуется  приварить  соединителей осенью' "
 +" 								WHEN point_spc.assetattrid IN ('NEDOST_KOLICHESTVO_STYK_BOLT') "
 +" 									THEN '31Недостает стыковых болтов осенью' "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'NEGOD_PODREL_PROKLADKI' "
 +" 										,'OTSUT_PODREL_PROKLADKI' "
 +" 										) "
 +" 									THEN '41Требуется заменить подрельсовой прокладки осенью' "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'NEGOD_PROKLADKI_POD_PODKLADK' "
 +" 										,'OTSUT_PROKLADKI_POD_PODKLADK' "
 +" 										) "
 +" 									THEN '51Требуется заменить нашпальной прокладки осенью' "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'DEFECT_PODKLADKI' "
 +" 										,'IZLOM_PODKLADKI' "
 +" 										,'OTSUT_PODKLADKI' "
 +" 										) "
 +" 									THEN '61Наличие дефектных подкладок осенью' "
 +" 								WHEN point_spc.assetattrid IN ('OSLAB_ZAKLADN_BOLT') "
 +" 									THEN '71Закрепить закладных болтов осенью' "
 +" 								WHEN point_spc.assetattrid IN ('OSLAB_KLEMMBOLT') "
 +" 									THEN '72Закрепить клеммных болтов осенью' "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'OTSUT_GAYKI_ZAKLADN_BOLT' "
 +" 										,'OTSUT_SHAYBY_ZAKLADN_BOLT' "
 +" 										) "
 +" 									THEN '73Заменить и дополнить  закладных болтов осенью' "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'DEFORM_KLEMMBOLT' "
 +" 										,'OTSUT_KLEMMBOLT' "
 +" 										) "
 +" 									THEN '74Заменить и дополнить клеммных болтов осенью' "
 +" 								END "
 +" 					WHEN DC.CLASSSTRUCTUREID = '010002000100' "
 +" 						THEN CASE  "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'DEFECT_PRUGIN_RELS_SOEDINITEL' "
 +" 										,'DEFECT_SHTEPSELNY_RELS_SOEDINITEL' "
 +" 										,'DEFECT_PRIVARNOY_RELS_SOEDINITEL' "
 +" 										,'OTSUT_PRUGIN_RELS_SOEDINITEL' "
 +" 										,'OTSUT_PRIVARN_RELS_SOEDINITEL' "
 +" 										,'OTSUT_SHTEPSEL_RELS_SOEDINITEL' "
 +" 										) "
 +" 									THEN '23Требуется  приварить  соединителей весной' "
 +" 								WHEN POINT_SPC.ASSETATTRID IN ('NEDOST_KOLICHESTVO_STYK_BOLT') "
 +" 									THEN '32Недостает стыковых болтов весной' "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'NEGOD_PODREL_PROKLADKI' "
 +" 										,'OTSUT_PODREL_PROKLADKI' "
 +" 										) "
 +" 									THEN '42Требуется заменить подрельсовой прокладки весной' "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'NEGOD_PROKLADKI_POD_PODKLADK' "
 +" 										,'OTSUT_PROKLADKI_POD_PODKLADK' "
 +" 										) "
 +" 									THEN '52Требуется заменить нашпальной прокладки весной' "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'DEFECT_PODKLADKI' "
 +" 										,'IZLOM_PODKLADKI' "
 +" 										,'OTSUT_PODKLADKI' "
 +" 										) "
 +" 									THEN '62Наличие дефектных подкладок весной' "
 +" 								WHEN POINT_SPC.ASSETATTRID IN ('OSLAB_ZAKLADN_BOLT') "
 +" 									THEN '75Закрепить закладных болтов весной' "
 +" 								WHEN point_spc.assetattrid IN ('OSLAB_KLEMMBOLT') "
 +" 									THEN '76Закрепить клеммных болтов весной' "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'OTSUT_GAYKI_ZAKLADN_BOLT' "
 +" 										,'OTSUT_SHAYBY_ZAKLADN_BOLT' "
 +" 										) "
 +" 									THEN '77Заменить и дополнить  закладных болтов весной' "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'DEFORM_KLEMMBOLT' "
 +" 										,'OTSUT_KLEMMBOLT' "
 +" 										) "
 +" 									THEN '78Заменить и дополнить клеммных болтов весной' "
 +" 								END "
 +" 					END "
 +" 		END ASSETATTRID1 "
 +" 	,CASE  "
 +" 		WHEN 1 = " + params["osmotr"]
 +" 			THEN CASE  "
 +" 					WHEN DC.CLASSSTRUCTUREID = '010002000100' "
 +" 						THEN CASE  "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'DEFECT_SHTEPSELNY_RELS_SOEDINITEL' "
 +" 										,'OTSUT_SHTEPSEL_RELS_SOEDINITEL' "
 +" 										) "
 +" 									THEN '22Требуется установить штепс. соединители весной' "
 +" 								END "
 +" 					WHEN DC.CLASSSTRUCTUREID = '010002000101' "
 +" 						THEN CASE  "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'DEFECT_SHTEPSELNY_RELS_SOEDINITEL' "
 +" 										,'OTSUT_SHTEPSEL_RELS_SOEDINITEL' "
 +" 										) "
 +" 									THEN '24Требуется установить штепс. соединители осенью' "
 +" 								END "
 +" 					END "
 +" 		WHEN 2 = " + params["osmotr"]
 +" 			THEN CASE  "
 +" 					WHEN DC.CLASSSTRUCTUREID = '010002000101' "
 +" 						THEN CASE  "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'DEFECT_SHTEPSELNY_RELS_SOEDINITEL' "
 +" 										,'OTSUT_SHTEPSEL_RELS_SOEDINITEL' "
 +" 										) "
 +" 									THEN '22Требуется установить штепс. соединители осенью' "
 +" 								END "
 +" 					WHEN DC.CLASSSTRUCTUREID = '010002000100' "
 +" 						THEN CASE  "
 +" 								WHEN point_spc.assetattrid IN ( "
 +" 										'DEFECT_SHTEPSELNY_RELS_SOEDINITEL' "
 +" 										,'OTSUT_SHTEPSEL_RELS_SOEDINITEL' "
 +" 										) "
 +" 									THEN '24Требуется установить штепс. соединители весной' "
 +" 								END "
 +" 					END "
 +" 		END assetattrid2 "
 +" 	,'шт.' ed_izm "
 +" 	,MAL_I.TEMPERATURE TEMP "
 +"   ,170               rels         "
 +" 	,mal_i.RATING "
 +" 	,point_spc.numvalue "
 +" FROM maximo.workorder wo "
 +" JOIN maximo.pm "
 +" 	ON wo.pmnum = pm.pmnum "
 +" 		AND wo.siteid = pm.siteid "
 +" JOIN maximo.masterpm mpm "
 +" 	ON pm.masterpm = mpm.masterpmnum "
 +" JOIN maximo.decree dc "
 +" 	ON mpm.decreeid = dc.decreeid "
 +" 		AND wo.siteid = dc.siteid "
 +" JOIN MAXIMO.multiassetlocci_INSPEC mal_i "
 +" 	ON mal_i.wonum = wo.wonum "
 +" 		AND mal_i.siteid = wo.siteid "
 +" 		AND MAL_I.IS_OSMOTR = '1' "
 +" JOIN maximo.asset ast "
 +" 	ON mal_i.assetnum = ast.assetnum "
 +" 		AND wo.siteid = ast.siteid "
 +" 		AND ast.itemnum IN ( "
 +" 			'ПУТЬП' "
 +" 			,'ГППС' "
 +" 			) "
 +" JOIN MAXIMO.inspec_point point "
 +" 	ON mal_i.multiassetlocci_inspecid = point.multiassetlocci_inspecid "
 +" 		AND mal_i.wonum = point.wonum "
 +" 		AND mal_i.siteid = point.siteid "
 +" JOIN MAXIMO.inspec_pointspec point_spc "
 +" 	ON point.inspec_pointid = point_spc.inspec_pointid "
 +" 		AND point.siteid = point_spc.siteid "
 +" WHERE wo.siteid = '"+params["mroSite"]+"' "
 +" 	AND wo.typeworkorder = 'Промер' "
 +" 	AND wo.classstructureid = '010002000110' "
 +" 	AND ( "
 +" 		( "
 +" 			1 = " + params["osmotr"]
 +" 			AND ( "
 +" 				( "
 +" 					DC.CLASSSTRUCTUREID = '010002000100' "
 +" 					AND extract(YEAR FROM MAL_I.FAKT_DATE_OS) = "+params["year"]
 +" 					) "
 +" 				OR ( "
 +" 					DC.CLASSSTRUCTUREID = '010002000101' "
 +" 					AND extract(YEAR FROM MAL_I.FAKT_DATE_OS) = "+params["year"]+ "-1 "
 +" 					) "
 +" 				) "
 +" 			) "
 +" 		OR ( "
 +" 			2 = " + params["osmotr"]
 +" 			AND ( "
 +" 				( "
 +" 					DC.CLASSSTRUCTUREID = '010002000101' "
 +" 					AND extract(YEAR FROM MAL_I.FAKT_DATE_OS) = "+params["year"]
 +" 					) "
 +" 				OR ( "
 +" 					DC.CLASSSTRUCTUREID = '010002000100' "
 +" 					AND extract(YEAR FROM MAL_I.FAKT_DATE_OS) = "+params["year"]
 +" 					) "
 +" 				) "
 +" 			) "
 +" 		) "
 +" 	AND wo.l_podr = '"+params["podr"]+"' "
 +" 	AND point_spc.assetattrid IN ( "
 +" 		'DEFECT_PRUGIN_RELS_SOEDINITEL' "
 +" 		,'DEFECT_SHTEPSELNY_RELS_SOEDINITEL' "
 +" 		,'DEFECT_PRIVARNOY_RELS_SOEDINITEL' "
 +" 		,'OTSUT_PRUGIN_RELS_SOEDINITEL' "
 +" 		,'OTSUT_PRIVARN_RELS_SOEDINITEL' "
 +" 		,'OTSUT_SHTEPSEL_RELS_SOEDINITEL' "
 +" 		,'NEDOST_KOLICHESTVO_STYK_BOLT' "
 +" 		,'NEGOD_PODREL_PROKLADKI' "
 +" 		,'OTSUT_PODREL_PROKLADKI' "
 +" 		,'NEGOD_PROKLADKI_POD_PODKLADK' "
 +" 		,'OTSUT_PROKLADKI_POD_PODKLADK' "
 +" 		,'DEFECT_PODKLADKI' "
 +" 		,'IZLOM_PODKLADKI' "
 +" 		,'OTSUT_PODKLADKI' "
 +" 		,'OSLAB_ZAKLADN_BOLT' "
 +" 		,'OSLAB_KLEMMBOLT' "
 +" 		,'OTSUT_GAYKI_ZAKLADN_BOLT' "
 +" 		,'OTSUT_SHAYBY_ZAKLADN_BOLT' "
 +" 		,'DEFORM_KLEMMBOLT' "
 +" 		,'OTSUT_KLEMMBOLT' "
 +" 		) "
 +" 	AND AST.ASSETNUM in ("+params["asset"]+") "
 
 +"      ) "
 +"      , "
 +"       "
 +" defect_zv AS "
 +" (SELECT wo.pmnum             , "
 +"        ast.assetnum         , "
 +"        wo.wonum             , "
 +"        mal_i.MEASUREKM km   , "
 +"        point.element   zveno, "
 +"        POINT_SPC.ASSETATTRID, "
 +"        CASE  "
 +" 		WHEN 1 = " + params["osmotr"]
 +" 			THEN CASE  "
 +" 					WHEN DC.CLASSSTRUCTUREID = '010002000100' "
 +" 						THEN "
 +"        CASE "
 +"               WHEN point_spc.assetattrid IN ('DEFECT_PRUGIN_RELS_SOEDINITEL'    , "
 +"                                              'DEFECT_SHTEPSELNY_RELS_SOEDINITEL', "
 +"                                              'DEFECT_PRIVARNOY_RELS_SOEDINITEL' , "
 +"                                              'OTSUT_PRUGIN_RELS_SOEDINITEL'     , "
 +"                                              'OTSUT_PRIVARN_RELS_SOEDINITEL'    , "
 +"                                              'OTSUT_SHTEPSEL_RELS_SOEDINITEL') "
 +"               THEN '21Требуется  приварить  соединителей весной' "
 +"               when POINT_SPC.ASSETATTRID in ('NEDOST_KOLICHESTVO_STYK_BOLT') "
 +"               THEN '31Недостает стыковых болтов весной' "
 +"               WHEN point_spc.assetattrid IN ('DEFECT_PEREHODN_NAKLADKA'        , "
 +"                                              'DEFECT_STYK_NAKLADKA'            , "
 +"                                              'IZLOM_TRESHINA_STYK_NAKLADKA'    , "
 +"                                              'IZLOM_TRESHINA_PEREHOD_NAKLADKA' , "
 +"                                              'OTSUT_SHESTDYR_STYK_NAKLADKA' ) "
 +"               THEN '41Выявлено дефектных накладок весной' "
 +"               WHEN POINT_SPC.ASSETATTRID IN ('DEFECT_KOSTYLY') "
 +"               THEN '61Недостает костылей весной' "
 +"               WHEN point_spc.assetattrid IN ('DEFECT_PODKLADKI' , "
 +"                                              'IZLOM_PODKLADKI'  , "
 +"                                              'OTSUT_PODKLADKI' ) "
 +"               THEN '71Выявлено  дефектных  подкладок весной' "
 +"               WHEN point_spc.assetattrid IN ('NEGOD_PROKLADKI_POD_PODKLADK', "
 +"                                              'OTSUT_PROKLADKI_POD_PODKLADK') "
 +"               then '81Требуется уложить нашпальной прокладки весной' "
 +"        end "
 +"        when DC.CLASSSTRUCTUREID = '010002000101' "
 +" 						then "
 +"                 CASE "
 +"               WHEN point_spc.assetattrid IN ('DEFECT_PRUGIN_RELS_SOEDINITEL'    , "
 +"                                              'DEFECT_SHTEPSELNY_RELS_SOEDINITEL', "
 +"                                              'DEFECT_PRIVARNOY_RELS_SOEDINITEL' , "
 +"                                              'OTSUT_PRUGIN_RELS_SOEDINITEL'     , "
 +"                                              'OTSUT_PRIVARN_RELS_SOEDINITEL'    , "
 +"                                              'OTSUT_SHTEPSEL_RELS_SOEDINITEL') "
 +"               THEN '23Требуется  приварить  соединителей осенью' "
 +"               when POINT_SPC.ASSETATTRID in ('NEDOST_KOLICHESTVO_STYK_BOLT') "
 +"               THEN '32Недостает стыковых болтов осенью' "
 +"               WHEN point_spc.assetattrid IN ('DEFECT_PEREHODN_NAKLADKA'        , "
 +"                                              'DEFECT_STYK_NAKLADKA'            , "
 +"                                              'IZLOM_TRESHINA_STYK_NAKLADKA'    , "
 +"                                              'IZLOM_TRESHINA_PEREHOD_NAKLADKA' , "
 +"                                              'OTSUT_SHESTDYR_STYK_NAKLADKA' ) "
 +"               THEN '42Выявлено дефектных накладок осенью' "
 +"               WHEN POINT_SPC.ASSETATTRID IN ('DEFECT_KOSTYLY') "
 +"               THEN '62Недостает костылей осенью' "
 +"               WHEN point_spc.assetattrid IN ('DEFECT_PODKLADKI' , "
 +"                                              'IZLOM_PODKLADKI'  , "
 +"                                              'OTSUT_PODKLADKI' ) "
 +"               THEN '72Выявлено  дефектных  подкладок осенью' "
 +"               WHEN point_spc.assetattrid IN ('NEGOD_PROKLADKI_POD_PODKLADK', "
 +"                                              'OTSUT_PROKLADKI_POD_PODKLADK') "
 +"               then '82Требуется уложить нашпальной прокладки осенью' "
 +"        end "
 +"        end  "
 +"       WHEN 2 = " + params["osmotr"]
 +" 			THEN CASE  "
 +" 					WHEN DC.CLASSSTRUCTUREID = '010002000100' "
 +" 						THEN "
 +"        CASE "
 +"               WHEN point_spc.assetattrid IN ('DEFECT_PRUGIN_RELS_SOEDINITEL'    , "
 +"                                              'DEFECT_SHTEPSELNY_RELS_SOEDINITEL', "
 +"                                              'DEFECT_PRIVARNOY_RELS_SOEDINITEL' , "
 +"                                              'OTSUT_PRUGIN_RELS_SOEDINITEL'     , "
 +"                                              'OTSUT_PRIVARN_RELS_SOEDINITEL'    , "
 +"                                              'OTSUT_SHTEPSEL_RELS_SOEDINITEL') "
 +"               THEN '21Требуется  приварить  соединителей осенью' "
 +"               when POINT_SPC.ASSETATTRID in ('NEDOST_KOLICHESTVO_STYK_BOLT') "
 +"               THEN '31Недостает стыковых болтов осенью' "
 +"               WHEN point_spc.assetattrid IN ('DEFECT_PEREHODN_NAKLADKA'        , "
 +"                                              'DEFECT_STYK_NAKLADKA'            , "
 +"                                              'IZLOM_TRESHINA_STYK_NAKLADKA'    , "
 +"                                              'IZLOM_TRESHINA_PEREHOD_NAKLADKA' , "
 +"                                              'OTSUT_SHESTDYR_STYK_NAKLADKA' ) "
 +"               THEN '41Выявлено дефектных накладок осенью' "
 +"               WHEN POINT_SPC.ASSETATTRID IN ('DEFECT_KOSTYLY') "
 +"               THEN '61Недостает костылей осенью' "
 +"               WHEN point_spc.assetattrid IN ('DEFECT_PODKLADKI' , "
 +"                                              'IZLOM_PODKLADKI'  , "
 +"                                              'OTSUT_PODKLADKI' ) "
 +"               THEN '71Выявлено  дефектных  подкладок осенью' "
 +"               WHEN point_spc.assetattrid IN ('NEGOD_PROKLADKI_POD_PODKLADK', "
 +"                                              'OTSUT_PROKLADKI_POD_PODKLADK') "
 +"               then '81Требуется уложить нашпальной прокладки осенью' "
 +"        end "
 +"        when DC.CLASSSTRUCTUREID = '010002000101' "
 +" 						then "
 +"                 CASE "
 +"               WHEN point_spc.assetattrid IN ('DEFECT_PRUGIN_RELS_SOEDINITEL'    , "
 +"                                              'DEFECT_SHTEPSELNY_RELS_SOEDINITEL', "
 +"                                              'DEFECT_PRIVARNOY_RELS_SOEDINITEL' , "
 +"                                              'OTSUT_PRUGIN_RELS_SOEDINITEL'     , "
 +"                                              'OTSUT_PRIVARN_RELS_SOEDINITEL'    , "
 +"                                              'OTSUT_SHTEPSEL_RELS_SOEDINITEL') "
 +"               THEN '23Требуется  приварить  соединителей весной' "
 +"               when POINT_SPC.ASSETATTRID in ('NEDOST_KOLICHESTVO_STYK_BOLT') "
 +"               THEN '32Недостает стыковых болтов весной' "
 +"               WHEN point_spc.assetattrid IN ('DEFECT_PEREHODN_NAKLADKA'        , "
 +"                                              'DEFECT_STYK_NAKLADKA'            , "
 +"                                              'IZLOM_TRESHINA_STYK_NAKLADKA'    , "
 +"                                              'IZLOM_TRESHINA_PEREHOD_NAKLADKA' , "
 +"                                              'OTSUT_SHESTDYR_STYK_NAKLADKA' ) "
 +"               THEN '42Выявлено дефектных накладок весной' "
 +"               WHEN POINT_SPC.ASSETATTRID IN ('DEFECT_KOSTYLY') "
 +"               THEN '62Недостает костылей весной' "
 +"               WHEN point_spc.assetattrid IN ('DEFECT_PODKLADKI' , "
 +"                                              'IZLOM_PODKLADKI'  , "
 +"                                              'OTSUT_PODKLADKI' ) "
 +"               THEN '72Выявлено  дефектных  подкладок весной' "
 +"               WHEN point_spc.assetattrid IN ('NEGOD_PROKLADKI_POD_PODKLADK', "
 +"                                              'OTSUT_PROKLADKI_POD_PODKLADK') "
 +"               then '82Требуется уложить нашпальной прокладки весной' "
 +"        end "
 +"        end  "
 +"        end "
 +"         "
 +"         "
 +"        assetattrid1, "
 +"        CASE "
 +"               WHEN 1 = " + params["osmotr"]
 +"               THEN "
 +"                      CASE "
 +"                             WHEN DC.CLASSSTRUCTUREID = '010002000100' "
 +"                             THEN "
 +"                                    CASE "
 +"                                           WHEN point_spc.assetattrid IN ( 'DEFECT_SHTEPSELNY_RELS_SOEDINITEL' , "
 +"                                                                          'OTSUT_SHTEPSEL_RELS_SOEDINITEL' ) "
 +"                                           THEN '22Требуется установить штепс. соединители весной' "
 +"                                    END "
 +"                             WHEN DC.CLASSSTRUCTUREID = '010002000101' "
 +"                             THEN "
 +"                                    CASE "
 +"                                           WHEN point_spc.assetattrid IN ( 'DEFECT_SHTEPSELNY_RELS_SOEDINITEL' , "
 +"                                                                          'OTSUT_SHTEPSEL_RELS_SOEDINITEL' ) "
 +"                                           THEN '24Требуется установить штепс. соединители осенью' "
 +"                                    END "
 +"                      END "
 +"               WHEN 2 = " + params["osmotr"]
 +"               THEN "
 +"                      CASE "
 +"                             WHEN DC.CLASSSTRUCTUREID = '010002000101' "
 +"                             THEN "
 +"                                    CASE "
 +"                                           WHEN point_spc.assetattrid IN ( 'DEFECT_SHTEPSELNY_RELS_SOEDINITEL' , "
 +"                                                                          'OTSUT_SHTEPSEL_RELS_SOEDINITEL' ) "
 +"                                           THEN '22Требуется установить штепс. соединители осенью' "
 +"                                    END "
 +"                             WHEN DC.CLASSSTRUCTUREID = '010002000100' "
 +"                             THEN "
 +"                                    CASE "
 +"                                           WHEN point_spc.assetattrid IN ( 'DEFECT_SHTEPSELNY_RELS_SOEDINITEL' , "
 +"                                                                          'OTSUT_SHTEPSEL_RELS_SOEDINITEL' ) "
 +"                                           THEN '24Требуется установить штепс. соединители весной' "
 +"                                    END "
 +"                      END "
 +"        END               assetattrid2, "
 +"        'шт.'             ed_izm      , "
 +"        MAL_I.TEMPERATURE TEMP        , "
 +"        171               rels        , "
 +"        mal_i.RATING                  , "
 +"        point_spc.numvalue "
 +" FROM   maximo.workorder wo "
 +"         JOIN maximo.pm "
 +"         ON      wo.pmnum  = pm.pmnum "
 +"         AND     wo.siteid = pm.siteid "
 +"         JOIN maximo.masterpm mpm "
 +"         ON      pm.masterpm = mpm.masterpmnum "
 +"         JOIN maximo.decree dc "
 +"         ON      mpm.decreeid        = dc.decreeid "
 +"         AND     wo.siteid           = dc.siteid "
 +"         JOIN MAXIMO.multiassetlocci_INSPEC mal_i "
 +"         ON      mal_i.wonum     = wo.wonum "
 +"         AND     mal_i.siteid    = wo.siteid "
 +"         AND     MAL_I.IS_OSMOTR = '1' "
 +"         JOIN maximo.asset ast "
 +"         ON      mal_i.assetnum = ast.assetnum "
 +"         AND     wo.siteid      = ast.siteid "
 +"         AND     ast.itemnum IN ('ПУТЬП', "
 +"                                 'ГППС') "
 +"         JOIN MAXIMO.inspec_point point "
 +"         ON      mal_i.multiassetlocci_inspecid = point.multiassetlocci_inspecid "
 +"         AND     mal_i.wonum                    = point.wonum "
 +"         AND     mal_i.siteid                   = point.siteid "
 +"         JOIN MAXIMO.inspec_pointspec point_spc "
 +"         ON      point.inspec_pointid = point_spc.inspec_pointid "
 +"         AND     point.siteid         = point_spc.siteid "
 +" WHERE   wo.siteid                    = '"+params["mroSite"]+"' "
 +" AND     wo.typeworkorder             = 'Промер' "
 +" AND     wo.classstructureid          = '010002000110' "
 +" and     WO.L_PODR = '"+params["podr"]+"' "
 +" AND ( "
 +" 		( "
 +" 			1 = " + params["osmotr"]
 +" 			AND ( "
 +" 				( "
 +" 					DC.CLASSSTRUCTUREID = '010002000100' "
 +" 					AND extract(YEAR FROM MAL_I.FAKT_DATE_OS) = "+params["year"]
 +" 					) "
 +" 				OR ( "
 +" 					DC.CLASSSTRUCTUREID = '010002000101' "
 +" 					AND extract(YEAR FROM MAL_I.FAKT_DATE_OS) = "+params["year"]+ "-1 "
 +" 					) "
 +" 				) "
 +" 			) "
 +" 		OR ( "
 +" 			2 = " + params["osmotr"]
 +" 			AND ( "
 +" 				( "
 +" 					DC.CLASSSTRUCTUREID = '010002000101' "
 +" 					AND extract(YEAR FROM MAL_I.FAKT_DATE_OS) = "+params["year"]
 +" 					) "
 +" 				OR ( "
 +" 					DC.CLASSSTRUCTUREID = '010002000100' "
 +" 					AND extract(YEAR FROM MAL_I.FAKT_DATE_OS) = "+params["year"]
 +" 					) "
 +" 				) "
 +" 			) "
 +" 		) "
 +" AND     point_spc.assetattrid IN ('DEFECT_PRUGIN_RELS_SOEDINITEL'    , "
 +"                                   'DEFECT_SHTEPSELNY_RELS_SOEDINITEL', "
 +"                                   'DEFECT_PRIVARNOY_RELS_SOEDINITEL' , "
 +"                                   'OTSUT_PRUGIN_RELS_SOEDINITEL'     , "
 +"                                   'OTSUT_PRIVARN_RELS_SOEDINITEL'    , "
 +"                                   'OTSUT_SHTEPSEL_RELS_SOEDINITEL'   , "
 +"                                   'NEDOST_KOLICHESTVO_STYK_BOLT'     , "
 +"                                   'DEFECT_PEREHODN_NAKLADKA'         , "
 +"                                   'DEFECT_STYK_NAKLADKA'             , "
 +"                                   'IZLOM_TRESHINA_STYK_NAKLADKA'     , "
 +"                                   'IZLOM_TRESHINA_PEREHOD_NAKLADKA'  , "
 +"                                   'OTSUT_SHESTDYR_STYK_NAKLADKA'     , "
 +"                                   'DEFECT_KOSTYLY'                   , "
 +"                                   'DEFECT_PODKLADKI'                 , "
 +"                                   'IZLOM_PODKLADKI'                  , "
 +"                                   'OTSUT_PODKLADKI'                  , "
 +"                                   'NEGOD_PROKLADKI_POD_PODKLADK'     , "
 +"                                   'OTSUT_PROKLADKI_POD_PODKLADK'     , "
 +"                                   'DEFECT_SHTEPSELNY_RELS_SOEDINITEL', "
 +"                                   'OTSUT_SHTEPSEL_RELS_SOEDINITEL' ) "
 +" AND     ast.assetnum    in ("+params["asset"]+") "
 +"  "
 +" ) "
 +" , "
 +"     "
 +" zazor AS "
 +" ( SELECT    ast.assetnum          , "
 +"           wo.wonum              , "
 +"           mal_i.MEASUREKM km    , "
 +"           point.element   zveno , "
 +"           point_spc.assetattrid , "
 +"           CASE  "
 +" 		WHEN 1 = " + params["osmotr"]
 +" 			THEN CASE  "
 +" 					when DC.CLASSSTRUCTUREID = '010002000100' "
 +" 						THEN           "
 +"           CASE "
 +"                     when POINT_SPC.ASSETATTRID='BUTTGAPRIGHT' "
 +"                     THEN '11Стыковой зазор (правая нитка) весной' "
 +"                     when POINT_SPC.ASSETATTRID='BUTTGAPLEFT' "
 +"                     THEN '12Стыковой зазор (левая нитка) весной' "
 +"           END "
 +"           when DC.CLASSSTRUCTUREID = '010002000101' "
 +" 						THEN           "
 +"           CASE "
 +"                     when POINT_SPC.ASSETATTRID='BUTTGAPRIGHT' "
 +"                     THEN '13Стыковой зазор (правая нитка) осенью' "
 +"                     when POINT_SPC.ASSETATTRID='BUTTGAPLEFT' "
 +"                     THEN '14Стыковой зазор (левая нитка) осенью' "
 +"           end  "
 +"           end "
 +"           WHEN 2 = " + params["osmotr"]
 +" 			THEN CASE  "
 +" 					when DC.CLASSSTRUCTUREID = '010002000101' "
 +" 						THEN           "
 +"           CASE "
 +"                     when POINT_SPC.ASSETATTRID='BUTTGAPRIGHT' "
 +"                     THEN '11Стыковой зазор (правая нитка) осенью' "
 +"                     when POINT_SPC.ASSETATTRID='BUTTGAPLEFT' "
 +"                     THEN '12Стыковой зазор (левая нитка) осенью' "
 +"           end "
 +"           when DC.CLASSSTRUCTUREID = '010002000100' "
 +" 						THEN           "
 +"           CASE "
 +"                     when POINT_SPC.ASSETATTRID='BUTTGAPRIGHT' "
 +"                     THEN '13Стыковой зазор (правая нитка) весной' "
 +"                     when POINT_SPC.ASSETATTRID='BUTTGAPLEFT' "
 +"                     THEN '14Стыковой зазор (левая нитка) весной' "
 +"           end  "
 +"           end "
 +"           end "
 +"            "
 +"           assetattrid1, "
 +"           ''                assetattrid2, "
 +"           'мм'              ed_izm     , "
 +"           MAL_I.TEMPERATURE TEMP        , "
 +"           200               rels        , "
 +"           mal_i.RATING                  , "
 +"           point_spc.numvalue "
 +" FROM      maximo.workorder wo "
 +"           JOIN maximo.pm "
 +"           ON        wo.pmnum  = pm.pmnum "
 +"           AND       wo.siteid = pm.siteid "
 +"           JOIN maximo.masterpm mpm "
 +"           ON        pm.masterpm = mpm.masterpmnum "
 +"           JOIN maximo.decree dc "
 +"           ON        mpm.decreeid        = dc.decreeid "
 +"           AND       wo.siteid           = dc.siteid "
 +"           JOIN MAXIMO.multiassetlocci_INSPEC mal_i "
 +"           ON        mal_i.wonum     = wo.wonum "
 +"           AND       mal_i.siteid    = wo.siteid "
 +"           AND       MAL_I.IS_OSMOTR = '1' "
 +"           JOIN maximo.asset ast "
 +"           ON        mal_i.assetnum = ast.assetnum "
 +"           AND       ast.itemnum IN ('ПУТЬП', "
 +"                                     'ГППС') "
 +"           LEFT JOIN maximo.locationspec lspc "
 +"           ON        ast.location     = lspc.location "
 +"           AND       ast.siteid       = lspc.siteid "
 +"           AND       lspc.ASSETATTRID = 'AMPLITUDA' "
 +"           JOIN MAXIMO.inspec_point point "
 +"           ON        mal_i.multiassetlocci_inspecid = point.multiassetlocci_inspecid "
 +"           AND       mal_i.wonum                    = point.wonum "
 +"           AND       mal_i.siteid                   = point.siteid "
 +"           JOIN MAXIMO.inspec_pointspec point_spc "
 +"           ON        point.inspec_pointid = point_spc.inspec_pointid "
 +"           AND       point.siteid         = point_spc.siteid "
 +" WHERE     wo.typeworkorder               = 'Промер' "
 +" AND       WO.CLASSSTRUCTUREID            = '010002000103' "
 +" AND       point_spc.assetattrid IN ('BUTTGAPLEFT', "
 +"                                     'BUTTGAPRIGHT') "
 +" AND "
 +"           ( "
 +"                     ( "
 +"                               1 =" + params["osmotr"]
 +"                     AND "
 +"                               ( "
 +"                                         ( "
 +"                                                   DC.CLASSSTRUCTUREID                   = '010002000100' "
 +"                                         AND       extract(YEAR FROM MAL_I.FAKT_DATE_OS) = "+params["year"]
 +"                                         ) "
 +"                               OR "
 +"                                         ( "
 +"                                                   DC.CLASSSTRUCTUREID                   = '010002000101' "
 +"                                         AND       extract(YEAR FROM MAL_I.FAKT_DATE_OS) = "+params["year"]+ "-1 "
 +"                                         ) "
 +"                               ) "
 +"                     ) "
 +"           OR "
 +"                     ( "
 +"                               2 = " + params["osmotr"]
 +"                     AND "
 +"                               ( "
 +"                                         ( "
 +"                                                   DC.CLASSSTRUCTUREID                   = '010002000101' "
 +"                                         AND       extract(YEAR FROM MAL_I.FAKT_DATE_OS) = "+params["year"]
 +"                                         ) "
 +"                               OR "
 +"                                         ( "
 +"                                                   DC.CLASSSTRUCTUREID                   = '010002000100' "
 +"                                         AND       extract(YEAR FROM MAL_I.FAKT_DATE_OS) = "+params["year"]
 +"                                         ) "
 +"                               ) "
 +"                     ) "
 +"           ) "
 +" AND       wo.siteid       = '"+params["mroSite"]+"' "
 +" AND       wo.l_podr       = '"+params["podr"]+"' "
 +" AND       ast.assetnum    in ("+params["asset"]+") "
 +" ) "
 +"  "
 +" ,SHPALI as "
 +" (SELECT wo.pmnum             , "
 +"        ast.assetnum         , "
 +"        wo.wonum             , "
 +"        mal_i.MEASUREKM km   , "
 +"        POINT.ELEMENT   ZVENO, "
 +"        POINT_SPC.ASSETATTRID, "
 +"       CASE "
 +"       WHEN 1 = " + params["osmotr"]+ " THEN "
 +"               CASE "
 +"               WHEN DC.CLASSSTRUCTUREID = '010002000100' THEN "
 +"                       CASE "
 +"                       WHEN POINT_SPC.ASSETATTRID = 'BROKENSLEEPERS' THEN "
 +"                               '91Выявлено  негодных шпал весной' "
 +"                       WHEN POINT_SPC.ASSETATTRID IN ('BROKENSLEEPERS3', "
 +"                                                      'BROKENSLEEPERS4', "
 +"                                                      'BROKENSLEEPERS5', "
 +"                                                      'BROKENSLEEPERS6') THEN "
 +"                               '92Кустов негодных  шпал  весной всего' "
 +"                       END "
 +"               WHEN DC.CLASSSTRUCTUREID = '010002000101' THEN "
 +"                       CASE "
 +"                       WHEN POINT_SPC.ASSETATTRID = 'BROKENSLEEPERS' THEN "
 +"                               '96Выявлено  негодных шпал осенью ' "
 +"                       WHEN POINT_SPC.ASSETATTRID IN ('BROKENSLEEPERS3', "
 +"                                                      'BROKENSLEEPERS4', "
 +"                                                      'BROKENSLEEPERS5', "
 +"                                                      'BROKENSLEEPERS6') THEN "
 +"                               '97Кустов негодных  шпал  осенью всего' "
 +"                       END "
 +"               END "
 +"       WHEN 2 = " + params["osmotr"] +" THEN "
 +"               CASE "
 +"               WHEN DC.CLASSSTRUCTUREID = '010002000101' THEN "
 +"                       CASE "
 +"                       WHEN POINT_SPC.ASSETATTRID = 'BROKENSLEEPERS' THEN "
 +"                               '91Выявлено  негодных шпал осенью' "
 +"                       WHEN POINT_SPC.ASSETATTRID IN ('BROKENSLEEPERS3', "
 +"                                                      'BROKENSLEEPERS4', "
 +"                                                      'BROKENSLEEPERS5', "
 +"                                                      'BROKENSLEEPERS6') THEN "
 +"                               '92Кустов негодных  шпал  осенью всего' "
 +"                       END "
 +"               WHEN DC.CLASSSTRUCTUREID = '010002000100' THEN "
 +"                       CASE "
 +"                       WHEN POINT_SPC.ASSETATTRID = 'BROKENSLEEPERS' THEN "
 +"                               '96Выявлено  негодных шпал весной ' "
 +"                       WHEN POINT_SPC.ASSETATTRID IN ('BROKENSLEEPERS3', "
 +"                                                      'BROKENSLEEPERS4', "
 +"                                                      'BROKENSLEEPERS5', "
 +"                                                      'BROKENSLEEPERS6') THEN "
 +"                               '97Кустов негодных  шпал  весной всего' "
 +"                       END "
 +"               end "
 +"       END assetattrid1, "
 +"       case "
 +"           WHEN 1 = " + params["osmotr"] + " THEN "
 +"                 CASE "
 +"                 WHEN DC.CLASSSTRUCTUREID = '010002000100' THEN "
 +"                         CASE "
 +"                         WHEN POINT_SPC.ASSETATTRID = 'BROKENSLEEPERS3' THEN "
 +"                                 '93в том числе  из 3-х шпал весной' "
 +"                         WHEN POINT_SPC.ASSETATTRID = 'BROKENSLEEPERS4' THEN "
 +"                                 '94из 4-х шпал весной' "
 +"                         WHEN POINT_SPC.ASSETATTRID = 'BROKENSLEEPERS5' THEN "
 +"                                 '95из 5-х шпал весной' "
 +"                         END "
 +"                 WHEN DC.CLASSSTRUCTUREID = '010002000101' THEN "
 +"                         CASE "
 +"                         WHEN POINT_SPC.ASSETATTRID = 'BROKENSLEEPERS3' THEN "
 +"                                 '98в том числе  из 3-х шпал осенью' "
 +"                         WHEN POINT_SPC.ASSETATTRID = 'BROKENSLEEPERS4' THEN "
 +"                                 '99из 4-х шпал осенью' "
 +"                         WHEN POINT_SPC.ASSETATTRID = 'BROKENSLEEPERS5' THEN "
 +"                                 '99из 5-х шпал осенью' "
 +"                         END "
 +"                 END "
 +"         WHEN 2 = " + params["osmotr"] + " THEN "
 +"                 CASE "
 +"                 WHEN DC.CLASSSTRUCTUREID = '010002000101' THEN "
 +"                         CASE "
 +"                         WHEN POINT_SPC.ASSETATTRID = 'BROKENSLEEPERS3' THEN "
 +"                                 '93в том числе  из 3-х шпал осенью' "
 +"                         WHEN POINT_SPC.ASSETATTRID = 'BROKENSLEEPERS4' THEN "
 +"                                 '94из 4-х шпал осенью' "
 +"                         WHEN POINT_SPC.ASSETATTRID = 'BROKENSLEEPERS5' THEN "
 +"                                 '95из 5-х шпал осенью' "
 +"                         END "
 +"                 WHEN DC.CLASSSTRUCTUREID = '010002000100' THEN "
 +"                         CASE "
 +"                         WHEN POINT_SPC.ASSETATTRID = 'BROKENSLEEPERS3' THEN "
 +"                                 '98в том числе  из 3-х шпал весной' "
 +"                         WHEN POINT_SPC.ASSETATTRID = 'BROKENSLEEPERS4' THEN "
 +"                                 '99из 4-х шпал весной' "
 +"                         WHEN POINT_SPC.ASSETATTRID = 'BROKENSLEEPERS5' THEN "
 +"                                 '99из 5-х шпал весной' "
 +"                         END "
 +"                 end "
 +"         END assetattrid2, "
 +"        'шт.'             ed_izm      , "
 +"        MAL_I.TEMPERATURE TEMP        , "
 +"        171               rels        , "
 +"        MAL_I.RATING                  , "
 +"        point_spc.numvalue "
 +" FROM   MAXIMO.WORKORDER WO "
 +"        JOIN maximo.pm "
 +"        ON     wo.pmnum  = pm.pmnum "
 +"        AND    wo.siteid = pm.siteid "
 +"        JOIN maximo.masterpm mpm "
 +"        ON     pm.masterpm = mpm.masterpmnum "
 +"        JOIN maximo.decree dc "
 +"        ON     mpm.decreeid        = dc.decreeid "
 +"        AND    WO.SITEID           = DC.SITEID "
 +"        JOIN MAXIMO.multiassetlocci_INSPEC mal_i "
 +"        ON     mal_i.wonum     = wo.wonum "
 +"        AND    mal_i.siteid    = wo.siteid "
 +"        AND    MAL_I.IS_OSMOTR = '1' "
 +"        JOIN maximo.asset ast "
 +"        ON     mal_i.assetnum = ast.assetnum "
 +"        AND    ast.itemnum IN ('ПУТЬП', "
 +"                               'ГППС' , "
 +"                               'СТП') "
 +"        JOIN MAXIMO.inspec_point point "
 +"        ON     mal_i.multiassetlocci_inspecid = point.multiassetlocci_inspecid "
 +"        AND    mal_i.wonum                    = point.wonum "
 +"        AND    mal_i.siteid                   = point.siteid "
 +"        JOIN MAXIMO.inspec_pointspec point_spc "
 +"        ON     point.inspec_pointid = point_spc.inspec_pointid "
 +"        AND    point.siteid         = point_spc.siteid "
 +" WHERE  wo.typeworkorder            = 'Промер' "
 +" AND    WO.CLASSSTRUCTUREID         = '010002000105' "
 +" AND    POINT_SPC.ASSETATTRID IN ('BROKENSLEEPERS' , "
 +"                                  'BROKENSLEEPERS3', "
 +"                                  'BROKENSLEEPERS4', "
 +"                                  'BROKENSLEEPERS5', "
 +"                                  'BROKENSLEEPERS6') "
 +" AND "
 +"        ( "
 +"               ( "
 +"                      1 =" + params["osmotr"]
 +"               AND "
 +"                      ( "
 +"                             ( "
 +"                                    DC.CLASSSTRUCTUREID                   = '010002000100' "
 +"                             AND    extract(YEAR FROM MAL_I.FAKT_DATE_OS) = "+params["year"]
 +"                             ) "
 +"                      OR "
 +"                             ( "
 +"                                    DC.CLASSSTRUCTUREID                   = '010002000101' "
 +"                             AND    extract(YEAR FROM MAL_I.FAKT_DATE_OS) = "+params["year"]+ "-1 "
 +"                             ) "
 +"                      ) "
 +"               ) "
 +"        OR "
 +"               ( "
 +"                      2 = " + params["osmotr"]
 +"               AND "
 +"                      ( "
 +"                             ( "
 +"                                    DC.CLASSSTRUCTUREID                   = '010002000101' "
 +"                             AND    extract(YEAR FROM MAL_I.FAKT_DATE_OS) = "+params["year"]
 +"                             ) "
 +"                      OR "
 +"                             ( "
 +"                                    DC.CLASSSTRUCTUREID                   = '010002000100' "
 +"                             AND    extract(YEAR FROM MAL_I.FAKT_DATE_OS) = "+params["year"]
 +"                             ) "
 +"                      ) "
 +"               ) "
 +"        ) "
 +" AND    wo.siteid       = '"+params["mroSite"]+"' "
 +" AND    wo.l_podr       = '"+params["podr"]+"' "
 +" AND    ast.assetnum    in ("+params["asset"]+") "
 +" ) "

 +" select c1.assetnum, c1.wonum, c1.km, c1.zveno, c1.num_sort, c1.num, c1.assetattrid, c1.ed_izm, c1.TEMP, astspc.alnvalue n_put, SUM(c1.numvalue) numvalue from (   "
 +" SELECT   assetnum                                                      , "
 +"          wonum                                                         , "
 +"          km                                                            , "
 +"          zveno                                                         , "
 +"          SUBSTR(assetattrid1, 0, 2)                        num_sort    , "
 +"          SUBSTR(assetattrid1, 0, 1)                        num         , "
 +"          SUBSTR(assetattrid1, 3, LENGTH(assetattrid1) - 2) assetattrid , "
 +"          ed_izm                                                        , "
 +"          TEMP                                                          , "
 +"          rels, "
 +"          numvalue "
 +" FROM     defect "
 +"  "
 +" UNION ALL "
 +"  "
 +" SELECT   assetnum                                                      , "
 +"          wonum                                                         , "
 +"          km                                                            , "
 +"          zveno                                                         , "
 +"          SUBSTR(assetattrid2, 0, 2)                        num_sort    , "
 +"          SUBSTR(assetattrid2, 0, 1)                        num         , "
 +"          SUBSTR(assetattrid2, 3, LENGTH(assetattrid2) - 2) assetattrid , "
 +"          ed_izm                                                        , "
 +"          TEMP                                                          , "
 +"          rels, "
 +"          numvalue "
 +" FROM     defect "
 +" WHERE    assetattrid2 IS NOT NULL "
 +"  "
 +" UNION ALL "
 +"  "
 +" SELECT   assetnum                                                      , "
 +"          wonum                                                         , "
 +"          km                                                            , "
 +"          zveno                                                         , "
 +"          SUBSTR(assetattrid1, 0, 2)                        num_sort    , "
 +"          SUBSTR(assetattrid1, 0, 1)                        num         , "
 +"          SUBSTR(assetattrid1, 3, LENGTH(assetattrid1) - 2) assetattrid , "
 +"          ed_izm                                                        , "
 +"          TEMP                                                          , "
 +"          rels, "
 +"          numvalue "
 +" FROM     zazor "
 +"  "
 +" UNION ALL "
 +"  "
 +" SELECT   assetnum                                                      , "
 +"          wonum                                                         , "
 +"          km                                                            , "
 +"          zveno                                                         , "
 +"          SUBSTR(assetattrid1, 0, 2)                        num_sort    , "
 +"          SUBSTR(assetattrid1, 0, 1)                        num         , "
 +"          SUBSTR(assetattrid1, 3, LENGTH(assetattrid1) - 2) assetattrid , "
 +"          ed_izm                                                        , "
 +"          TEMP                                                          , "
 +"          rels, "
 +"          NUMVALUE "
 +" FROM     defect_zv "
 +"  "
 +" UNION ALL "
 +"  "
 +" SELECT   assetnum                                                      , "
 +"          wonum                                                         , "
 +"          km                                                            , "
 +"          zveno                                                         , "
 +"          SUBSTR(assetattrid2, 0, 2)                        num_sort    , "
 +"          SUBSTR(assetattrid2, 0, 1)                        num         , "
 +"          SUBSTR(assetattrid2, 3, LENGTH(assetattrid2) - 2) assetattrid , "
 +"          ed_izm                                                        , "
 +"          TEMP                                                          , "
 +"          rels, "
 +"          NUMVALUE "
 +" FROM     defect_zv "
 +" WHERE    assetattrid2 IS NOT NULL "
 +"  "
 +" UNION ALL "
 +"  "
 +" SELECT   assetnum                                                      , "
 +"          wonum                                                         , "
 +"          km                                                            , "
 +"          zveno                                                         , "
 +"          SUBSTR(assetattrid1, 0, 2)                        num_sort    , "
 +"          SUBSTR(assetattrid1, 0, 1)                        num         , "
 +"          SUBSTR(assetattrid1, 3, LENGTH(assetattrid1) - 2) assetattrid , "
 +"          ed_izm                                                        , "
 +"          TEMP                                                          , "
 +"          rels, "
 +"          numvalue "
 +" FROM     shpali "
 +"  "
 +" UNION ALL "
 +"  "
 +" SELECT   assetnum                                                      , "
 +"          wonum                                                         , "
 +"          km                                                            , "
 +"          zveno                                                         , "
 +"          SUBSTR(assetattrid2, 0, 2)                        num_sort    , "
 +"          SUBSTR(assetattrid2, 0, 1)                        num         , "
 +"          SUBSTR(assetattrid2, 3, LENGTH(assetattrid2) - 2) assetattrid , "
 +"          ed_izm                                                        , "
 +"          TEMP                                                          , "
 +"          rels, "
 +"          NUMVALUE "
 +" FROM     shpali "
 +" WHERE    assetattrid2 IS NOT NULL "
 +"  "
 //+" UNION ALL "
 +"  "
 //+" SELECT ''                 assetnum    , "
 //+"        ''                 wonum       , "
 //+"        to_number('"+params["km"]+"')      km          , "
 //+"        1                  zveno       , "
 //+"        '99'               num         , "
 //+"        '15'               num_sort    , "
// +"        'Оценка километра' assetattrid , "
 //+"        NVL( "
 //+"              ( SELECT DISTINCT rating "
 //+"              FROM             defect "
 //+"              ) "
// +"            , "
// +"            ( SELECT DISTINCT rating "
// +"            FROM             zazor "
// +"            ) "
 //+"            )         ed_izm , "
// +"        TO_NUMBER('') TEMP   , "
// +"        200 rels, "
 //+"        TO_NUMBER('') NUMVALUE "
 //+" FROM   DUAL "
 +" ) c1"
 +"  join maximo.assetlocrelation astlr on c1.assetnum =  astlr.targetassetnum"
 +"  join maximo.assetspec astspc on astlr.sourceassetnum = astspc.assetnum and astlr.siteid = astspc.siteid "
 +" WHERE  rels in ("+tip_p+") and astlr.siteid = '"+params["mroSite"]+"' and astspc.assetattrid = 'NOM2'"
 +" GROUP BY c1.assetnum "
 +" 	,c1.wonum "
 +" 	,c1.km "
 +" 	,c1.zveno "
 +" 	,c1.num "
 +" 	,c1.num_sort "
 +" 	,c1.assetattrid "
 +" 	,c1.ed_izm "
 +" 	,c1.TEMP "
 +" 	,c1.rels "
 +"   	,astspc.alnvalue "


;


maximoDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[if (!maximoDataSet.fetch())
	return (false);

row["ASSETNUM"] = maximoDataSet.getString("ASSETNUM");
row["WONUM"] = maximoDataSet.getString("WONUM");
row["KM"] = maximoDataSet.getString("KM");
row["ZVENO"] = maximoDataSet.getString("ZVENO");
row["NUM_SORT"] = maximoDataSet.getString("NUM_SORT");
row["NUM"] = maximoDataSet.getString("NUM");
row["ASSETATTRID"] = maximoDataSet.getString("ASSETATTRID");
row["ED_IZM"] = maximoDataSet.getString("ED_IZM");
row["TEMP"] = maximoDataSet.getString("TEMP");
row["N_PUT"] = maximoDataSet.getString("N_PUT");
row["NUMVALUE"] = maximoDataSet.getString("NUMVALUE");

	
return (true);]]></method>
        </script-data-set>
        <script-data-set name="asset" id="13183">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">DIRECTION</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">DIRECTION_DESC</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">ASTS</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">AST_DESC</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">ASSETNUM</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">KM</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">DESCRIPTION</property>
                </structure>
                <structure>
                    <property name="columnName">ZVENO</property>
                </structure>
                <structure>
                    <property name="columnName">ASSETATTRID</property>
                </structure>
                <structure>
                    <property name="columnName">NUMVALUE</property>
                </structure>
                <structure>
                    <property name="columnName">NUM</property>
                </structure>
                <structure>
                    <property name="columnName">ED_IZM</property>
                </structure>
                <structure>
                    <property name="columnName">NUM_SORT</property>
                </structure>
                <structure>
                    <property name="columnName">TEMP</property>
                </structure>
                <structure>
                    <property name="columnName">DIRECTION</property>
                </structure>
                <structure>
                    <property name="columnName">DIRECTION_DESC</property>
                </structure>
                <structure>
                    <property name="columnName">ASTS</property>
                </structure>
                <structure>
                    <property name="columnName">AST_DESC</property>
                </structure>
                <structure>
                    <property name="columnName">ASSETNUM</property>
                </structure>
                <structure>
                    <property name="columnName">KM</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">DIRECTION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">DIRECTION_DESC</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">ASTS</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">AST_DESC</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">ASSETNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">KM</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[maximoDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());
maximoDataSet.open();

//if(params["date2"]=='' || params["date2"] == null || params["date2"] == '""' )
//{params["date2"]=  "sysdate";}
//else if(params["date2"]!='')
//{params["date2"]=  "'"+params["date2"]+"'";}
//if(params["year"]=='' || params["year"] == null || params["year"] == '""' )
//params["year"]=BirtDateTime.year(BirtDateTime.now());

var sqlText = new String();

sqlText = " "     
  +" WITH a1 AS "
 +"      (SELECT ast.direction           , "
 +"              ast.assetnum            , "
 +"              ast.description         , "
 +"              astlr.targetstartmeasure, "
 +"              astlr.targetendmeasure  , "
 +"              astfspc.siteid "
 +"      FROM    MAXIMO.assetfeaturespec astfspc "
 +"              JOIN maximo.asset gp "
 +"              ON      astfspc.assetnum = gp.assetnum "
 +"              AND     astfspc.siteid   = gp.siteid "
 +"              JOIN MAXIMO.assetlocrelation astlr "
 +"              ON      astfspc.assetnum = astlr.sourceassetnum "
 +"              AND     astfspc.siteid   = astlr.siteid "
 +"              JOIN maximo.asset ast "
 +"              ON      astlr.targetassetnum = ast.assetnum "
 +"              AND     astlr.siteid         = ast.siteid "
 +"      WHERE   tablevalue                   = 'PODR_108' "
 +"      AND     astfspc.siteid               = '24' "
 +"      AND     astfspc.assetattrid          = 'PODR' "
 +"      AND     gp.itemnum                   = 'ГЛПУТЬ' "
 +"      AND     ast.itemnum IN ('ПУТЬП', "
 +"                              'ГППС') "
 +"      AND "
 +"              ( "
 +"                      astfspc.startmeasure BETWEEN astlr.targetstartmeasure AND     astlr.targetendmeasure "
 +"              OR      astfspc.endmeasure BETWEEN astlr.targetstartmeasure AND     astlr.targetendmeasure "
 +"              ) "
 +"      AND     ast.status = 'РАБОТАЕТ' "
 +"      ) "
 +" SELECT a1.direction   , "
 +"        loc.description direction_desc, "
 +"        a2. asts       , "
 +"        a1.description ast_desc , "
 +"        to_char(a1.assetnum) assetnum, "
 +"        ceil(targetstartmeasure) km "
 +" FROM   a1 "
 +"        JOIN "
 +"               ( SELECT  direction, "
 +"                        to_char(SYS_XMLAGG(xmlelement(COL, a1.assetnum "
 +"                                 || ', ')).extract('/ROWSET/COL/text()').GETCLOBVAL()) asts "
 +"               FROM     a1 "
 +"               GROUP BY direction "
 +"               ) "
 +"               a2 "
 +"        ON     a1.direction = a2.direction "
 +"        JOIN maximo.locations loc "
 +"        ON     loc.location = a1.direction "
 +"        AND    a1.siteid    = loc.siteid "
;


maximoDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[if (!maximoDataSet.fetch())
	return (false);

row["DIRECTION"] = maximoDataSet.getString("DIRECTION");
row["DIRECTION_DESC"] = maximoDataSet.getString("DIRECTION_DESC");
row["ASTS"] = maximoDataSet.getString("ASTS");
row["AST_DESC"] = maximoDataSet.getString("AST_DESC");
row["ASSETNUM"] = maximoDataSet.getString("ASSETNUM");
row["KM"] = maximoDataSet.getString("KM");
	
return (true);]]></method>
        </script-data-set>
        <script-data-set name="site" id="3606">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">PD</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">PCHU</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">PCH</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">SITEID</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">PD</property>
                </structure>
                <structure>
                    <property name="columnName">PCHU</property>
                </structure>
                <structure>
                    <property name="columnName">PCH</property>
                </structure>
                <structure>
                    <property name="columnName">SITEID</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">PD</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">PCHU</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">PCH</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">SITEID</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[maximoDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());
maximoDataSet.open();


var sqlText = new String();
if (params["mroSite"] == "17")
sqlText = ""
  +" SELECT pd.Description   pd  ,  "
 +"        '' pchu,  "
 +"        pch.Description  pch ,  "
 +"        site.description siteid  "
 +" FROM   maximo.locations pd  "
 +"        JOIN MAXIMO.lochierarchy lh_pd  "
 +"        ON     pd.location = lh_pd.location  "
 +"        AND    pd.siteid   = lh_pd.siteid  "
 +"        JOIN maximo.locations pch  "
 +"        ON     lh_pd.parent = pch.location  "
 +"        AND    lh_pd.siteid = pch.siteid  "
 +"        JOIN maximo.site  "
 +"        ON     pd.siteid = site.siteid  "
 +" WHERE  pd.location      = '" + (params["podr"]).replace("=","") + "' "
 +" AND    siteid           = '"+params["mroSite"]+"' "
 else 
sqlText = ""
 +" SELECT pd.Description   pd  , "
 +"        pchu.Description pchu, "
 +"        pch.Description  pch , "
 +"        site.description siteid "
 +" FROM   maximo.locations pd "
 +"        JOIN MAXIMO.lochierarchy lh_pd "
 +"        ON     pd.location = lh_pd.location "
 +"        AND    pd.siteid   = lh_pd.siteid "
 +"        JOIN maximo.locations pchu "
 +"        ON     lh_pd.parent = pchu.location "
 +"        AND    lh_pd.siteid = pchu.siteid "
 +"        JOIN MAXIMO.lochierarchy lh_pchu "
 +"        ON     pchu.location = lh_pchu.location "
 +"        AND    pchu.siteid   = lh_pchu.siteid "
 +"        JOIN maximo.locations pch "
 +"        ON     lh_pchu.parent = pch.location "
 +"        AND    lh_pchu.siteid = pch.siteid "
 +"        JOIN maximo.site "
 +"        ON     pd.siteid = site.siteid "
 +" WHERE  pd.location      = '" + (params["podr"]).replace("=","") + "' "
 +" AND    siteid           = '"+params["mroSite"]+"' "

; 
maximoDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[if (!maximoDataSet.fetch()) return (false);
// Add a line for each output column
row["PD"] = maximoDataSet.getString("PD");
row["PCHU"] = maximoDataSet.getString("PCHU");
row["PCH"] = maximoDataSet.getString("PCH");
row["SITEID"] = maximoDataSet.getString("SITEID");
return (true);]]></method>
        </script-data-set>
    </data-sets>
    <cubes>
        <tabular-cube name="Data Cube" id="12910">
            <property name="dimensions">
                <tabular-dimension name="Group1" id="13005">
                    <property name="isTimeType">false</property>
                    <property name="defaultHierarchy">NewTabularHierarchy1</property>
                    <property name="hierarchies">
                        <tabular-hierarchy name="NewTabularHierarchy1" id="13006">
                            <property name="levels">
                                <tabular-level name="KM" id="13278">
                                    <property name="dataType">integer</property>
                                    <property name="columnName">KM</property>
                                </tabular-level>
                                <tabular-level name="N_PUT" id="13324">
                                    <property name="dataType">string</property>
                                    <property name="columnName">N_PUT</property>
                                </tabular-level>
                            </property>
                        </tabular-hierarchy>
                    </property>
                </tabular-dimension>
                <tabular-dimension name="Group" id="13072">
                    <property name="defaultHierarchy">NewTabularHierarchy</property>
                    <property name="hierarchies">
                        <tabular-hierarchy name="NewTabularHierarchy" id="13073">
                            <property name="levels">
                                <tabular-level name="NUM" id="13074">
                                    <property name="dataType">integer</property>
                                    <property name="columnName">NUM</property>
                                </tabular-level>
                                <tabular-level name="ASSETATTRID" id="13075">
                                    <property name="dataType">string</property>
                                    <property name="columnName">ASSETATTRID</property>
                                </tabular-level>
                                <tabular-level name="ED_IZM" id="13076">
                                    <property name="dataType">string</property>
                                    <property name="columnName">ED_IZM</property>
                                </tabular-level>
                                <tabular-level name="NUM_SORT" id="13077">
                                    <property name="dataType">string</property>
                                    <property name="columnName">NUM_SORT</property>
                                </tabular-level>
                            </property>
                        </tabular-hierarchy>
                    </property>
                </tabular-dimension>
            </property>
            <property name="measureGroups">
                <tabular-measure-group name="Summary Field" id="12917">
                    <property name="measures">
                        <tabular-measure name="NUMVALUE" id="12918">
                            <expression name="measureExpression">dataSetRow["NUMVALUE"]</expression>
                            <property name="dataType">integer</property>
                        </tabular-measure>
                    </property>
                </tabular-measure-group>
            </property>
            <property name="dataSet">11</property>
        </tabular-cube>
    </cubes>
    <page-setup>
        <simple-master-page name="maximoLandscape" id="47" extends="MaximoSystemLibrary.maximoLandscape">
            <property name="type">a4</property>
            <overridden-values>
                <ref-entry baseId="304" name="NewGrid2" id="304"/>
                <ref-entry baseId="305" id="305"/>
                <ref-entry baseId="306" id="306"/>
                <ref-entry baseId="307" id="307"/>
                <ref-entry baseId="308" id="308"/>
                <ref-entry baseId="340" name="NewImage1" id="340">
                    <property name="source">file</property>
                    <expression name="uri">"IBM_logo_Black.gif"</expression>
                    <property name="height">1px</property>
                    <property name="width">3px</property>
                </ref-entry>
                <ref-entry baseId="309" id="309"/>
                <ref-entry baseId="310" name="NewImage" id="310">
                    <property name="height">1px</property>
                    <property name="width">3px</property>
                </ref-entry>
                <ref-entry baseId="322" name="NewGrid" id="322"/>
                <ref-entry baseId="323" id="323"/>
                <ref-entry baseId="324" id="324"/>
                <ref-entry baseId="325" id="325"/>
                <ref-entry baseId="326" id="326"/>
                <ref-entry baseId="328" name="NewText" id="328">
                    <list-property name="visibility">
                        <structure>
                            <property name="format">all</property>
                            <expression name="valueExpr">true</expression>
                        </structure>
                    </list-property>
                </ref-entry>
                <ref-entry baseId="327" id="327"/>
                <ref-entry baseId="329" name="NewGrid1" id="329"/>
                <ref-entry baseId="330" id="330"/>
                <ref-entry baseId="331" id="331"/>
                <ref-entry baseId="332" id="332"/>
                <ref-entry baseId="333" id="333"/>
                <ref-entry baseId="334" id="334"/>
                <ref-entry baseId="335" name="NewAutoText" id="335">
                    <list-property name="visibility">
                        <structure>
                            <property name="format">all</property>
                            <expression name="valueExpr">true</expression>
                        </structure>
                    </list-property>
                </ref-entry>
                <ref-entry baseId="336" id="336"/>
                <ref-entry baseId="337" name="NewText1" id="337">
                    <list-property name="visibility">
                        <structure>
                            <property name="format">all</property>
                            <expression name="valueExpr">true</expression>
                        </structure>
                    </list-property>
                </ref-entry>
                <ref-entry baseId="338" id="338"/>
                <ref-entry baseId="339" name="NewAutoText1" id="339">
                    <list-property name="visibility">
                        <structure>
                            <property name="format">all</property>
                            <expression name="valueExpr">true</expression>
                        </structure>
                    </list-property>
                </ref-entry>
            </overridden-values>
        </simple-master-page>
    </page-setup>
    <body>
        <label id="13260">
            <property name="fontSize">medium</property>
            <property name="marginTop">0pt</property>
            <property name="textAlign">center</property>
            <list-property name="visibility">
                <structure>
                    <property name="format">all</property>
                    <expression name="valueExpr">params["asset"].value != 1</expression>
                </structure>
            </list-property>
            <text-property name="text">Выберите путь</text-property>
        </label>
        <table id="13105">
            <property name="width">100%</property>
            <property name="dataSet">site</property>
            <list-property name="visibility">
                <structure>
                    <property name="format">all</property>
                    <expression name="valueExpr">params["asset"].value == 1</expression>
                </structure>
            </list-property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">PCH</property>
                    <property name="displayName">PCH</property>
                    <expression name="expression">dataSetRow["PCH"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">PD</property>
                    <property name="displayName">PD</property>
                    <expression name="expression">dataSetRow["PD"].replace(/^(\w|\W)*ПД/, "ПД")</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">SITEID</property>
                    <property name="displayName">SITEID</property>
                    <expression name="expression">dataSetRow["SITEID"] + "железная дорога -"</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Aggregation</property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">AVE</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">qw</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">Aggregation_1</property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">AVE</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value"> er</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">Aggregation_2</property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">AVE</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">вам</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">Aggregation_3</property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">AVE</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">12</expression>
                        </structure>
                    </list-property>
                </structure>
            </list-property>
            <column id="13118">
                <property name="textAlign">left</property>
            </column>
            <column id="13119">
                <property name="fontSize">medium</property>
                <property name="textAlign">center</property>
            </column>
            <column id="13120">
                <property name="textAlign">right</property>
            </column>
            <header>
                <row id="13106">
                    <cell id="13107"/>
                    <cell id="13108"/>
                    <cell id="13109"/>
                </row>
                <row id="13121">
                    <cell id="13122"/>
                    <cell id="13123"/>
                    <cell id="13124">
                        <text-data id="13282">
                            <expression name="valueExpr">if (params["tip_p"] == 1)
this.text = "Форма для бесстыкового пути на";
if (params["tip_p"] == 2)
this.text = "Форма для звеньевого пути на ";
if (params["tip_p"] == 3)
this.text = "Форма для смешанного пути";</expression>
                            <property name="contentType">html</property>
                        </text-data>
                        <text-data id="13283">
                            <expression name="valueExpr">if (params["tip_p"] == 1)
this.text = "железобетонных шпалах";
if (params["tip_p"] == 2)
this.text = "деревянных шпалах";
if (params["tip_p"]== 3)
this.text = "";</expression>
                            <property name="contentType">html</property>
                        </text-data>
                    </cell>
                </row>
                <row id="13125">
                    <cell id="13126">
                        <data id="13174">
                            <property name="dataSet">site</property>
                            <list-property name="boundDataColumns">
                                <structure>
                                    <property name="name">PD</property>
                                    <expression name="expression">dataSetRow["PD"]</expression>
                                    <property name="dataType">string</property>
                                </structure>
                                <structure>
                                    <property name="name">PCHU</property>
                                    <expression name="expression">dataSetRow["PCHU"]</expression>
                                    <property name="dataType">string</property>
                                </structure>
                                <structure>
                                    <property name="name">PCH</property>
                                    <expression name="expression">dataSetRow["PCH"]</expression>
                                    <property name="dataType">string</property>
                                </structure>
                                <structure>
                                    <property name="name">SITEID</property>
                                    <expression name="expression">dataSetRow["SITEID"] + " железная дорога -"</expression>
                                    <property name="dataType">string</property>
                                </structure>
                            </list-property>
                            <property name="resultSetColumn">SITEID</property>
                        </data>
                    </cell>
                    <cell id="13127"/>
                    <cell id="13128"/>
                </row>
                <row id="13129">
                    <cell id="13130">
                        <label id="13160">
                            <text-property name="text">Филиал ОАО "РЖД"</text-property>
                        </label>
                    </cell>
                    <cell id="13131"/>
                    <cell id="13132"/>
                </row>
                <row id="13133">
                    <cell id="13134">
                        <property name="verticalAlign">bottom</property>
                        <label id="13161">
                            <text-property name="text">Дистанция пути  </text-property>
                        </label>
                    </cell>
                    <cell id="13135"/>
                    <cell id="13136"/>
                </row>
                <row id="13137">
                    <cell id="13138">
                        <data id="13170">
                            <property name="resultSetColumn">PCH</property>
                        </data>
                    </cell>
                    <cell id="13139"/>
                    <cell id="13140"/>
                </row>
                <row id="13141">
                    <cell id="13142">
                        <property name="verticalAlign">bottom</property>
                        <label id="13162">
                            <text-property name="text">Подразделение</text-property>
                        </label>
                    </cell>
                    <cell id="13143">
                        <text-data id="13167">
                            <expression name="valueExpr">if(params["year"]=='' || params["year"] == null || params["year"] == '""' )
params["year"]=BirtDateTime.year(BirtDateTime.now());
if ((params["osmotr"]).replace("=","") == 1)
this.text = 'Сводный технический паспорт осеннего осмотра пути в ' + params["year"].value + " году"
if ((params["osmotr"]).replace("=","") == 2)
this.text = 'Сводный технический паспорт весеннего осмотра пути в '+ params["year"].value + " году"</expression>
                            <property name="contentType">html</property>
                        </text-data>
                    </cell>
                    <cell id="13144"/>
                </row>
                <row id="13145">
                    <cell id="13146">
                        <data id="13171">
                            <property name="resultSetColumn">PD</property>
                        </data>
                    </cell>
                    <cell id="13147"/>
                    <cell id="13148"/>
                </row>
                <row id="13149">
                    <cell id="13150">
                        <label id="13275"/>
                        <label id="13163">
                            <text-property name="text">Рабочее отделение </text-property>
                        </label>
                    </cell>
                    <cell id="13151"/>
                    <cell id="13152"/>
                </row>
                <row id="13153">
                    <cell id="13154">
                        <label id="13276"/>
                    </cell>
                    <cell id="13155"/>
                    <cell id="13156"/>
                </row>
            </header>
        </table>
        <extended-item extensionName="Crosstab" extensionVersion="2.3.0" id="13078">
            <property name="measures">
                <extended-item extensionName="MeasureView" id="13098">
                    <property name="measure">NUMVALUE</property>
                    <property name="detail">
                        <extended-item extensionName="AggregationCell" id="13099">
                            <property name="aggregationOnRow">Group/NUM_SORT</property>
                            <property name="aggregationOnColumn">Group1/N_PUT</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="13100">
                                    <property name="resultSetColumn">NUMVALUE_Group/NUM_SORT_Group1/N_PUT</property>
                                </data>
                            </property>
                        </extended-item>
                    </property>
                    <property name="header">
                        <extended-item extensionName="CrosstabCell" id="13101">
                            <property name="backgroundColor">#C0C0C0</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                        </extended-item>
                    </property>
                </extended-item>
            </property>
            <property name="rows">
                <extended-item extensionName="CrosstabView" id="13080">
                    <property name="views">
                        <extended-item extensionName="DimensionView" id="13085">
                            <property name="dimension">Group</property>
                            <property name="levels">
                                <extended-item extensionName="LevelView" name="NewLevel View1" id="13086">
                                    <property name="level">Group/NUM</property>
                                    <property name="member">
                                        <extended-item extensionName="CrosstabCell" id="13087">
                                            <property name="content">
                                                <data name="NUM" id="13088">
                                                    <property name="resultSetColumn">NUM</property>
                                                </data>
                                            </property>
                                            <property name="fontWeight">normal</property>
                                            <property name="borderTopStyle">solid</property>
                                            <property name="borderTopWidth">thin</property>
                                            <property name="borderTopColor">#000000</property>
                                            <property name="borderLeftStyle">solid</property>
                                            <property name="borderLeftWidth">thin</property>
                                            <property name="borderLeftColor">#000000</property>
                                            <property name="borderBottomStyle">solid</property>
                                            <property name="borderBottomWidth">thin</property>
                                            <property name="borderBottomColor">#000000</property>
                                            <property name="borderRightStyle">solid</property>
                                            <property name="borderRightWidth">thin</property>
                                            <property name="borderRightColor">#000000</property>
                                        </extended-item>
                                    </property>
                                </extended-item>
                                <extended-item extensionName="LevelView" name="NewLevel View2" id="13089">
                                    <property name="level">Group/ASSETATTRID</property>
                                    <property name="member">
                                        <extended-item extensionName="CrosstabCell" id="13090">
                                            <property name="content">
                                                <data name="ASSETATTRID" id="13091">
                                                    <property name="resultSetColumn">ASSETATTRID</property>
                                                </data>
                                            </property>
                                            <property name="fontWeight">normal</property>
                                            <property name="textAlign">left</property>
                                            <property name="borderTopStyle">solid</property>
                                            <property name="borderTopWidth">thin</property>
                                            <property name="borderTopColor">#000000</property>
                                            <property name="borderLeftStyle">solid</property>
                                            <property name="borderLeftWidth">thin</property>
                                            <property name="borderLeftColor">#000000</property>
                                            <property name="borderBottomStyle">solid</property>
                                            <property name="borderBottomWidth">thin</property>
                                            <property name="borderBottomColor">#000000</property>
                                            <property name="borderRightStyle">solid</property>
                                            <property name="borderRightWidth">thin</property>
                                            <property name="borderRightColor">#000000</property>
                                        </extended-item>
                                    </property>
                                </extended-item>
                                <extended-item extensionName="LevelView" name="NewLevel View3" id="13092">
                                    <property name="level">Group/ED_IZM</property>
                                    <property name="member">
                                        <extended-item extensionName="CrosstabCell" id="13093">
                                            <property name="content">
                                                <data name="ED_IZM" id="13094">
                                                    <property name="resultSetColumn">ED_IZM</property>
                                                </data>
                                            </property>
                                            <property name="fontWeight">normal</property>
                                            <property name="borderTopStyle">solid</property>
                                            <property name="borderTopWidth">thin</property>
                                            <property name="borderTopColor">#000000</property>
                                            <property name="borderLeftStyle">solid</property>
                                            <property name="borderLeftWidth">thin</property>
                                            <property name="borderLeftColor">#000000</property>
                                            <property name="borderBottomStyle">solid</property>
                                            <property name="borderBottomWidth">thin</property>
                                            <property name="borderBottomColor">#000000</property>
                                        </extended-item>
                                    </property>
                                </extended-item>
                                <extended-item extensionName="LevelView" name="NewLevel View4" id="13095">
                                    <property name="level">Group/NUM_SORT</property>
                                    <property name="sort">
                                        <sort-element>
                                            <expression name="key">data["NUM_SORT"] * 1</expression>
                                            <property name="direction">asc</property>
                                        </sort-element>
                                    </property>
                                    <property name="member">
                                        <extended-item extensionName="CrosstabCell" id="13096">
                                            <property name="content">
                                                <data name="NUM_SORT" id="13097">
                                                    <list-property name="visibility">
                                                        <structure>
                                                            <property name="format">all</property>
                                                            <expression name="valueExpr">true</expression>
                                                        </structure>
                                                    </list-property>
                                                    <property name="resultSetColumn">NUM_SORT</property>
                                                </data>
                                            </property>
                                            <property name="fontWeight">normal</property>
                                            <property name="borderTopStyle">solid</property>
                                            <property name="borderTopWidth">thin</property>
                                            <property name="borderTopColor">#000000</property>
                                            <property name="borderBottomStyle">solid</property>
                                            <property name="borderBottomWidth">thin</property>
                                            <property name="borderBottomColor">#000000</property>
                                            <property name="borderRightStyle">solid</property>
                                            <property name="borderRightWidth">thin</property>
                                            <property name="borderRightColor">#000000</property>
                                        </extended-item>
                                    </property>
                                </extended-item>
                            </property>
                        </extended-item>
                    </property>
                </extended-item>
            </property>
            <property name="columns">
                <extended-item extensionName="CrosstabView" id="13103">
                    <property name="views">
                        <extended-item extensionName="DimensionView" id="13081">
                            <property name="dimension">Group1</property>
                            <property name="levels">
                                <extended-item extensionName="LevelView" name="NewLevel View" id="13279">
                                    <property name="level">Group1/KM</property>
                                    <property name="member">
                                        <extended-item extensionName="CrosstabCell" id="13280">
                                            <property name="content">
                                                <data name="KM" id="13281">
                                                    <property name="resultSetColumn">KM</property>
                                                </data>
                                            </property>
                                            <property name="backgroundColor">#C0C0C0</property>
                                            <property name="borderTopStyle">solid</property>
                                            <property name="borderTopWidth">thin</property>
                                            <property name="borderTopColor">#000000</property>
                                            <property name="borderLeftStyle">solid</property>
                                            <property name="borderLeftWidth">thin</property>
                                            <property name="borderLeftColor">#000000</property>
                                            <property name="borderRightStyle">solid</property>
                                            <property name="borderRightWidth">thin</property>
                                            <property name="borderRightColor">#000000</property>
                                        </extended-item>
                                    </property>
                                </extended-item>
                                <extended-item extensionName="LevelView" name="NewLevel View5" id="13325">
                                    <property name="level">Group1/N_PUT</property>
                                    <property name="member">
                                        <extended-item extensionName="CrosstabCell" id="13326">
                                            <property name="content">
                                                <data name="N_PUT" id="13327">
                                                    <property name="resultSetColumn">N_PUT</property>
                                                </data>
                                            </property>
                                            <property name="backgroundColor">#C0C0C0</property>
                                            <property name="borderTopStyle">solid</property>
                                            <property name="borderTopWidth">thin</property>
                                            <property name="borderTopColor">#000000</property>
                                            <property name="borderLeftStyle">solid</property>
                                            <property name="borderLeftWidth">thin</property>
                                            <property name="borderLeftColor">#000000</property>
                                            <property name="borderRightStyle">solid</property>
                                            <property name="borderRightWidth">thin</property>
                                            <property name="borderRightColor">#000000</property>
                                        </extended-item>
                                    </property>
                                </extended-item>
                            </property>
                        </extended-item>
                    </property>
                </extended-item>
            </property>
            <property name="header">
                <extended-item extensionName="CrosstabCell" id="13079">
                    <property name="content">
                        <label id="13104">
                            <property name="textAlign">center</property>
                            <text-property name="text">Состояние пути и отдельных его элементов</text-property>
                        </label>
                    </property>
                    <property name="backgroundColor">#C0C0C0</property>
                    <property name="borderTopStyle">solid</property>
                    <property name="borderTopWidth">thin</property>
                    <property name="borderTopColor">#000000</property>
                    <property name="borderLeftStyle">solid</property>
                    <property name="borderLeftWidth">thin</property>
                    <property name="borderLeftColor">#000000</property>
                    <property name="borderBottomStyle">solid</property>
                    <property name="borderBottomWidth">thin</property>
                    <property name="borderBottomColor">#000000</property>
                    <property name="borderRightStyle">solid</property>
                    <property name="borderRightWidth">thin</property>
                    <property name="borderRightColor">#000000</property>
                </extended-item>
            </property>
            <property name="cube">Data Cube</property>
            <list-property name="visibility">
                <structure>
                    <property name="format">all</property>
                    <expression name="valueExpr">params["asset"].value == 1</expression>
                </structure>
            </list-property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">NUM</property>
                    <expression name="expression">dimension["Group"]["NUM"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">ASSETATTRID</property>
                    <expression name="expression">dimension["Group"]["ASSETATTRID"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">ED_IZM</property>
                    <expression name="expression">dimension["Group"]["ED_IZM"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">NUM_SORT</property>
                    <expression name="expression">dimension["Group"]["NUM_SORT"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">NUMVALUE_Group/NUM_SORT</property>
                    <expression name="expression">measure["NUMVALUE"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group/NUM_SORT</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">KM</property>
                    <expression name="expression">dimension["Group1"]["KM"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">NUMVALUE_Group/NUM_SORT_Group1/KM</property>
                    <expression name="expression">measure["NUMVALUE"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group/NUM_SORT</value>
                        <value>Group1/KM</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">N_PUT</property>
                    <expression name="expression">dimension["Group1"]["N_PUT"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">NUMVALUE_Group/NUM_SORT_Group1/N_PUT</property>
                    <expression name="expression">measure["NUMVALUE"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group/NUM_SORT</value>
                        <value>Group1/N_PUT</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
            </list-property>
        </extended-item>
        <table id="13284">
            <property name="width">100%</property>
            <property name="dataSet">asset</property>
            <list-property name="visibility">
                <structure>
                    <property name="format">all</property>
                    <expression name="valueExpr">params["asset"].value != 1</expression>
                </structure>
            </list-property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">DIRECTION</property>
                    <property name="displayName">DIRECTION</property>
                    <expression name="expression">dataSetRow["DIRECTION"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">DIRECTION_DESC</property>
                    <property name="displayName">DIRECTION_DESC</property>
                    <expression name="expression">dataSetRow["DIRECTION_DESC"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">ASTS</property>
                    <property name="displayName">ASTS</property>
                    <expression name="expression">("'"+dataSetRow["ASTS"]+"'").replace(/, /g ,  "', '").replace(/\', \'\'$/ ,"'")
//dataSetRow["ASTS"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">AST_DESC</property>
                    <property name="displayName">AST_DESC</property>
                    <expression name="expression">dataSetRow["AST_DESC"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">ASSETNUM</property>
                    <property name="displayName">ASSETNUM</property>
                    <expression name="expression">"'"+dataSetRow["ASSETNUM"]+"'"</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">KM</property>
                    <property name="displayName">KM</property>
                    <expression name="expression">dataSetRow["KM"]</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="sort">
                <structure>
                    <expression name="key">row["DIRECTION_DESC"]</expression>
                    <property name="direction">asc</property>
                </structure>
                <structure>
                    <expression name="key">row["AST_DESC"]</expression>
                    <property name="direction">asc</property>
                </structure>
            </list-property>
            <column id="13318">
                <list-property name="visibility">
                    <structure>
                        <property name="format">all</property>
                        <expression name="valueExpr">true</expression>
                    </structure>
                </list-property>
            </column>
            <column id="13319">
                <property name="suppressDuplicates">true</property>
            </column>
            <column id="13320">
                <list-property name="visibility">
                    <structure>
                        <property name="format">all</property>
                        <expression name="valueExpr">true</expression>
                    </structure>
                </list-property>
            </column>
            <column id="13321"/>
            <column id="13322">
                <list-property name="visibility">
                    <structure>
                        <property name="format">all</property>
                        <expression name="valueExpr">true</expression>
                    </structure>
                </list-property>
            </column>
            <column id="13323">
                <list-property name="visibility">
                    <structure>
                        <property name="format">all</property>
                        <expression name="valueExpr">true</expression>
                    </structure>
                </list-property>
            </column>
            <header>
                <row id="13285">
                    <property name="backgroundColor">#C0C0C0</property>
                    <cell id="13286">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <label id="13287">
                            <text-property name="text">DIRECTION</text-property>
                        </label>
                    </cell>
                    <cell id="13288">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <label id="13289">
                            <text-property name="text">Направление</text-property>
                        </label>
                    </cell>
                    <cell id="13290">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <label id="13291">
                            <text-property name="text">ASTS</text-property>
                        </label>
                    </cell>
                    <cell id="13292">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <label id="13293">
                            <text-property name="text">Актив</text-property>
                        </label>
                    </cell>
                    <cell id="13294">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <label id="13295">
                            <text-property name="text">ASSETNUM</text-property>
                        </label>
                    </cell>
                    <cell id="13296">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <label id="13297">
                            <text-property name="text">KM</text-property>
                        </label>
                    </cell>
                </row>
            </header>
            <detail>
                <row id="13298">
                    <cell id="13299">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="13300">
                            <property name="resultSetColumn">DIRECTION</property>
                        </data>
                    </cell>
                    <cell id="13301">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="13302">
                            <property name="resultSetColumn">DIRECTION_DESC</property>
                            <structure name="action">
                                <property name="linkType">drill-through</property>
                                <property name="reportName">tso_pasport_pd.rptdesign</property>
                                <property name="targetWindow">_blank</property>
                                <property name="targetFileType">report-design</property>
                                <list-property name="paramBindings">
                                    <structure>
                                        <property name="paramName">where</property>
                                        <expression name="expression">"1=1"</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">appname</property>
                                        <expression name="expression">"WOTRACK_OS"</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">mroSite</property>
                                        <expression name="expression">params["mroSite"].value</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">podr</property>
                                        <expression name="expression">params["podr"].value</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">osmotr</property>
                                        <expression name="expression">params["osmotr"].value</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">asset</property>
                                        <expression name="expression">row["ASTS"]</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">km</property>
                                        <expression name="expression">row["KM"]</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">tip_p</property>
                                        <expression name="expression">params["tip_p"].value</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">year</property>
                                        <expression name="expression">params["year"].value</expression>
                                    </structure>
                                </list-property>
                            </structure>
                        </data>
                    </cell>
                    <cell id="13303">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="13304">
                            <property name="resultSetColumn">ASTS</property>
                        </data>
                    </cell>
                    <cell id="13305">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="13306">
                            <property name="resultSetColumn">AST_DESC</property>
                            <structure name="action">
                                <property name="linkType">drill-through</property>
                                <property name="reportName">tso_pasport_pd.rptdesign</property>
                                <property name="targetWindow">_blank</property>
                                <property name="targetFileType">report-design</property>
                                <list-property name="paramBindings">
                                    <structure>
                                        <property name="paramName">where</property>
                                        <expression name="expression">"1=1"</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">appname</property>
                                        <expression name="expression">"WOTRACK_OS"</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">mroSite</property>
                                        <expression name="expression">params["mroSite"].value</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">podr</property>
                                        <expression name="expression">params["podr"].value</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">osmotr</property>
                                        <expression name="expression">params["osmotr"].value</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">asset</property>
                                        <expression name="expression">row["ASSETNUM"]</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">km</property>
                                        <expression name="expression">row["KM"]</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">year</property>
                                        <expression name="expression">params["year"].value</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">tip_p</property>
                                        <expression name="expression">params["tip_p"].value</expression>
                                    </structure>
                                </list-property>
                            </structure>
                        </data>
                    </cell>
                    <cell id="13307">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="13308">
                            <property name="resultSetColumn">ASSETNUM</property>
                        </data>
                    </cell>
                    <cell id="13309">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="13310">
                            <property name="resultSetColumn">KM</property>
                        </data>
                    </cell>
                </row>
            </detail>
        </table>
        <label id="13219"/>
        <grid id="13265">
            <property name="width">100%</property>
            <list-property name="visibility">
                <structure>
                    <property name="format">all</property>
                    <expression name="valueExpr">params["asset"].value == 1</expression>
                </structure>
            </list-property>
            <column id="13266"/>
            <column id="13267"/>
            <row id="13268">
                <cell id="13269">
                    <label id="13271">
                        <text-property name="text">Дорожный мастер подразделения </text-property>
                    </label>
                </cell>
                <cell id="13270">
                    <label id="13272">
                        <text-property name="text">Начальник дистанции</text-property>
                    </label>
                </cell>
            </row>
        </grid>
    </body>
</report>
