<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.17" id="1">
    <property name="createdBy">Eclipse BIRT Designer Version 2.3.2.r232_20090202 Build &lt;2.3.2.v20090218-0730></property>
    <property name="units">in</property>
    <text-property name="title">Контроль заполнения материалов по предприятию за период</text-property>
    <property name="comments">IBM Confidential

OCO Source Materials

5724-M19

(C) COPYRIGHT IBM CORP. 2006

The source code for this program is not published or otherwise
divested of its trade secrets, irrespective of what has been
deposited with the U.S. Copyright Office.</property>
    <html-property name="description">This template will create a report with one or more groups, each having identical data fields, and contains three styles of charts.</html-property>
    <method name="initialize"><![CDATA[importPackage(Packages.com.ibm.tivoli.maximo.report.script);

mxReportScriptContext = MXReportScriptContext.initialize(reportContext);


mxReportScriptContext = MXReportScriptContext.initialize(reportContext);
mxReportScriptContext.setDefaultLogLevel("DEBUG");
mxReportScriptContext.setDefaultLogFile("c:/temp/tetttt.txt");
]]></method>
    <method name="afterFactory"><![CDATA[MXReportScriptContext.close();]]></method>
    <property name="theme">MaximoSystemLibrary.maximoTheme</property>
    <text-property name="displayName">Tivoli Maximo Grouped Chart Template</text-property>
    <list-property name="libraries">
        <structure>
            <property name="fileName">MaximoSystemLibrary.rptlibrary</property>
            <property name="namespace">MaximoSystemLibrary</property>
        </structure>
    </list-property>
    <parameters>
        <scalar-parameter name="where" id="25">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <property name="defaultValue">1=1</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="appname" id="240">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="mroSite" id="7964">
            <property name="valueType">static</property>
            <property name="dataType">integer</property>
            <property name="paramType">simple</property>
            <text-property name="promptText">Дорога</text-property>
            <property name="isRequired">true</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="pred" id="17062">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <text-property name="promptText">Дистанция</text-property>
            <property name="isRequired">true</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="date1" id="17788">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <text-property name="promptText">Начало периода</text-property>
            <property name="isRequired">true</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="date2" id="17789">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <text-property name="promptText">Конец периода</text-property>
            <property name="isRequired">true</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <script-data-source name="maximoDataSource" id="64" extends="MaximoSystemLibrary.maximoDataSource"/>
    </data-sources>
    <data-sets>
        <script-data-set name="11" id="7971">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">L_PODR</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">L_PODR_D</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">JPNUM</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">ALL_WO</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">ALL_TK</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">YESNO</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">ITEM_GOST</property>
                </structure>
                <structure>
                    <property name="columnName">ITEM_RAZMER</property>
                </structure>
                <structure>
                    <property name="columnName">ZAM</property>
                </structure>
                <structure>
                    <property name="columnName">TELEGA</property>
                </structure>
                <structure>
                    <property name="columnName">KAP_REM</property>
                </structure>
                <structure>
                    <property name="columnName">PROCH</property>
                </structure>
                <structure>
                    <property name="columnName">L_PODR</property>
                </structure>
                <structure>
                    <property name="columnName">L_PODR_D</property>
                </structure>
                <structure>
                    <property name="columnName">JPNUM</property>
                </structure>
                <structure>
                    <property name="columnName">ALL_WO</property>
                </structure>
                <structure>
                    <property name="columnName">ALL_TK</property>
                </structure>
                <structure>
                    <property name="columnName">YESNO</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">L_PODR</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">L_PODR_D</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">JPNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">ALL_WO</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">ALL_TK</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">YESNO</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[maximoDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());
maximoDataSet.open();

var sqlText = new String();

sqlText = "" 
+"WITH ALL_WO AS " 
+"        ( SELECT wo.wonum, " 
+"                WO.SITEID, " 
+"                BRIGAD_LOCATION L_PODR, " 
+"                WO.ACTFINISH " 
+"        FROM    MAXIMO.WORKORDER WO " 
+"        WHERE   BRIGAD_LOCATION IS NOT NULL " 
+"                AND wo.STATUS IN ( 'ТЕХОТДЕЛ' , 'ЗАКРЫТО', 'ЗАВ_ДИСП', 'ЗАВЕРШ', 'ДОРАБОТКА' ) " 
+"                AND wo.siteid                     = '"+params["mroSite"]+"'"  
+"                AND WO.L_PRED                     = '"+params["pred"]+"'" 
+"				  and wo.actfinish between to_date('"+params["date1"]+"') and to_date ('"+params["date2"]+"')+1 "
//+"                AND TO_CHAR(WO.ACTFINISH, 'YYYY') = '2014' " 
//+"                AND TO_CHAR(WO.ACTFINISH, 'MM')   = '03' " 
+"        ) " 
+"        , " 
+"        WO AS " 
+"        ( SELECT wo.wonum, " 
+"                wo.siteid, " 
+"                l_podr, " 
+"                JP.JPNUM " 
+"        FROM    all_WO wo " 
+"                JOIN MAXIMO.wojprelation jpr " 
+"                        ON      wo.wonum               = jpr.wonum " 
+"                                AND JPR.USETHISMEASURE = '1' " 
+"                JOIN Maximo.Jobplan jp " 
+"                        ON      JP.JOBPLANID = JPR.JOBPLANID " 
+"                                AND jp.JOBPLANID IN ('17107', '17106', '16919', '16675', '16690', '16674', '16694', '16648', '16656') " 
+"        ) " 
+"        , " 
+"        MATUSE AS " 
+"        (SELECT wo.wonum, " 
+"                COUNT (Matusetrans.Itemnum) matuse " 
+"        FROM    wo " 
+"                JOIN Maximo.Matusetrans " 
+"                        ON      wo.Wonum      = Matusetrans.Refwo " 
+"        WHERE   MATUSETRANS.ITEMNUM IS NOT NULL " 
+"        GROUP BY WO.WONUM " 
+"        ) " 
+"        , " 
+"        UNWORK AS " 
+"        (SELECT wo.wonum, " 
+"                COUNT (UNWORKITEM.ITEMNUM) unwork " 
+"        FROM    wo " 
+"                JOIN Maximo.Unworkitem " 
+"                        ON      Unworkitem.Wonum = wo.Wonum " 
+"        WHERE   UNWORKITEM.ITEMNUM     IS NOT NULL " 
+"        GROUP BY wo.wonum " 
+"        ) " 
+"SELECT  ALL_WO.L_PODR, " 
+"        LOC.DESCRIPTION                                                        PODR_D, " 
+"        MIN(ALL_WO.ACTFINISH)                                                  MIN_DATE, " 
+"        MAX(all_WO.ACTFINISH)                                                  MAX_DATE, " 
+"        COUNT (all_WO.WONUM)                                                   ALL_WO, " 
+"        COUNT(WO.JPNUM)                                                        ALL_TK, " 
+"        SUM(CASE WHEN UNWORK.UNWORK >0 OR MATUSE.MATUSE > 0 THEN 1 ELSE 0 END) YESNO " 
+"FROM    ALL_WO " 
+"        LEFT JOIN WO " 
+"                ON      ALL_WO.WONUM = WO.WONUM " 
+"        LEFT JOIN matuse " 
+"                ON      WO.WONUM = MATUSE.WONUM " 
+"        LEFT JOIN unwork " 
+"                ON      WO.WONUM = UNWORK.WONUM " 
+"        JOIN MAXIMO.LOCATIONS LOC " 
+"                ON      ALL_WO.L_PODR     = loc.location " 
+"                        AND ALL_WO.SITEID = loc.SITEID " 
+"GROUP BY ALL_WO.L_PODR, " 
+"        loc.description"
 ;


maximoDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[if (!maximoDataSet.fetch())
	return (false);
row["L_PODR"] = maximoDataSet.getString("L_PODR");
row["L_PODR_D"] = maximoDataSet.getString("PODR_D");
row["ALL_WO"] = maximoDataSet.getString("ALL_WO");
row["ALL_TK"] = maximoDataSet.getString("ALL_TK");
row["YESNO"] = maximoDataSet.getString("YESNO");

	
return (true);]]></method>
        </script-data-set>
        <script-data-set name="label" id="13864">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">PRED_D</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">SITE_D</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">PODREZ_USTR</property>
                </structure>
                <structure>
                    <property name="columnName">RAZGON</property>
                </structure>
                <structure>
                    <property name="columnName">RAZGON_USTR</property>
                </structure>
                <structure>
                    <property name="columnName">UGON</property>
                </structure>
                <structure>
                    <property name="columnName">UGON_USTR</property>
                </structure>
                <structure>
                    <property name="columnName">d</property>
                </structure>
                <structure>
                    <property name="columnName">site</property>
                </structure>
                <structure>
                    <property name="columnName">SITE</property>
                </structure>
                <structure>
                    <property name="columnName">PODR</property>
                </structure>
                <structure>
                    <property name="columnName">PRED_D</property>
                </structure>
                <structure>
                    <property name="columnName">SITE_D</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">PRED_D</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">SITE_D</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[maximoDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());
maximoDataSet.open();



var sqlText = new String();

sqlText = "" 
+"SELECT  preds.description pred_d, " 
+"        site.description  site_d " 
+"FROM    maximo.preds " 
+"        JOIN maximo.site " 
+"                ON      preds.siteid = site.siteid " 
+"WHERE   preds.siteid                 = '"+params["mroSite"]+"'" 
+"        AND preds.location           = '"+params["pred"]+"'"   
 
;


maximoDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[if (!maximoDataSet.fetch())
	return (false);

row["PRED_D"] = maximoDataSet.getString("PRED_D");
row["SITE_D"] = maximoDataSet.getString("SITE_D");

return (true);]]></method>
        </script-data-set>
    </data-sets>
    <cubes>
        <tabular-cube name="Data Cube" id="17529">
            <property name="dimensions">
                <tabular-dimension name="Group" id="17530">
                    <property name="defaultHierarchy">NewTabularHierarchy</property>
                    <property name="hierarchies">
                        <tabular-hierarchy name="NewTabularHierarchy" id="17531">
                            <property name="levels">
                                <tabular-level name="L_PODR" id="17532">
                                    <property name="dataType">string</property>
                                    <property name="columnName">L_PODR</property>
                                </tabular-level>
                                <tabular-level name="L_PODR_D" id="17569">
                                    <property name="dataType">string</property>
                                    <property name="columnName">L_PODR_D</property>
                                </tabular-level>
                            </property>
                        </tabular-hierarchy>
                    </property>
                </tabular-dimension>
                <tabular-dimension name="Group1" id="17533">
                    <property name="defaultHierarchy">NewTabularHierarchy1</property>
                    <property name="hierarchies">
                        <tabular-hierarchy name="NewTabularHierarchy1" id="17534">
                            <property name="levels">
                                <tabular-level name="JPNUM" id="17535">
                                    <property name="dataType">string</property>
                                    <property name="columnName">JPNUM</property>
                                </tabular-level>
                            </property>
                        </tabular-hierarchy>
                    </property>
                </tabular-dimension>
            </property>
            <property name="measureGroups">
                <tabular-measure-group name="Summary Field" id="17536">
                    <property name="measures">
                        <tabular-measure name="ALL_WO" id="17537">
                            <expression name="measureExpression">dataSetRow["ALL_WO"]</expression>
                            <property name="dataType">string</property>
                        </tabular-measure>
                    </property>
                </tabular-measure-group>
                <tabular-measure-group name="Summary Field1" id="17538">
                    <property name="measures">
                        <tabular-measure name="ALL_TK" id="17539">
                            <expression name="measureExpression">dataSetRow["ALL_TK"]</expression>
                            <property name="dataType">string</property>
                        </tabular-measure>
                    </property>
                </tabular-measure-group>
                <tabular-measure-group name="Summary Field2" id="17540">
                    <property name="measures">
                        <tabular-measure name="YESNO" id="17541">
                            <expression name="measureExpression">dataSetRow["YESNO"]</expression>
                            <property name="dataType">string</property>
                        </tabular-measure>
                    </property>
                </tabular-measure-group>
            </property>
            <property name="dataSet">11</property>
        </tabular-cube>
    </cubes>
    <page-setup>
        <simple-master-page name="maximoLandscape" id="47" extends="MaximoSystemLibrary.maximoLandscape">
            <property name="type">a4</property>
            <overridden-values>
                <ref-entry baseId="304" name="NewGrid2" id="304"/>
                <ref-entry baseId="305" id="305"/>
                <ref-entry baseId="306" id="306"/>
                <ref-entry baseId="307" id="307"/>
                <ref-entry baseId="308" id="308"/>
                <ref-entry baseId="340" name="NewImage1" id="340">
                    <property name="source">file</property>
                    <expression name="uri">"IBM_logo_Black.gif"</expression>
                    <property name="height">1px</property>
                    <property name="width">3px</property>
                </ref-entry>
                <ref-entry baseId="309" id="309"/>
                <ref-entry baseId="310" name="NewImage" id="310">
                    <property name="height">1px</property>
                    <property name="width">3px</property>
                </ref-entry>
                <ref-entry baseId="322" name="NewGrid" id="322"/>
                <ref-entry baseId="323" id="323"/>
                <ref-entry baseId="324" id="324"/>
                <ref-entry baseId="325" id="325"/>
                <ref-entry baseId="326" id="326"/>
                <ref-entry baseId="328" name="NewText" id="328">
                    <list-property name="visibility">
                        <structure>
                            <property name="format">all</property>
                            <expression name="valueExpr">true</expression>
                        </structure>
                    </list-property>
                </ref-entry>
                <ref-entry baseId="327" id="327"/>
                <ref-entry baseId="329" name="NewGrid1" id="329"/>
                <ref-entry baseId="330" id="330"/>
                <ref-entry baseId="331" id="331"/>
                <ref-entry baseId="332" id="332"/>
                <ref-entry baseId="333" id="333"/>
                <ref-entry baseId="334" id="334"/>
                <ref-entry baseId="335" name="NewAutoText" id="335">
                    <list-property name="visibility">
                        <structure>
                            <property name="format">all</property>
                            <expression name="valueExpr">true</expression>
                        </structure>
                    </list-property>
                </ref-entry>
                <ref-entry baseId="336" id="336"/>
                <ref-entry baseId="337" name="NewText1" id="337">
                    <list-property name="visibility">
                        <structure>
                            <property name="format">all</property>
                            <expression name="valueExpr">true</expression>
                        </structure>
                    </list-property>
                </ref-entry>
                <ref-entry baseId="338" id="338"/>
                <ref-entry baseId="339" name="NewAutoText1" id="339">
                    <list-property name="visibility">
                        <structure>
                            <property name="format">all</property>
                            <expression name="valueExpr">true</expression>
                        </structure>
                    </list-property>
                </ref-entry>
            </overridden-values>
        </simple-master-page>
    </page-setup>
    <body>
        <data id="17791">
            <property name="fontSize">medium</property>
            <property name="textAlign">center</property>
            <property name="dataSet">label</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">PRED_D</property>
                    <property name="displayName">PRED_D</property>
                    <expression name="expression">"Контроль заполнения материалов по " + dataSetRow["PRED_D"] +" "+ dataSetRow["SITE_D"].replace("ая", "ой") + " ж. д. за период с " + params["date1"].value + " по " + params["date2"].value</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <property name="resultSetColumn">PRED_D</property>
        </data>
        <label id="17792"/>
        <table id="17714">
            <property name="width">100%</property>
            <property name="dataSet">11</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">L_PODR</property>
                    <property name="displayName">L_PODR</property>
                    <expression name="expression">dataSetRow["L_PODR"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">L_PODR_D</property>
                    <property name="displayName">L_PODR_D</property>
                    <expression name="expression">dataSetRow["L_PODR_D"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">JPNUM</property>
                    <property name="displayName">JPNUM</property>
                    <expression name="expression">dataSetRow["JPNUM"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">ALL_WO</property>
                    <property name="displayName">ALL_WO</property>
                    <expression name="expression">dataSetRow["ALL_WO"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">ALL_TK</property>
                    <property name="displayName">ALL_TK</property>
                    <expression name="expression">dataSetRow["ALL_TK"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">YESNO</property>
                    <property name="displayName">YESNO</property>
                    <expression name="expression">dataSetRow["YESNO"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">mat_no</property>
                    <expression name="expression">if (dataSetRow["ALL_TK"] != null &amp; dataSetRow["ALL_TK"] != 0 )
(dataSetRow["ALL_TK"]-dataSetRow["YESNO"])/dataSetRow["ALL_TK"]</expression>
                    <property name="dataType">float</property>
                </structure>
                <structure>
                    <property name="name">sum_wo</property>
                    <property name="dataType">integer</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">row["ALL_WO"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">sum_tk</property>
                    <property name="dataType">integer</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">row["ALL_TK"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">sum_yesno</property>
                    <property name="dataType">integer</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">row["YESNO"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">t_mat_no</property>
                    <expression name="expression">if (row["sum_tk"] != null &amp; row["sum_tk"] != 0 )
(row["sum_tk"]-row["sum_yesno"])/row["sum_tk"]</expression>
                    <property name="dataType">float</property>
                </structure>
            </list-property>
            <list-property name="sort">
                <structure>
                    <expression name="key">row["mat_no"]</expression>
                    <property name="direction">desc</property>
                </structure>
            </list-property>
            <column id="17748">
                <list-property name="visibility">
                    <structure>
                        <property name="format">all</property>
                        <expression name="valueExpr">true</expression>
                    </structure>
                </list-property>
            </column>
            <column id="17749"/>
            <column id="17751"/>
            <column id="17752"/>
            <column id="17753"/>
            <column id="17777"/>
            <header>
                <row id="17715">
                    <cell id="17716">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="17717">
                            <text-property name="text">L_PODR</text-property>
                        </label>
                    </cell>
                    <cell id="17718">
                        <property name="colSpan">1</property>
                        <property name="rowSpan">2</property>
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="17719">
                            <text-property name="text">Подразделение</text-property>
                        </label>
                    </cell>
                    <cell id="17722">
                        <property name="colSpan">1</property>
                        <property name="rowSpan">2</property>
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="17723">
                            <text-property name="text">Всего рабочих заданий</text-property>
                        </label>
                    </cell>
                    <cell id="17724">
                        <property name="colSpan">3</property>
                        <property name="rowSpan">1</property>
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="17725">
                            <text-property name="text">Рабочие задания с тех.картой из перечня</text-property>
                            <structure name="action">
                                <property name="linkType">drill-through</property>
                                <property name="reportName">material_contro_pred_cube.rptdesign</property>
                                <property name="targetWindow">_blank</property>
                                <property name="targetFileType">report-design</property>
                                <list-property name="paramBindings">
                                    <structure>
                                        <property name="paramName">where</property>
                                        <expression name="expression">"1=1"</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">appname</property>
                                        <expression name="expression">"WOTRACK"</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">mroSite</property>
                                        <expression name="expression">params["mroSite"].value</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">pred</property>
                                        <expression name="expression">params["pred"].value</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">visible</property>
                                        <expression name="expression">0</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">date1</property>
                                        <expression name="expression">params["date1"].value</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">date2</property>
                                        <expression name="expression">params["date2"].value</expression>
                                    </structure>
                                </list-property>
                            </structure>
                        </label>
                    </cell>
                </row>
                <row id="17754">
                    <cell id="17755">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                    </cell>
                    <cell id="17758">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="17766">
                            <text-property name="text">Всего</text-property>
                        </label>
                    </cell>
                    <cell id="17759">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="17727">
                            <text-property name="text">Заполнены материалы</text-property>
                        </label>
                    </cell>
                    <cell id="17780">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="17779">
                            <text-property name="text">% рабочих заданий с незаполненными материалами</text-property>
                        </label>
                    </cell>
                </row>
                <row id="17760">
                    <cell id="17761">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="17767">
                            <text-property name="text">0</text-property>
                        </label>
                    </cell>
                    <cell id="17762">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="17768">
                            <text-property name="text">1</text-property>
                        </label>
                    </cell>
                    <cell id="17763">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="17769">
                            <text-property name="text">2</text-property>
                        </label>
                    </cell>
                    <cell id="17764">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="17770">
                            <text-property name="text">3</text-property>
                        </label>
                    </cell>
                    <cell id="17765">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="17771">
                            <text-property name="text">4</text-property>
                        </label>
                    </cell>
                    <cell id="17774">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="17778">
                            <text-property name="text">5</text-property>
                        </label>
                    </cell>
                </row>
            </header>
            <detail>
                <row id="17728">
                    <cell id="17729">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="17730">
                            <property name="resultSetColumn">L_PODR</property>
                        </data>
                    </cell>
                    <cell id="17731">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="17732">
                            <list-property name="visibility">
                                <structure>
                                    <property name="format">all</property>
                                    <expression name="valueExpr">row["ALL_TK"] &lt; 0 || row["YESNO"]== row["ALL_TK"]</expression>
                                </structure>
                            </list-property>
                            <property name="resultSetColumn">L_PODR_D</property>
                            <structure name="action">
                                <property name="linkType">drill-through</property>
                                <property name="reportName">material_control_brig.rptdesign</property>
                                <property name="targetWindow">_blank</property>
                                <property name="targetFileType">report-design</property>
                                <list-property name="paramBindings">
                                    <structure>
                                        <property name="paramName">where</property>
                                        <expression name="expression">"1=1"</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">appname</property>
                                        <expression name="expression">"WOTRACK"</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">date1</property>
                                        <expression name="expression">params["date1"].value</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">date2</property>
                                        <expression name="expression">params["date2"].value</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">mroSite</property>
                                        <expression name="expression">params["mroSite"].value</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">podr</property>
                                        <expression name="expression">row["L_PODR"]</expression>
                                    </structure>
                                </list-property>
                            </structure>
                        </data>
                        <data id="17793">
                            <list-property name="visibility">
                                <structure>
                                    <property name="format">all</property>
                                    <expression name="valueExpr">row["ALL_TK"] > 0 &amp;&amp; row["YESNO"]&lt;row["ALL_TK"]</expression>
                                </structure>
                            </list-property>
                            <property name="resultSetColumn">L_PODR_D</property>
                            <structure name="action">
                                <property name="linkType">none</property>
                            </structure>
                        </data>
                    </cell>
                    <cell id="17735">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="17736">
                            <property name="textAlign">right</property>
                            <property name="resultSetColumn">ALL_WO</property>
                        </data>
                    </cell>
                    <cell id="17737">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="17738">
                            <property name="textAlign">right</property>
                            <property name="resultSetColumn">ALL_TK</property>
                        </data>
                    </cell>
                    <cell id="17739">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="17740">
                            <property name="textAlign">right</property>
                            <property name="resultSetColumn">YESNO</property>
                        </data>
                    </cell>
                    <cell id="17775">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="17782">
                            <structure name="numberFormat">
                                <property name="category">Percent</property>
                                <property name="pattern">Percent</property>
                            </structure>
                            <property name="textAlign">right</property>
                            <property name="resultSetColumn">mat_no</property>
                        </data>
                    </cell>
                </row>
            </detail>
            <footer>
                <row id="17741">
                    <cell id="17742">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                    </cell>
                    <cell id="17743">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <label id="17783">
                            <property name="fontWeight">bold</property>
                            <property name="textAlign">right</property>
                            <text-property name="text">Итого</text-property>
                        </label>
                    </cell>
                    <cell id="17745">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="17784">
                            <structure name="numberFormat">
                                <property name="category">Custom</property>
                                <property name="pattern">###,##0</property>
                            </structure>
                            <property name="textAlign">right</property>
                            <property name="resultSetColumn">sum_wo</property>
                        </data>
                    </cell>
                    <cell id="17746">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="17785">
                            <structure name="numberFormat">
                                <property name="category">Custom</property>
                                <property name="pattern">###,##0</property>
                            </structure>
                            <property name="textAlign">right</property>
                            <property name="resultSetColumn">sum_tk</property>
                        </data>
                    </cell>
                    <cell id="17747">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="17786">
                            <structure name="numberFormat">
                                <property name="category">Custom</property>
                                <property name="pattern">###,##0</property>
                            </structure>
                            <property name="textAlign">right</property>
                            <property name="resultSetColumn">sum_yesno</property>
                        </data>
                    </cell>
                    <cell id="17776">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="17787">
                            <structure name="numberFormat">
                                <property name="category">Percent</property>
                                <property name="pattern">Percent</property>
                            </structure>
                            <property name="textAlign">right</property>
                            <property name="resultSetColumn">t_mat_no</property>
                        </data>
                    </cell>
                </row>
            </footer>
        </table>
    </body>
</report>
