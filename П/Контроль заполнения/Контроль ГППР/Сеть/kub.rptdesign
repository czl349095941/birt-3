<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.17" id="1">
    <property name="createdBy">Eclipse BIRT Designer Version 2.3.2.r232_20090202 Build &lt;2.3.2.v20090218-0730></property>
    <property name="units">in</property>
    <property name="comments">IBM Confidential

OCO Source Materials

5724-M19

(C) COPYRIGHT IBM CORP. 2006

The source code for this program is not published or otherwise
divested of its trade secrets, irrespective of what has been
deposited with the U.S. Copyright Office.</property>
    <html-property name="description">This template will create a report with one or more groups, each having identical data fields, and contains three styles of charts.</html-property>
    <list-property name="userProperties">
        <structure>
            <property name="name">Data Cube.1.x</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.1.y</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.1.width</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.1.height</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set1.x</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set1.y</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set1.width</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set1.height</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.webservice.x</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.webservice.y</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.webservice.width</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.webservice.height</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set5.x</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set5.y</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set5.width</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set5.height</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
    </list-property>
    <property name="Data Cube.1.x">135</property>
    <property name="Data Cube.1.y">59</property>
    <property name="Data Cube.1.width">150</property>
    <property name="Data Cube.1.height">200</property>
    <property name="Data Cube.Data Set1.x">106</property>
    <property name="Data Cube.Data Set1.y">37</property>
    <property name="Data Cube.Data Set1.width">150</property>
    <property name="Data Cube.Data Set1.height">200</property>
    <property name="Data Cube.webservice.x">85</property>
    <property name="Data Cube.webservice.y">72</property>
    <property name="Data Cube.webservice.width">150</property>
    <property name="Data Cube.webservice.height">200</property>
    <property name="Data Cube.Data Set5.x">123</property>
    <property name="Data Cube.Data Set5.y">103</property>
    <property name="Data Cube.Data Set5.width">150</property>
    <property name="Data Cube.Data Set5.height">200</property>
    <list-property name="propertyBindings">
        <structure>
            <property name="name">odaURL</property>
            <property name="id">9434</property>
            <expression name="value">var siteid = "";
siteid = (params["mroSite"]);
if (siteid == "10") 
{ "jdbc:inetdae7a:10.10.1.120:1433" }
else if (siteid == "17") 
{ "jdbc:inetdae7a:10.23.250.56:1433" }
else if (siteid == "24") 
{ "jdbc:inetdae7a:10.24.223.234:1433" }
else if (siteid == "28") 
{ "jdbc:inetdae7a:10.43.195.99:1433" }
else if (siteid == "51") 
{ "jdbc:inetdae7a:10.51.5.67:1433" }
else if (siteid == "58") 
{ "jdbc:inetdae7a:10.58.1.198:1433" }
else if (siteid == "63") 
{ "jdbc:inetdae7a:10.64.24.179:1433" }
else if (siteid == "76") 
{ "jdbc:inetdae7a:10.76.0.129:1433" }
else if (siteid == "80") 
{ "jdbc:inetdae7a:10.81.28.126:1433" }
else if (siteid == "83") 
{ "jdbc:inetdae7a:10.132.71.29:1433" }
else if (siteid == "88") 
{ "jdbc:inetdae7a:10.89.250.175:1433" }
else if (siteid == "92") 
{ "jdbc:inetdae7a:10.111.24.226:1433" }
else if (siteid == "94") 
{ "jdbc:inetdae7a:10.123.169.124:1433" }
else if (siteid == "96") 
{ "jdbc:inetdae7a:10.99.253.180:1433" }
else { " - " }</expression>
        </structure>
        <structure>
            <property name="name">odaUser</property>
            <property name="id">9434</property>
            <expression name="value">var siteid = "";
siteid = (params["mroSite"]);
if (siteid == "10") 
{ "asui" }
else if (siteid == "17") 
{ "ocrv" }
else if (siteid == "24") 
{ "trset" }
else if (siteid == "28") 
{ "asui" }
else if (siteid == "51") 
{ "ASUEOCSKZD" }
else if (siteid == "58") 
{ "ASUE_OCRV" }
else if (siteid == "63") 
{ "ekasui" }
else if (siteid == "76") 
{ "asui" }
else if (siteid == "80") 
{ "chel" }
else if (siteid == "83") 
{ "asui" }
else if (siteid == "88") 
{ "asui" }
else if (siteid == "92") 
{ "asui" }
else if (siteid == "94") 
{ "asui" }
else if (siteid == "96") 
{ "asui" }
else { " - " }</expression>
        </structure>
        <structure>
            <property name="name">odaPassword</property>
            <property name="id">9434</property>
            <expression name="value">var siteid = "";
siteid = (params["mroSite"]);
if (siteid == "10") 
{ "asui" }
else if (siteid == "17") 
{ "ocrvuser" }
else if (siteid == "24") 
{ "tr_set" }
else if (siteid == "28") 
{ "asui" }
else if (siteid == "51") 
{ "As16Eo98Z45" }
else if (siteid == "58") 
{ "D2_12345678" }
else if (siteid == "63") 
{ "ekasui" }
else if (siteid == "76") 
{ "asui" }
else if (siteid == "80") 
{ "chelchel" }
else if (siteid == "83") 
{ "asui" }
else if (siteid == "88") 
{ "asui" }
else if (siteid == "92") 
{ "asui" }
else if (siteid == "94") 
{ "ZrwElectro-75" }
else if (siteid == "96") 
{ "asui96" }
else { " - " }</expression>
        </structure>
    </list-property>
    <method name="initialize"><![CDATA[importPackage(Packages.com.ibm.tivoli.maximo.report.script);

mxReportScriptContext = MXReportScriptContext.initialize(reportContext);
mxReportScriptContext.setDefaultLogLevel("DEBUG");
mxReportScriptContext.setDefaultLogFile("c:/temp/tetttt.txt");

]]></method>
    <method name="afterFactory"><![CDATA[MXReportScriptContext.close();]]></method>
    <property name="theme">MaximoSystemLibrary.maximoTheme</property>
    <text-property name="displayName">Tivoli Maximo Grouped Chart Template</text-property>
    <property name="bidiLayoutOrientation">ltr</property>
    <list-property name="libraries">
        <structure>
            <property name="fileName">MaximoSystemLibrary.rptlibrary</property>
            <property name="namespace">MaximoSystemLibrary</property>
        </structure>
    </list-property>
    <parameters>
        <scalar-parameter name="where" id="25">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <property name="defaultValue">1=1</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="appname" id="240">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="paramdelimiter" id="241">
            <property name="hidden">true</property>
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="paramstring" id="242">
            <property name="hidden">true</property>
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="mroSite" id="10179">
            <property name="valueType">static</property>
            <property name="dataType">integer</property>
            <property name="paramType">simple</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <script-data-source name="maximoDataSource" id="64" extends="MaximoSystemLibrary.maximoDataSource"/>
        <oda-data-source extensionID="org.eclipse.birt.report.data.oda.jdbc" name="Data Source" id="9434">
            <property name="odaDriverClass">com.inet.tds.TdsDriver</property>
            <property name="odaURL">jdbc:inetdae7a:10.32.1.223:1433</property>
            <property name="odaUser">asui</property>
            <encrypted-property name="odaPassword" encryptionID="base64">YXN1aQ==</encrypted-property>
            <property name="odaJndiName">com.inet.tds.TdsDriver</property>
        </oda-data-source>
    </data-sources>
    <data-sets>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="Data Set2" id="9435">
            <list-property name="computedColumns">
                <structure>
                    <property name="name">JOI</property>
                    <expression name="expression">row["ECH"]+row["ITEMNUM"]</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">ECH</property>
                    <property name="displayName">ECH</property>
                </structure>
                <structure>
                    <property name="columnName">ITEMNUM</property>
                    <property name="displayName">ITEMNUM</property>
                </structure>
                <structure>
                    <property name="columnName">COUNT</property>
                    <property name="displayName">COUNT</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">ECH</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">COUNT</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">JOI</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data Source</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">ECH</property>
                    <property name="nativeName">ECH</property>
                    <property name="dataType">integer</property>
                    <property name="nativeDataType">4</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">ITEMNUM</property>
                    <property name="nativeName">ITEMNUM</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">COUNT</property>
                    <property name="nativeName">COUNT</property>
                    <property name="dataType">integer</property>
                    <property name="nativeDataType">4</property>
                </structure>
            </list-property>
            <property name="queryText">--Вывод Дополнительный провод(Additional_Wires)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
From (
SELECT e.id_rec AS ECH, 'ДОП_ПРОВ' AS ITEMNUM, a.id_rec AS COUNT
FROM Additional_Wires A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
Where nullif(b.id_drivings,0) is not null
Union
SELECT e.id_rec AS ECH, 'ДОП_ПРОВ' AS ITEMNUM,a.id_rec AS COUNT
FROM Additional_Wires A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
WHERE nullif(b.id_station,0) IS NOT NULL AND nullif(b.id_drivings,0) IS NULL
) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Воздушных стрелок (Air_Arrows)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT d.id_rec AS ECH, 'ВОЗДУШ_СТРЕЛКИ' AS ITEMNUM,a.id_rec AS COUNT
FROM Air_Arrows A
Left JOIN Drivings_ECHK b ON a.id_drivings = b.id_rec 
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
Where nullif(a.id_drivings,0) is not null
Union
SELECT d.id_rec AS ECH, 'ВОЗДУШ_СТРЕЛКИ' AS ITEMNUM,a.id_rec AS COUNT
FROM Air_Arrows A 
Left JOIN Station_ECHK b ON a.id_station = b.id_rec
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
WHERE nullif(A.id_station,0) IS NOT NULL AND nullif(A.id_drivings,0) IS NULL
) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Пересечения (Air_intersections)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  d.id_rec AS ECH, 'ПЕРЕСЕЧЕНИЯ' AS ITEMNUM,a.id_rec AS COUNT
FROM Air_intersections A
Left JOIN Drivings_ECHK b ON a.id_drivings = b.id_rec 
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
Where nullif(a.id_drivings,0) is not null
Union
SELECT  d.id_rec AS ECH, 'ПЕРЕСЕЧЕНИЯ' AS ITEMNUM,a.id_rec AS COUNT
FROM Air_intersections A 
Left JOIN Station_ECHK b ON a.id_station = b.id_rec
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
WHERE nullif(A.id_station,0) IS NOT NULL AND nullif(A.id_drivings,0) IS NULL
) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL

--Вывод ВЛ(Air_Lines)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  c.id_rec AS ECH, 'ВОЗД_ЛИНИИ' AS ITEMNUM,a.id_rec AS COUNT
FROM Air_Lines A 
Left JOIN ECHK b ON b.id_rec = a.id_ECHK
Left JOIN ECH c ON c.id_rec = b.id_parent
WHERE A.ID_ECHK IS NOT NULL
and (nullif(a.location_station1,0) is not null
or nullif(a.location_station2,0) is not null)

union
SELECT c.id_rec AS ECH, 'ВОЗД_ЛИНИИ' AS ITEMNUM,a.id_rec AS COUNT
FROM Air_Lines A 
Left JOIN ECHS b ON b.id_rec = a.id_ECHS
Left JOIN ECH c ON c.id_rec = b.id_parent
WHERE A.ID_ECHS IS NOT NULL
and (nullif(a.location_station1,0) is not null
OR NULLIF(A.LOCATION_STATION2,0) IS NOT NULL)

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Выключатель постоянного тока (Breaker_Const)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  d.id_rec AS ECH, 'ВЫКЛ_ПОСТ_ТОКА' AS ITEMNUM,a.id_rec AS COUNT
from Breaker_Const a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
LEFT JOIN ECH d ON d.id_rec = c.id_parent
WHERE A.id_device IS NOT NULL 
UNION
--object
SELECT  c.id_rec AS ECH, 'ВЫКЛ_ПОСТ_ТОКА' AS ITEMNUM,a.id_rec AS COUNT
from Breaker_Const a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
WHERE A.id_object IS NOT NULL
) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Выключатель переменного тока(Breaker_Variable)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  d.id_rec AS ECH, 'ВЫКЛ_ПЕР_ТОКА' AS ITEMNUM,a.id_rec AS COUNT
from Breaker_Variable a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_device is not null
UNION
--Device2
SELECT f.id_rec AS ECH, 'ВЫКЛ_ПЕР_ТОКА' AS ITEMNUM,a.id_rec AS COUNT
from Breaker_Variable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echs,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_eche,0) is null
UNION
SELECT f.id_rec AS ECH,'ВЫКЛ_ПЕР_ТОКА' AS ITEMNUM,a.id_rec AS COUNT
from Breaker_Variable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echk,0) is not null and nullif(d.id_echs,0) is null and nullif(d.id_eche,0) is null
Union
SELECT  f.id_rec AS ECH,'ВЫКЛ_ПЕР_ТОКА' AS ITEMNUM,a.id_rec AS COUNT
from Breaker_Variable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_eche,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_echs,0) is null
UNION
--object
SELECT  c.id_rec AS ECH, 'ВЫКЛ_ПЕР_ТОКА' AS ITEMNUM,a.id_rec AS COUNT
from Breaker_Variable a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
WHERE A.id_object IS NOT NULL
) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Контрольный кабель(Cable и Cable2)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (

SELECT d.id_rec AS ECH,'КОНТР_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
from Cable a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_device is not null and a.purpose =3
UNION
--Device2
SELECT f.id_rec AS ECH,'КОНТР_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echs,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_eche,0) is null and a.purpose =3
and ((c.location_station1 is not null and c.location_station2 is not null)
OR (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL AND NULLIF(C.LOCATION_STATION2,0) IS NOT NULL))
UNION
SELECT f.id_rec AS ECH,'КОНТР_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echk,0) is not null and nullif(d.id_echs,0) is null and nullif(d.id_eche,0) is null and a.purpose =3
and ((c.location_station1 is not null and c.location_station2 is not null)
OR (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL AND NULLIF(C.LOCATION_STATION2,0) IS NOT NULL))

Union
SELECT f.id_rec AS ECH,'КОНТР_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_eche,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_echs,0) is null and a.purpose =3
UNION
--object
SELECT  c.id_rec AS ECH, 'КОНТР_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
from Cable a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
WHERE A.id_object IS NOT NULL and a.purpose =3 
--Cable2
UNION
SELECT  d.id_rec AS ECH,'КОНТР_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cable2 A 
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where b.id_echk is not null and a.purpose =3
    and (nullif(b.name_station1,0) is not null 
    OR NULLIF(B.NAME_STATION2,0) IS NOT NULL)

union
SELECT  d.id_rec AS ECH,'КОНТР_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cable2 A 
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where b.id_echs is not null and a.purpose =3
    and (nullif(b.name_station1,0) is not null 
    OR NULLIF(B.NAME_STATION2,0) IS NOT NULL)

UNION
SELECT f.id_rec AS ECH,'КОНТР_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cable2 A
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_drivings,0) is not null and a.purpose =3
Union
SELECT f.id_rec AS ECH,'КОНТР_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cable2 A
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_station,0) is not null and nullif(c.id_drivings,0) is null and a.purpose =3
) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Силовой кабель(Cable и Cable2)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT d.id_rec AS ECH,'СИЛ_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
from Cable a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_device is not null and a.purpose =2
UNION
--Device2
SELECT f.id_rec AS ECH,'СИЛ_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echs,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_eche,0) is null and a.purpose =2
and ((c.location_station1 is not null and c.location_station2 is not null)
or (nullif(c.location_station1,0) is not null and nullif(c.location_station2,0) is not null))
UNION
SELECT f.id_rec AS ECH,'СИЛ_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echk,0) is not null and nullif(d.id_echs,0) is null and nullif(d.id_eche,0) is null and a.purpose =2
and ((c.location_station1 is not null and c.location_station2 is not null)
or (nullif(c.location_station1,0) is not null and nullif(c.location_station2,0) is not null))
Union
SELECT f.id_rec AS ECH,'СИЛ_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_eche,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_echs,0) is null and a.purpose =2
and ((c.location_station1 is not null and c.location_station2 is not null)
or (nullif(c.location_station1,0) is not null and nullif(c.location_station2,0) is not null))
UNION
--object
SELECT  c.id_rec AS ECH, 'СИЛ_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
from Cable a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
WHERE A.id_object IS NOT NULL and a.purpose =2
--Cable2
UNION
SELECT  d.id_rec AS ECH,'СИЛ_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cable2 A 
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where b.id_echk is not null and a.purpose =2
and (nullif(b.name_station1,0) is not null 
OR NULLIF(B.NAME_STATION2,0) IS NOT NULL)

union
SELECT  d.id_rec AS ECH,'СИЛ_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cable2 A 
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where b.id_echs is not null and a.purpose =2
and (nullif(b.name_station1,0) is not null 
OR NULLIF(B.NAME_STATION2,0) IS NOT NULL)

UNION
SELECT f.id_rec AS ECH,'СИЛ_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cable2 A
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_drivings,0) is not null and a.purpose =2
and (nullif(b.name_station1,0) is not null 
OR NULLIF(B.NAME_STATION2,0) IS NOT NULL)

Union
SELECT f.id_rec AS ECH,'СИЛ_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cable2 A
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_station,0) is not null and nullif(c.id_drivings,0) is null and a.purpose =2
and (nullif(b.name_station1,0) is not null 
OR NULLIF(B.NAME_STATION2,0) IS NOT NULL)

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Высоковольтный кабель(Cable и Cable2)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT d.id_rec AS ECH,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
from Cable a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_device is not null and a.purpose =1
UNION
--Device2
SELECT f.id_rec AS ECH,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echs,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_eche,0) is null and a.purpose =1
and ((c.location_station1 is not null and c.location_station2 is not null)
OR (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL AND NULLIF(C.LOCATION_STATION2,0) IS NOT NULL))

UNION
SELECT f.id_rec AS ECH,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
WHERE A.ID_DEVICE2 IS NOT NULL AND NULLIF(D.ID_ECHK,0) IS NOT NULL AND NULLIF(D.ID_ECHS,0) IS NULL AND NULLIF(D.ID_ECHE,0) IS NULL AND A.PURPOSE =1
and ((c.location_station1 is not null and c.location_station2 is not null)
OR (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL AND NULLIF(C.LOCATION_STATION2,0) IS NOT NULL))

Union
SELECT f.id_rec AS ECH,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_eche,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_echs,0) is null and a.purpose =1
UNION
--object
SELECT  c.id_rec AS ECH, 'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
from Cable a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
WHERE A.id_object IS NOT NULL and a.purpose =1
--Cable2
UNION
SELECT  d.id_rec AS ECH,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cable2 A 
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where b.id_echk is not null and a.purpose =1
    and (nullif(b.name_station1,0) is not null 
    OR NULLIF(B.NAME_STATION2,0) IS NOT NULL)

union
SELECT  d.id_rec AS ECH,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cable2 A 
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where b.id_echs is not null and a.purpose =1
    and (nullif(b.name_station1,0) is not null 
    OR NULLIF(B.NAME_STATION2,0) IS NOT NULL)

UNION
SELECT f.id_rec AS ECH,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cable2 A
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_drivings,0) is not null and a.purpose =1
Union
SELECT f.id_rec AS ECH,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cable2 A
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_station,0) is not null and nullif(c.id_drivings,0) is null and a.purpose =1
) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Кабельные вставки(Cable_Insertions)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  d.id_rec AS ECH,'КАБ_ВСТАВ' AS ITEMNUM,a.id_rec AS COUNT
FROM CABLE_INSERTIONS A
INNER JOIN AIR_LINES B ON B.ID_REC=A.ID_AIRLINE
      and (nullif(b.location_station1,0) is not null
      or nullif(b.location_station2,0) is not null)
      AND B.ID_ECHK IS NOT NULL
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
WHERE A.id_airline IS NOT NULL 
union
SELECT  d.id_rec AS ECH,'КАБ_ВСТАВ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cable_Insertions A
inner JOIN Air_Lines b ON b.id_rec=a.id_airline 
      and (nullif(b.location_station1,0) is not null
      or nullif(b.location_station2,0) is not null)
      AND b.ID_ECHS IS NOT NULL
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
WHERE A.id_airline IS NOT NULL 
) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Кабельные линии(Cable_Lines)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  c.id_rec AS ECH, 'КАБ_ЛИНИИ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cable_Lines A 
Left JOIN ECHK b ON b.id_rec = a.id_ECHK
Left JOIN ECH c ON c.id_rec = b.id_parent
WHERE A.id_echk IS NOT NULL
    and (nullif(name_station1,0) is not null 
    OR NULLIF(NAME_STATION2,0) IS NOT NULL)

union
SELECT c.id_rec AS ECH, 'КАБ_ЛИНИИ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cable_Lines A 
Left JOIN ECHS b ON b.id_rec = a.id_ECHS
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.id_echs is not null
    and (nullif(name_station1,0) is not null 
    OR NULLIF(NAME_STATION2,0) IS NOT NULL)

UNION
SELECT  e.id_rec AS ECH, 'КАБ_ЛИНИИ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cable_Lines A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
Where nullif(b.id_drivings,0) is not null and a.id_ECHK IS NULL and a.id_ECHK IS NULL
Union
SELECT  e.id_rec AS ECH, 'КАБ_ЛИНИИ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cable_Lines A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
WHERE nullif(b.id_station,0) IS NOT NULL AND nullif(b.id_drivings,0) IS NULL AND A.id_ECHK IS NULL AND A.id_ECHK IS NULL

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Кабельные муфты(Cables_Muffs)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  d.id_rec AS ECH,'КАБ_МУФ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cables_Muffs A
Left JOIN Air_Lines b ON b.id_rec=a.id_airline
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_airline is not null and id_ECHK is not null
union
SELECT  d.id_rec AS ECH,'КАБ_МУФ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cables_Muffs A
Left JOIN Air_Lines b ON b.id_rec=a.id_airline
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_airline is not null and id_ECHS is not null 
UNION
SELECT  e.id_rec AS ECH, 'КАБ_МУФ' AS ITEMNUM,a.id_rec AS COUNT
from Cables_Muffs a
Left JOIN Cable b ON b.id_rec = a.id_cable
Left JOIN Distributing_Devices c ON c.id_rec = b.id_device
Left JOIN ECHE d ON c.id_parent = d.id_rec
Left JOIN ECH e ON e.id_rec = d.id_parent
where b.id_device is not null and a.id_cable is not null
UNION
--Device2
SELECT  g.id_rec AS ECH, 'КАБ_МУФ' AS ITEMNUM,a.id_rec AS COUNT
from Cables_Muffs a
Left JOIN Cable b ON b.id_rec = a.id_cable
Left JOIN Distributing_Devices2 c ON c.id_rec = b.id_device2
Left JOIN Gen_Inf_TP d ON c.id_parent = d.id_echs
Left JOIN TP_Echs e ON d.id_echs = e.id_rec
Left JOIN Echs f ON f.id_rec = e.id_echs
Left JOIN ECH g ON g.id_rec = f.id_parent
where b.id_device2 is not null and nullif(e.id_echs,0) is not null and nullif(e.id_echk,0) is null and nullif(e.id_eche,0) is null and a.id_cable is not null
UNION
SELECT  g.id_rec AS ECH, 'КАБ_МУФ' AS ITEMNUM,a.id_rec AS COUNT
from Cables_Muffs a
Left JOIN Cable b ON b.id_rec = a.id_cable
Left JOIN Distributing_Devices2 c ON c.id_rec = b.id_device2
Left JOIN Gen_Inf_TP d ON c.id_parent = d.id_echs
Left JOIN TP_Echs e ON d.id_echs = e.id_rec
Left JOIN ECHK f ON f.id_rec = e.id_ECHK
Left JOIN ECH g ON g.id_rec = f.id_parent
where b.id_device2 is not null and nullif(e.id_echk,0) is not null and nullif(e.id_echs,0) is null and nullif(e.id_eche,0) is null and a.id_cable is not null
Union
SELECT  g.id_rec AS ECH, 'КАБ_МУФ' AS ITEMNUM,a.id_rec AS COUNT
from Cables_Muffs a
Left JOIN Cable b ON b.id_rec = a.id_cable
Left JOIN Distributing_Devices2 c ON c.id_rec = b.id_device2
Left JOIN Gen_Inf_TP d ON c.id_parent = d.id_echs
Left JOIN TP_Echs e ON d.id_echs = e.id_rec
Left JOIN EchE f ON f.id_rec = e.id_echE
Left JOIN ECH g ON g.id_rec = f.id_parent
where b.id_device2 is not null and nullif(e.id_eche,0) is not null and nullif(e.id_echk,0) is null and nullif(e.id_echs,0) is null and a.id_cable is not null
UNION
--object
SELECT  d.id_rec AS ECH,'КАБ_МУФ' AS ITEMNUM,a.id_rec AS COUNT
from Cables_Muffs a
Left JOIN Cable b ON b.id_rec = a.id_cable
Left JOIN Line_Objects c ON c.id_rec = b.id_object
Left JOIN ECH d ON d.id_rec = c.id_parent
LEFT JOIN ECHE e ON d.id_rec = c.belong_ECHE
where b.id_object is not null and a.id_cable2 is not null
--Cable2
UNION
SELECT  e.id_rec AS ECH, 'КАБ_МУФ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cables_Muffs A 
Left JOIN Cable2 b ON b.id_rec = a.id_cable2
Left JOIN Cable_Lines c ON c.id_rec = b.id_cableline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where c.id_echk is not null and a.id_cable2 is not null
union
SELECT  e.id_rec AS ECH, 'КАБ_МУФ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cables_Muffs A 
Left JOIN Cable2 b ON b.id_rec = a.id_cable2
Left JOIN Cable_Lines c ON c.id_rec = b.id_cableline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where c.id_echs is not null and a.id_cable2 is not null
UNION
SELECT  g.id_rec AS ECH, 'КАБ_МУФ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cables_Muffs A
Left JOIN Cable2 b ON b.id_rec = a.id_cable2
Left JOIN Cable_Lines c ON c.id_rec = b.id_cableline
Left JOIN Ways d ON c.id_way = d.id_rec 
Left JOIN Drivings_ECHK e ON d.id_drivings = e.id_rec 
Left JOIN ECHK f ON f.id_rec = e.id_ECHK
Left JOIN ECH g ON g.id_rec = f.id_parent
Where nullif(d.id_drivings,0) is not null and a.id_cable2 is not null

Union
SELECT  g.id_rec AS ECH, 'КАБ_МУФ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cables_Muffs A
Left JOIN Cable2 b ON b.id_rec = a.id_cable2
Left JOIN Cable_Lines c ON c.id_rec = b.id_cableline
Left JOIN Ways d ON c.id_way = d.id_rec 
Left JOIN Station_ECHK e ON d.id_station = e.id_rec
Left JOIN ECHK f ON f.id_rec = e.id_ECHK
Left JOIN ECH g ON g.id_rec = f.id_parent
Where nullif(d.id_station,0) is not null and nullif(d.id_drivings,0) is null and a.id_cable2 is not null
 
UNION
--Add_ware 
SELECT f.id_rec AS ECH,'КАБ_МУФ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cables_Muffs A
Left JOIN Additional_Wires b ON a.id_add = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_drivings,0) is not null and a.id_add is not null

Union
SELECT f.id_rec AS ECH,'КАБ_МУФ' AS ITEMNUM,a.id_rec AS COUNT
FROM Cables_Muffs A
Left JOIN Additional_Wires b ON a.id_add = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_station,0) is not null and nullif(c.id_drivings,0) is null and a.id_add is not null

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Компенсирующее устройство (Compensating_Devices)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT d.id_rec AS ECH,'КОМП_УСТР' AS ITEMNUM,a.id_rec AS COUNT
from Compensating_Devices a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_device is not null

UNION
--object
SELECT  c.id_rec AS ECH, 'КОМП_УСТР' AS ITEMNUM,a.id_rec AS COUNT
from Compensating_Devices a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
WHERE A.id_object IS NOT NULL

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Консоли(Console)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT f.id_rec AS ECH,'КОНСОЛЬ' AS ITEMNUM,a.id_rec AS COUNT
FROM Console A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_drivings,0) is not null

Union
SELECT f.id_rec AS ECH,'КОНСОЛЬ' AS ITEMNUM,a.id_rec AS COUNT
FROM Console A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_station,0) is not null and nullif(c.id_drivings,0) is null

UNION
SELECT  e.id_rec AS ECH, 'КОНСОЛЬ' AS ITEMNUM,a.id_rec AS COUNT
FROM Console A
Left JOIN Hard_crossbeams b ON a.zhp = b.id_rec
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
Where nullif(b.id_drivings,0) is not null

Union
SELECT  e.id_rec AS ECH, 'КОНСОЛЬ' AS ITEMNUM,a.id_rec AS COUNT
FROM Console A
Left JOIN Hard_crossbeams b ON a.zhp = b.id_rec
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
WHERE nullif(b.id_station,0) IS NOT NULL AND nullif(b.id_drivings,0) IS NULL

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Счетчик электроэнергии(Counters)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT d.id_rec AS ECH,'СЧЕТ_Э' AS ITEMNUM,a.id_rec AS COUNT
from Counters a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_device is not null

UNION
--Device2
SELECT f.id_rec AS ECH,'СЧЕТ_Э' AS ITEMNUM,a.id_rec AS COUNT
from Counters a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echs,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_eche,0) is null

UNION
SELECT f.id_rec AS ECH,'СЧЕТ_Э' AS ITEMNUM,a.id_rec AS COUNT
from Counters a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echk,0) is not null and nullif(d.id_echs,0) is null and nullif(d.id_eche,0) is null

Union
SELECT f.id_rec AS ECH,'СЧЕТ_Э' AS ITEMNUM,a.id_rec AS COUNT
from Counters a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_eche,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_echs,0) is null

UNION
--object
SELECT  c.id_rec AS ECH, 'СЧЕТ_Э' AS ITEMNUM,a.id_rec AS COUNT
from Counters a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
WHERE A.id_object IS NOT NULL

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Токопровод (Current_Wire)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT d.id_rec AS ECH,'ТОКОПРОВОД' AS ITEMNUM,a.id_rec AS COUNT
from Current_Wire a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_device is not null

UNION
--Device2
SELECT f.id_rec AS ECH,'ТОКОПРОВОД' AS ITEMNUM,a.id_rec AS COUNT
from Current_Wire a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
WHERE A.ID_DEVICE2 IS NOT NULL AND NULLIF(D.ID_ECHS,0) IS NOT NULL AND NULLIF(D.ID_ECHK,0) IS NULL AND NULLIF(D.ID_ECHE,0) IS NULL
and ((c.location_station1 is not null and c.location_station2 is not null)
or (nullif(c.location_station1,0) is not null and nullif(c.location_station2,0) is not null))


UNION
SELECT f.id_rec AS ECH,'ТОКОПРОВОД' AS ITEMNUM,a.id_rec AS COUNT
from Current_Wire a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echk,0) is not null and nullif(d.id_echs,0) is null and nullif(d.id_eche,0) is null
and ((c.location_station1 is not null and c.location_station2 is not null)
OR (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL AND NULLIF(C.LOCATION_STATION2,0) IS NOT NULL))


Union
SELECT f.id_rec AS ECH,'ТОКОПРОВОД' AS ITEMNUM,a.id_rec AS COUNT
from Current_Wire a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_eche,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_echs,0) is null

UNION
--object
SELECT c.id_rec AS ECH, 'ТОКОПРОВОД' AS ITEMNUM,a.id_rec AS COUNT
from Current_Wire a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
WHERE A.id_object IS NOT NULL

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Дизель-генер(Dies_Gen)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  c.id_rec AS ECH, 'ДИЗ_ГЕН' AS ITEMNUM,a.id_rec AS COUNT
FROM Dies_Gen A 
Left JOIN ECHE b ON b.id_rec = a.id_parent
Left JOIN ECH c ON c.id_rec = b.id_parent
WHERE A.id_parent IS NOT NULL 
 
UNION
SELECT f.id_rec AS ECH,'ДИЗ_ГЕН' AS ITEMNUM,a.id_rec AS COUNT
from Dies_Gen a
Left JOIN Gen_Inf_TP c ON a.id_tp_echs = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where nullif(d.id_echs,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_eche,0) is null

UNION
SELECT f.id_rec AS ECH,'ДИЗ_ГЕН' AS ITEMNUM,a.id_rec AS COUNT
from Dies_Gen a
Left JOIN Gen_Inf_TP c ON a.id_tp_echs = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where nullif(d.id_echk,0) is not null and nullif(d.id_echs,0) is null and nullif(d.id_eche,0) is null

Union
SELECT f.id_rec AS ECH,'ДИЗ_ГЕН' AS ITEMNUM,a.id_rec AS COUNT
from Dies_Gen a
Left JOIN Gen_Inf_TP c ON a.id_tp_echs = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where nullif(d.id_eche,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_echs,0) is null

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Разрядники(Dischargers)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  e.id_rec AS ECH, 'РАЗРЯДНИКИ' AS ITEMNUM,a.id_rec AS COUNT
FROM Dischargers A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where b.id_airline is not null  and c.id_ECHK is not null and a.id_tower_airline is not null

union
SELECT  e.id_rec AS ECH, 'РАЗРЯДНИКИ' AS ITEMNUM,a.id_rec AS COUNT
FROM Dischargers A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where b.id_airline is not null  and c.id_ECHS is not null and a.id_tower_airline is not null

UNION
SELECT f.id_rec AS ECH,'РАЗРЯДНИКИ' AS ITEMNUM,a.id_rec AS COUNT
FROM Dischargers A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_drivings,0) is not null

Union
SELECT f.id_rec AS ECH,'РАЗРЯДНИКИ' AS ITEMNUM,a.id_rec AS COUNT
FROM Dischargers A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_station,0) is not null and nullif(c.id_drivings,0) is null

UNION
SELECT d.id_rec AS ECH,'РАЗРЯДНИКИ' AS ITEMNUM,a.id_rec AS COUNT
from Dischargers a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_device is not null

UNION
--Device2
SELECT f.id_rec AS ECH,'РАЗРЯДНИКИ' AS ITEMNUM,a.id_rec AS COUNT
from Dischargers a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echs,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_eche,0) is null

UNION
SELECT f.id_rec AS ECH,'РАЗРЯДНИКИ' AS ITEMNUM,a.id_rec AS COUNT
from Dischargers a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echk,0) is not null and nullif(d.id_echs,0) is null and nullif(d.id_eche,0) is null

Union
SELECT f.id_rec AS ECH,'РАЗРЯДНИКИ' AS ITEMNUM,a.id_rec AS COUNT
from Dischargers a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_eche,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_echs,0) is null

UNION
--object
SELECT  c.id_rec AS ECH, 'РАЗРЯДНИКИ' AS ITEMNUM,a.id_rec AS COUNT
from Dischargers a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
WHERE A.id_object IS NOT NULL

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Разъединители(Disconnectors)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  e.id_rec AS ECH, 'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM,a.id_rec AS COUNT
FROM Disconnectors A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
WHERE B.ID_AIRLINE IS NOT NULL  AND C.ID_ECHK IS NOT NULL AND A.ID_TOWER_AIRLINE IS NOT NULL
and (nullif(c.location_station1,0) is not null
      or nullif(c.location_station2,0) is not null)

union
SELECT  e.id_rec AS ECH, 'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM,a.id_rec AS COUNT
FROM Disconnectors A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where b.id_airline is not null  and c.id_ECHS is not null and a.id_tower_airline is not null
and (nullif(c.location_station1,0) is not null
      OR NULLIF(C.LOCATION_STATION2,0) IS NOT NULL)

UNION
SELECT f.id_rec AS ECH,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM,a.id_rec AS COUNT
FROM Disconnectors A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_drivings,0) is not null

Union
SELECT f.id_rec AS ECH,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM,a.id_rec AS COUNT
FROM Disconnectors A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_station,0) is not null and nullif(c.id_drivings,0) is null

UNION
SELECT d.id_rec AS ECH,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM,a.id_rec AS COUNT
from Disconnectors a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_device is not null

UNION
--device2
SELECT f.id_rec AS ECH,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM,a.id_rec AS COUNT
from Disconnectors a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echs,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_eche,0) is null
and ((c.location_station1 is not null and c.location_station2 is not null)
OR (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL AND NULLIF(C.LOCATION_STATION2,0) IS NOT NULL))


UNION
SELECT f.id_rec AS ECH,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM,a.id_rec AS COUNT
from Disconnectors a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echk,0) is not null and nullif(d.id_echs,0) is null and nullif(d.id_eche,0) is null
and ((c.location_station1 is not null and c.location_station2 is not null)
OR (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL AND NULLIF(C.LOCATION_STATION2,0) IS NOT NULL))


Union
SELECT f.id_rec AS ECH,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM,a.id_rec AS COUNT
from Disconnectors a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_eche,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_echs,0) is null
and ((c.location_station1 is not null and c.location_station2 is not null)
OR (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL AND NULLIF(C.LOCATION_STATION2,0) IS NOT NULL))


UNION
--object
SELECT  c.id_rec AS ECH, 'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM,a.id_rec AS COUNT
from Disconnectors a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
WHERE A.id_object IS NOT NULL

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Приводы разъединителей(Drives2)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT f.id_rec AS ECH,'ПРИВ_РАЗЪЕД' AS ITEMNUM,a.id_rec AS COUNT
FROM Drives2 A
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Towers_Airlines c ON b.id_tower_airline = c.id_rec
Left JOIN Air_Lines d ON d.id_rec=c.id_airline
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where c.id_airline is not null  and d.id_ECHK is not null and b.id_tower_airline is not null and a.id_disconnector is not null

union
SELECT f.id_rec AS ECH,'ПРИВ_РАЗЪЕД' AS ITEMNUM,a.id_rec AS COUNT
FROM Drives2 A
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Towers_Airlines c ON b.id_tower_airline = c.id_rec
Left JOIN Air_Lines d ON d.id_rec=c.id_airline
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where c.id_airline is not null  and d.id_ECHS is not null and b.id_tower_airline is not null and a.id_disconnector is not null

UNION
SELECT  g.id_rec AS ECH, 'ПРИВ_РАЗЪЕД' AS ITEMNUM,a.id_rec AS COUNT
FROM Drives2 A
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Towers c ON c.id_rec = b.id_tower
Left JOIN Ways d ON c.id_way = d.id_rec 
Left JOIN Drivings_ECHK e ON d.id_drivings = e.id_rec 
Left JOIN ECHK f ON f.id_rec = e.id_ECHK
Left JOIN ECH g ON g.id_rec = f.id_parent
Where nullif(d.id_drivings,0) is not null and a.id_disconnector is not null
 
Union
SELECT  g.id_rec AS ECH, 'ПРИВ_РАЗЪЕД' AS ITEMNUM,a.id_rec AS COUNT
FROM Drives2 A
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Towers c ON c.id_rec = b.id_tower
Left JOIN Ways d ON c.id_way = d.id_rec 
Left JOIN Station_ECHK e ON d.id_station = e.id_rec
Left JOIN ECHK f ON f.id_rec = e.id_ECHK
Left JOIN ECH g ON g.id_rec = f.id_parent
Where nullif(d.id_station,0) is not null and nullif(d.id_drivings,0) is null and a.id_disconnector is not null

UNION
SELECT  e.id_rec AS ECH, 'ПРИВ_РАЗЪЕД' AS ITEMNUM,a.id_rec AS COUNT
from Drives2 a
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Distributing_Devices c ON c.id_rec = b.id_device
Left JOIN ECHE d ON c.id_parent = d.id_rec
Left JOIN ECH e ON e.id_rec = d.id_parent
where b.id_device is not null and a.id_disconnector is not null

UNION
--Device2
SELECT  g.id_rec AS ECH, 'ПРИВ_РАЗЪЕД' AS ITEMNUM,a.id_rec AS COUNT
from Drives2 a
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Distributing_Devices2 c ON c.id_rec = b.id_device2
Left JOIN Gen_Inf_TP d ON c.id_parent = d.id_echs
Left JOIN TP_Echs e ON d.id_echs = e.id_rec
Left JOIN Echs f ON f.id_rec = e.id_echs
Left JOIN ECH g ON g.id_rec = f.id_parent
where b.id_device2 is not null and nullif(e.id_echs,0) is not null and nullif(e.id_echk,0) is null and nullif(e.id_eche,0) is null and a.id_disconnector is not null
 
UNION
SELECT  g.id_rec AS ECH, 'ПРИВ_РАЗЪЕД' AS ITEMNUM,a.id_rec AS COUNT
from Drives2 a
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Distributing_Devices2 c ON c.id_rec = b.id_device2
Left JOIN Gen_Inf_TP d ON c.id_parent = d.id_echs
Left JOIN TP_Echs e ON d.id_echs = e.id_rec
Left JOIN ECHK f ON f.id_rec = e.id_ECHK
Left JOIN ECH g ON g.id_rec = f.id_parent
where b.id_device2 is not null and nullif(e.id_echk,0) is not null and nullif(e.id_echs,0) is null and nullif(e.id_eche,0) is null and a.id_disconnector is not null

Union
SELECT  g.id_rec AS ECH, 'ПРИВ_РАЗЪЕД' AS ITEMNUM,a.id_rec AS COUNT
from Drives2 a
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Distributing_Devices2 c ON c.id_rec = b.id_device2
Left JOIN Gen_Inf_TP d ON c.id_parent = d.id_echs
Left JOIN TP_Echs e ON d.id_echs = e.id_rec
Left JOIN EchE f ON f.id_rec = e.id_echE
Left JOIN ECH g ON g.id_rec = f.id_parent
where b.id_device2 is not null and nullif(e.id_eche,0) is not null and nullif(e.id_echk,0) is null and nullif(e.id_echs,0) is null and a.id_disconnector is not null

UNION
--object
SELECT  D.id_rec AS ECH,'ПРИВ_РАЗЪЕД' AS ITEMNUM,a.id_rec AS COUNT
from Drives2 a
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Line_Objects c ON c.id_rec = b.id_object
Left JOIN ECH d ON d.id_rec = c.id_parent
LEFT JOIN ECHE e ON e.id_rec = c.belong_ECHE
WHERE b.id_object IS NOT NULL AND A.id_disconnector IS NOT NULL

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Гибкая поперечина (Flexible_crossbeams)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  d.id_rec AS ECH,'ГИБК_ПОПЕРЕЧ' AS ITEMNUM,a.id_rec AS COUNT
FROM Flexible_crossbeams A
Left JOIN Drivings_ECHK b ON a.id_drivings = b.id_rec 
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
Where nullif(a.id_drivings,0) is not null

UNION
SELECT  d.id_rec AS ECH,'ГИБК_ПОПЕРЕЧ' AS ITEMNUM,a.id_rec AS COUNT
FROM Flexible_crossbeams A 
Left JOIN Station_ECHK b ON a.id_station = b.id_rec
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
WHERE nullif(A.id_station,0) IS NOT NULL AND nullif(A.id_drivings,0) IS NULL

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Трансформаторные подстанции (Gen_Inf_TP)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  d.id_rec AS ECH,'ТРАНСФ_ПОДСТ' AS ITEMNUM,a.id_rec AS COUNT
from Gen_Inf_TP a
Left JOIN TP_Echs b ON b.id_rec = a.id_echs
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
WHERE NULLIF(B.ID_ECHS,0) IS NOT NULL AND NULLIF(B.ID_ECHK,0) IS NULL AND NULLIF(B.ID_ECHE,0) IS NULL
      and (nullif(a.location_station1,0) is not null
      OR NULLIF(A.LOCATION_STATION2,0) IS NOT NULL)

union
SELECT  d.id_rec AS ECH,'ТРАНСФ_ПОДСТ' AS ITEMNUM,a.id_rec AS COUNT
from Gen_Inf_TP a
Left JOIN TP_Echs b ON b.id_rec = a.id_echs
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where nullif(b.id_echk,0) is not null and nullif(b.id_echs,0) is null and nullif(b.id_eche,0) is null
      and (nullif(a.location_station1,0) is not null
      OR NULLIF(A.LOCATION_STATION2,0) IS NOT NULL)

union
SELECT d.id_rec AS ECH,'ТРАНСФ_ПОДСТ' AS ITEMNUM,a.id_rec AS COUNT
from Gen_Inf_TP a
Left JOIN TP_Echs b ON b.id_rec = a.id_echs
Left JOIN ECHE c ON c.id_rec = b.id_eche
Left JOIN ECH d ON d.id_rec = c.id_parent
where nullif(b.id_eche,0) is not null and nullif(b.id_echk,0) is null and nullif(b.id_echs,0) is null
) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION
-- Вывод Заземляющее устройство (Ground_Devices)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT d.id_rec AS ECH,'ЗАЗЕМ_УСТР' AS ITEMNUM,a.id_rec AS COUNT
from Ground_Devices a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_device is not null

UNION
--Device2
SELECT f.id_rec AS ECH,'ЗАЗЕМ_УСТР' AS ITEMNUM,a.id_rec AS COUNT
from Ground_Devices a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echs,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_eche,0) is null
UNION
SELECT f.id_rec AS ECH,'ЗАЗЕМ_УСТР' AS ITEMNUM,a.id_rec AS COUNT
from Ground_Devices a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echk,0) is not null and nullif(d.id_echs,0) is null and nullif(d.id_eche,0) is null

Union
SELECT f.id_rec AS ECH,'ЗАЗЕМ_УСТР' AS ITEMNUM,a.id_rec AS COUNT
from Ground_Devices a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_eche,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_echs,0) is null

UNION
--object
SELECT  c.id_rec AS ECH, 'ЗАЗЕМ_УСТР' AS ITEMNUM,a.id_rec AS COUNT
from Ground_Devices a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
WHERE A.id_object IS NOT NULL

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Жесткая поперечина (Hard_crossbeams)
SELECT   LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT   d.id_rec as  ECH, 'ЖЕСТ_ПОПЕРЕЧ' AS ITEMNUM,a.id_rec AS COUNT
FROM Hard_crossbeams A
Left JOIN Drivings_ECHK b ON a.id_drivings = b.id_rec 
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_DRIVINGS,0) is not null

union
SELECT  d.id_rec as ECH, 'ЖЕСТ_ПОПЕРЕЧ' AS ITEMNUM,a.id_rec AS COUNT
FROM Hard_crossbeams A 
Left JOIN Station_ECHK b ON a.id_station = b.id_rec
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_STATION,0) is not null and NULLIF(a.ID_DRIVINGS,0) is null

) LIST
group by   list.ECH, list.ITEMNUM
UNION ALL
--Вывод Шкаф обогрева (Heating_shkaf)
SELECT c.id_rec AS ECH, 'ШКАФ_ОБОГР' AS ITEMNUM,count (a.id_rec) AS COUNT
FROM Heating_shkaf A 
Left JOIN ECHS b ON b.id_rec = a.id_parent
Left JOIN ECH c ON c.id_rec = b.id_parent
group by c.id_rec
UNION ALL
--Вывод Кронштейны(Holders)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT f.id_rec AS ECH,'КРОНШТЕЙН' AS ITEMNUM,a.id_rec AS COUNT
FROM Holders A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_drivings,0) is not null

Union
SELECT f.id_rec AS ECH,'КРОНШТЕЙН' AS ITEMNUM,a.id_rec AS COUNT
FROM Holders A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_station,0) is not null and nullif(c.id_drivings,0) is null

UNION
SELECT  e.id_rec AS ECH, 'КРОНШТЕЙН' AS ITEMNUM,a.id_rec AS COUNT
FROM Holders A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where b.id_airline is not null and c.id_ECHK is not null
and (nullif(c.location_station1,0) is not null
      OR NULLIF(C.LOCATION_STATION2,0) IS NOT NULL)


union
SELECT  e.id_rec AS ECH, 'КРОНШТЕЙН' AS ITEMNUM,a.id_rec AS COUNT
FROM Holders A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
WHERE B.ID_AIRLINE IS NOT NULL AND C.ID_ECHS IS NOT NULL
and (nullif(c.location_station1,0) is not null
      or nullif(c.location_station2,0) is not null)


) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Крючья и штыри(Hooks)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  e.id_rec AS ECH, 'КШ' AS ITEMNUM,a.id_rec AS COUNT
FROM Hooks A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where b.id_airline is not null and c.id_ECHK is not null
and (nullif(c.location_station1,0) is not null
      OR NULLIF(C.LOCATION_STATION2,0) IS NOT NULL)

union
SELECT  e.id_rec AS ECH, 'КШ' AS ITEMNUM,a.id_rec AS COUNT
FROM Hooks A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
WHERE B.ID_AIRLINE IS NOT NULL AND C.ID_ECHS IS NOT NULL
and (nullif(c.location_station1,0) is not null
      or nullif(c.location_station2,0) is not null)

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Изолирующие сопряжения и нейтральные вставки (Insertions)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  d.id_rec AS ECH,'ИЗОЛ_СОПР_НЕЙТР_ВСТ' AS ITEMNUM,a.id_rec AS COUNT
FROM Insertions A
Left JOIN Drivings_ECHK b ON a.id_drivings = b.id_rec 
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
Where nullif(a.id_drivings,0) is not null
Union
SELECT  d.id_rec AS ECH,'ИЗОЛ_СОПР_НЕЙТР_ВСТ' AS ITEMNUM,a.id_rec AS COUNT
FROM Insertions A 
Left JOIN Station_ECHK b ON a.id_station = b.id_rec
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
WHERE nullif(A.id_station,0) IS NOT NULL AND nullif(A.id_drivings,0) IS NULL
) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Изоляторы в целом(Insulators)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  e.id_rec AS ECH, 'ИЗОЛЯТОРЫ' AS ITEMNUM,a.id_rec AS COUNT
FROM Insulators A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where b.id_airline is not null  and c.id_ECHK is not null and a.id_tower_airline is not null
and (nullif(c.location_station1,0) is not null
      OR NULLIF(C.LOCATION_STATION2,0) IS NOT NULL)


union
SELECT  e.id_rec AS ECH, 'ИЗОЛЯТОРЫ' AS ITEMNUM,a.id_rec AS COUNT
FROM Insulators A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where b.id_airline is not null  and c.id_ECHS is not null and a.id_tower_airline is not null
and (nullif(c.location_station1,0) is not null
      OR NULLIF(C.LOCATION_STATION2,0) IS NOT NULL)


UNION
SELECT f.id_rec AS ECH,'ИЗОЛЯТОРЫ' AS ITEMNUM,a.id_rec AS COUNT
FROM Insulators A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_drivings,0) is not null

Union
SELECT f.id_rec AS ECH,'ИЗОЛЯТОРЫ' AS ITEMNUM,a.id_rec AS COUNT
FROM Insulators A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_station,0) is not null and nullif(c.id_drivings,0) is null

UNION
SELECT  e.id_rec AS ECH, 'ИЗОЛЯТОРЫ' AS ITEMNUM,a.id_rec AS COUNT
FROM Insulators A
Left JOIN Flexible_crossbeams b ON a.gp = b.id_rec
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
Where nullif(b.id_drivings,0) is not null

Union
SELECT  e.id_rec AS ECH, 'ИЗОЛЯТОРЫ' AS ITEMNUM,a.id_rec AS COUNT
FROM Insulators A
Left JOIN Flexible_crossbeams b ON a.gp = b.id_rec
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
Where nullif(b.id_station,0) is not null and nullif(b.id_drivings,0) is null

UNION
SELECT  e.id_rec AS ECH, 'ИЗОЛЯТОРЫ' AS ITEMNUM,a.id_rec AS COUNT
FROM Insulators A
Left JOIN Hard_crossbeams b ON a.zhp = b.id_rec
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
Where nullif(b.id_drivings,0) is not null

Union
SELECT e.id_rec AS ECH, 'ИЗОЛЯТОРЫ' AS ITEMNUM,a.id_rec AS COUNT
FROM Insulators A
Left JOIN Hard_crossbeams b ON a.zhp = b.id_rec
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
Where nullif(b.id_station,0) is not null and nullif(b.id_drivings,0) is null

UNION
SELECT d.id_rec AS ECH,'ИЗОЛЯТОРЫ' AS ITEMNUM,a.id_rec AS COUNT
from Insulators a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_device is not null

UNION
--Device2
SELECT f.id_rec AS ECH,'ИЗОЛЯТОРЫ' AS ITEMNUM,a.id_rec AS COUNT
from Insulators a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echs,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_eche,0) is null
and ((c.location_station1 is not null and c.location_station2 is not null)
OR (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL AND NULLIF(C.LOCATION_STATION2,0) IS NOT NULL))


UNION
SELECT f.id_rec AS ECH,'ИЗОЛЯТОРЫ' AS ITEMNUM,a.id_rec AS COUNT
from Insulators a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echk,0) is not null and nullif(d.id_echs,0) is null and nullif(d.id_eche,0) is null
and ((c.location_station1 is not null and c.location_station2 is not null)
OR (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL AND NULLIF(C.LOCATION_STATION2,0) IS NOT NULL))


Union
SELECT f.id_rec AS ECH,'ИЗОЛЯТОРЫ' AS ITEMNUM,a.id_rec AS COUNT
from Insulators a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
WHERE A.ID_DEVICE2 IS NOT NULL AND NULLIF(D.ID_ECHE,0) IS NOT NULL AND NULLIF(D.ID_ECHK,0) IS NULL AND NULLIF(D.ID_ECHS,0) IS NULL
and ((c.location_station1 is not null and c.location_station2 is not null)
or (nullif(c.location_station1,0) is not null and nullif(c.location_station2,0) is not null))


UNION
--object
SELECT  c.id_rec AS ECH, 'ИЗОЛЯТОРЫ' AS ITEMNUM,a.id_rec AS COUNT
from Insulators a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
WHERE A.id_object IS NOT NULL
 
) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Освещение(Lamps)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  c.id_rec AS ECH, 'ОСВЕЩЕНИЕ' AS ITEMNUM,a.id_rec AS COUNT
FROM Lamps A 
Left JOIN ECHK b ON b.id_rec = a.id_ECHK
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.id_echk is not null and nullif(a.id_mast,0) is null and a.id_tower_airline is NULL and a.id_ECHS is NULL and a.id_ECHE is NULL
      and (nullif(a.location_station1,0) is not null
      OR NULLIF(A.LOCATION_STATION2,0) IS NOT NULL)

union
SELECT c.id_rec AS ECH, 'ОСВЕЩЕНИЕ' AS ITEMNUM,a.id_rec AS COUNT
FROM Lamps A 
Left JOIN ECHS b ON b.id_rec = a.id_ECHS
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.id_echs is not null and nullif(a.id_mast,0) is null and a.id_tower_airline is NULL and a.id_ECHK is NULL and a.id_ECHE is NULL
      and (nullif(a.location_station1,0) is not null
      OR NULLIF(A.LOCATION_STATION2,0) IS NOT NULL)

union
SELECT  c.id_rec AS ECH, 'ОСВЕЩЕНИЕ' AS ITEMNUM,a.id_rec AS COUNT
FROM Lamps A 
Left JOIN ECHE b ON b.id_rec = a.id_ECHE
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.id_eche is not null and nullif(a.id_mast,0) is null and a.id_tower_airline is NULL and a.id_ECHK is NULL and a.id_ECHS is NULL

UNION
SELECT  d.id_rec AS ECH,'ОСВЕЩЕНИЕ' AS ITEMNUM,a.id_rec AS COUNT
FROM Lamps A 
Left JOIN Mast b ON b.id_rec = a.id_mast
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
WHERE B.ID_ECHK IS NOT NULL AND B.ID_ECHE IS NULL AND B.ID_PARENT IS NULL
      and (nullif(b.location_station1,0) is not null
      or nullif(b.location_station2,0) is not null)


UNION
SELECT d.id_rec AS ECH,'ОСВЕЩЕНИЕ' AS ITEMNUM,a.id_rec AS COUNT
FROM Lamps A 
Left JOIN Mast b ON b.id_rec = a.id_mast
Left JOIN ECHS c ON c.id_rec = b.id_parent
Left JOIN ECH d ON d.id_rec = c.id_parent
where b.id_parent is not null and b.id_ECHE is NULL and b.id_ECHK is NULL
      and (nullif(b.location_station1,0) is not null
      OR NULLIF(B.LOCATION_STATION2,0) IS NOT NULL)


UNION
SELECT d.id_rec AS ECH,'ОСВЕЩЕНИЕ' AS ITEMNUM,a.id_rec AS COUNT
FROM Lamps A 
Left JOIN Mast b ON b.id_rec = a.id_mast
Left JOIN ECHE c ON c.id_rec = b.id_eche
Left JOIN ECH d ON d.id_rec = c.id_parent
where b.id_eche is not null and b.id_parent is NULL and b.id_ECHK is NULL

UNION
SELECT  e.id_rec AS ECH, 'ОСВЕЩЕНИЕ' AS ITEMNUM,a.id_rec AS COUNT
FROM Lamps A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where b.id_airline is not null and c.id_ECHK is not null and a.id_ECHK is NULL and a.id_ECHS is NULL and a.id_ECHE is NULL
      and (nullif(c.location_station1,0) is not null
      OR NULLIF(C.LOCATION_STATION2,0) IS NOT NULL)

union
SELECT  e.id_rec AS ECH, 'ОСВЕЩЕНИЕ' AS ITEMNUM,a.id_rec AS COUNT
FROM Lamps A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
WHERE b.id_airline IS NOT NULL AND c.id_ECHS IS NOT NULL AND A.id_ECHK IS NULL AND A.id_ECHS IS NULL AND A.id_ECHE IS NULL
      and (nullif(c.location_station1,0) is not null
      OR NULLIF(C.LOCATION_STATION2,0) IS NOT NULL)

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Прожекторные мачты(Mast)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  c.id_rec AS ECH, 'ПРОЖ_МАЧТ' AS ITEMNUM,a.id_rec AS COUNT
FROM Mast A 
Left JOIN ECHK b ON b.id_rec = a.id_ECHK
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.id_echk is not null
      and (nullif(a.location_station1,0) is not null
      OR NULLIF(A.LOCATION_STATION2,0) IS NOT NULL)

union
SELECT c.id_rec AS ECH, 'ПРОЖ_МАЧТ' AS ITEMNUM,a.id_rec AS COUNT
FROM Mast A 
Left JOIN ECHS b ON b.id_rec = a.id_parent
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.id_parent is not null
      and (nullif(a.location_station1,0) is not null
      OR NULLIF(A.LOCATION_STATION2,0) IS NOT NULL)

union
SELECT  c.id_rec AS ECH, 'ПРОЖ_МАЧТ' AS ITEMNUM,a.id_rec AS COUNT
FROM Mast A 
Left JOIN ECHE b ON b.id_rec = a.id_ECHE
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.id_eche is not null
) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL

--Вывод Контактные подвески (Podveska)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  e.id_rec AS ECH, 'КОНТ_ПОДВЕС' AS ITEMNUM,a.id_rec AS COUNT
FROM Podveska A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
Where nullif(b.id_drivings,0) is not null --and (label_wire1 ='0' and label_wire2 ='0' and type_wire = '0' and type_wire_1 = '0' and type_wire_2 ='0' and type_cable = '0' and type_cable2 = '0')

Union
SELECT  e.id_rec AS ECH, 'КОНТ_ПОДВЕС' AS ITEMNUM,a.id_rec AS COUNT
FROM Podveska A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
WHERE nullif(b.id_station,0) IS NOT NULL AND nullif(b.id_drivings,0) IS NULL --and (label_wire1 ='0' and label_wire2 ='0' and type_wire = '0' and type_wire_1 = '0' and type_wire_2 ='0' and type_cable = '0' and type_cable2 = '0')

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Секционный изолятор (Sectional_Insulators)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  d.id_rec AS ECH,'СЕКЦ_ИЗОЛ' AS ITEMNUM,a.id_rec AS COUNT
FROM Sectional_Insulators A
Left JOIN Drivings_ECHK b ON a.id_drivings = b.id_rec 
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
Where nullif(a.id_drivings,0) is not null

Union
SELECT  d.id_rec AS ECH,'СЕКЦ_ИЗОЛ' AS ITEMNUM,a.id_rec AS COUNT
FROM Sectional_Insulators A 
Left JOIN Station_ECHK b ON a.id_station = b.id_rec
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
WHERE nullif(A.id_station,0) IS NOT NULL AND nullif(A.id_drivings,0) IS NULL

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Короткозамыкатели (ShortClosers)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT d.id_rec AS ECH,'КОРОТКОЗАМЫКАТЕЛИ' AS ITEMNUM,a.id_rec AS COUNT
from ShortClosers a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_device is not null

UNION
--Device2
SELECT f.id_rec AS ECH,'КОРОТКОЗАМЫКАТЕЛИ' AS ITEMNUM,a.id_rec AS COUNT
from ShortClosers a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echs,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_eche,0) is null

UNION
SELECT f.id_rec AS ECH,'КОРОТКОЗАМЫКАТЕЛИ' AS ITEMNUM,a.id_rec AS COUNT
from ShortClosers a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echk,0) is not null and nullif(d.id_echs,0) is null and nullif(d.id_eche,0) is null
UNION
SELECT f.id_rec AS ECH,'КОРОТКОЗАМЫКАТЕЛИ' AS ITEMNUM,a.id_rec AS COUNT
from ShortClosers a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
WHERE A.id_device2 IS NOT NULL AND nullif(d.id_eche,0) IS NOT NULL AND nullif(d.id_echk,0) IS NULL AND nullif(d.id_echs,0) IS NULL
) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Сглаживающие устройства(Smooth_Devices)
SELECT d.id_rec AS ECH,'СГЛАЖ_УСТР' AS ITEMNUM, count (a.id_rec) AS COUNT
from Smooth_Devices a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
GROUP BY   d.id_rec
UNION ALL
--Вывод Искровые промежутки(Sparkling_Gaps)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT f.id_rec AS ECH,'ИСКР_ПРОМ' AS ITEMNUM,a.id_rec AS COUNT
FROM Sparkling_Gaps A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_drivings,0) is not null
Union
SELECT f.id_rec AS ECH,'ИСКР_ПРОМ' AS ITEMNUM,a.id_rec AS COUNT
FROM Sparkling_Gaps A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
WHERE nullif(c.id_station,0) IS NOT NULL AND nullif(c.id_drivings,0) IS NULL
) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Аккумуляторная батарея(Storage_Battery)
SELECT d.id_rec AS ECH,'АБ' AS ITEMNUM,count (a.id_rec) AS COUNT
from Storage_Battery a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
GROUP BY   d.id_rec
UNION ALL
--Вывод Коммутационная аппаратура (Switchgear)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT d.id_rec AS ECH,'КОММ_АПП' AS ITEMNUM,a.id_rec AS COUNT
from Switchgear a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_device is not null

UNION
--Device2
SELECT f.id_rec AS ECH,'КОММ_АПП' AS ITEMNUM,a.id_rec AS COUNT
from Switchgear a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echs,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_eche,0) is null
and ((c.location_station1 is not null and c.location_station2 is not null)
OR (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL AND NULLIF(C.LOCATION_STATION2,0) IS NOT NULL))


UNION
SELECT f.id_rec AS ECH,'КОММ_АПП' AS ITEMNUM,a.id_rec AS COUNT
from Switchgear a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echk,0) is not null and nullif(d.id_echs,0) is null and nullif(d.id_eche,0) is null
and ((c.location_station1 is not null and c.location_station2 is not null)
OR (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL AND NULLIF(C.LOCATION_STATION2,0) IS NOT NULL))


Union
SELECT f.id_rec AS ECH,'КОММ_АПП' AS ITEMNUM,a.id_rec AS COUNT
from Switchgear a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_eche,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_echs,0) is null
and ((c.location_station1 is not null and c.location_station2 is not null)
OR (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL AND NULLIF(C.LOCATION_STATION2,0) IS NOT NULL))


UNION
--object
SELECT  c.id_rec AS ECH, 'КОММ_АПП' AS ITEMNUM,a.id_rec AS COUNT
from Switchgear a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
WHERE A.id_object IS NOT NULL

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Опоры КС(Towers)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  e.id_rec AS ECH, 'ОПОРЫ_КС' AS ITEMNUM,a.id_rec AS COUNT
FROM Towers A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
LEFT JOIN ECHK d ON d.id_rec = c.id_ECHK
LEFT JOIN ECH e ON e.id_rec = d.id_parent
Where nullif(b.id_drivings,0) is not null

UNION
SELECT  e.id_rec AS ECH, 'ОПОРЫ_КС' AS ITEMNUM,a.id_rec AS COUNT
FROM Towers A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
LEFT JOIN ECH e ON e.id_rec = d.id_parent
WHERE nullif(b.id_station,0) IS NOT NULL AND nullif(b.id_drivings,0) IS NULL

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод ОПОРЫ ВЛ(Towers_airlines)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  d.id_rec AS ECH,'ОПОРЫ_ВЛ' AS ITEMNUM,a.id_rec AS COUNT
FROM Towers_airlines A
inner JOIN Air_Lines b ON b.id_rec=a.id_airline 
      and (nullif(b.location_station1,0) is not null
      or nullif(b.location_station2,0) is not null)
      AND B.ID_ECHK IS NOT NULL
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_airline is not null 

union
SELECT  d.id_rec AS ECH,'ОПОРЫ_ВЛ' AS ITEMNUM,a.id_rec AS COUNT
FROM Towers_airlines A
inner JOIN Air_Lines b ON b.id_rec=a.id_airline 
      and (nullif(b.location_station1,0) is not null
      OR NULLIF(B.LOCATION_STATION2,0) IS NOT NULL)
      AND B.ID_ECHS IS NOT NULL 
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_airline is not null 

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL 
--Вывод ОПОРЫ ДОП ПРОВ(Towers_airlines)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT f.id_rec AS ECH,'ОПОРЫ_ДОП_ПРОВ' AS ITEMNUM,a.id_rec AS COUNT
FROM Towers_airlines A
Left JOIN Additional_Wires b ON a.id_add_wire = b.id_rec
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_drivings,0) is not null

union
SELECT f.id_rec AS ECH,'ОПОРЫ_ДОП_ПРОВ' AS ITEMNUM,a.id_rec AS COUNT
FROM Towers_airlines A
Left JOIN Additional_Wires b ON a.id_add_wire = b.id_rec
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
WHERE nullif(c.id_station,0) IS NOT NULL AND nullif(c.id_drivings,0) IS NULL

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Преобразовательные трансформаторы (Transformer)
SELECT d.id_rec AS ECH,'ПРЕОБ_ТРАНСФ' AS ITEMNUM, count (a.id_rec) AS COUNT
from Transformer a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
GROUP BY   d.id_rec
UNION ALL
--Вывод Трансформатор тока (Transformers_Current)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT d.id_rec AS ECH,'ТРАНСФ_ТОКА' AS ITEMNUM,a.id_rec AS COUNT
from Transformers_Current a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_device is not null
UNION
--Device2
SELECT f.id_rec AS ECH,'ТРАНСФ_ТОКА' AS ITEMNUM,a.id_rec AS COUNT
from Transformers_Current a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echs,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_eche,0) is null
and ((c.location_station1 is not null and c.location_station2 is not null)
or (nullif(c.location_station1,0) is not null and nullif(c.location_station2,0) is not null))
UNION
SELECT f.id_rec AS ECH,'ТРАНСФ_ТОКА' AS ITEMNUM,a.id_rec AS COUNT
from Transformers_Current a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echk,0) is not null and nullif(d.id_echs,0) is null and nullif(d.id_eche,0) is null
and ((c.location_station1 is not null and c.location_station2 is not null)
or (nullif(c.location_station1,0) is not null and nullif(c.location_station2,0) is not null))
Union
SELECT f.id_rec AS ECH,'ТРАНСФ_ТОКА' AS ITEMNUM,a.id_rec AS COUNT
from Transformers_Current a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_eche,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_echs,0) is null
and ((c.location_station1 is not null and c.location_station2 is not null)
or (nullif(c.location_station1,0) is not null and nullif(c.location_station2,0) is not null))

UNION
--object
SELECT  c.id_rec AS ECH, 'ТРАНСФ_ТОКА' AS ITEMNUM,a.id_rec AS COUNT
from Transformers_Current a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
WHERE A.id_object IS NOT NULL
 
) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Выводы Дроссель-трансформатор (Transformers_Suction purpose=11)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  e.id_rec AS ECH, 'ДРОСС_ТРАНСФ' AS ITEMNUM,a.id_rec AS COUNT
FROM Transformers_Suction A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
Where nullif(b.id_drivings,0) is not null and a.purpose = '11'

Union
SELECT  e.id_rec AS ECH, 'ДРОСС_ТРАНСФ' AS ITEMNUM,a.id_rec AS COUNT
FROM Transformers_Suction A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
WHERE nullif(b.id_station,0) IS NOT NULL AND nullif(b.id_drivings,0) IS NULL AND A.purpose = '11'

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Выводы Отсасывающий трансформатор(Transformers_Suction purpose=2)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  e.id_rec AS ECH, 'ОТСАСЫВ_ТРАНСФ' AS ITEMNUM,a.id_rec AS COUNT
FROM Transformers_Suction A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
Where nullif(b.id_drivings,0) is not null and a.purpose = '2'

Union
SELECT  e.id_rec AS ECH, 'ОТСАСЫВ_ТРАНСФ' AS ITEMNUM,a.id_rec AS COUNT
FROM Transformers_Suction A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
WHERE nullif(b.id_station,0) IS NOT NULL AND nullif(b.id_drivings,0) IS NULL AND A.purpose = '2'

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Трансформаторы напряжения (Transformers_Voltage)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT d.id_rec AS ECH,'ТРАНС_НАПР' AS ITEMNUM,a.id_rec AS COUNT
from Transformers_Voltage a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_device is not null

UNION
--Device2
SELECT f.id_rec AS ECH,'ТРАНС_НАПР' AS ITEMNUM,a.id_rec AS COUNT
from Transformers_Voltage a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echs,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_eche,0) is null
and ((c.location_station1 is not null and c.location_station2 is not null)
OR (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL AND NULLIF(C.LOCATION_STATION2,0) IS NOT NULL))


UNION
SELECT f.id_rec AS ECH,'ТРАНС_НАПР' AS ITEMNUM,a.id_rec AS COUNT
from Transformers_Voltage a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echk,0) is not null and nullif(d.id_echs,0) is null and nullif(d.id_eche,0) is null
and ((c.location_station1 is not null and c.location_station2 is not null)
OR (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL AND NULLIF(C.LOCATION_STATION2,0) IS NOT NULL))


Union
SELECT f.id_rec AS ECH,'ТРАНС_НАПР' AS ITEMNUM,a.id_rec AS COUNT
from Transformers_Voltage a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_eche,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_echs,0) is null

UNION
--object
SELECT  c.id_rec AS ECH, 'ТРАНС_НАПР' AS ITEMNUM,a.id_rec AS COUNT
from Transformers_Voltage a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
WHERE A.id_object IS NOT NULL

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Трансформаторы и автотрансформаторы силовые(transformers2)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  e.id_rec AS ECH, 'ТРАНС_АВТОТРАНС' AS ITEMNUM,a.id_rec AS COUNT
FROM transformers2 A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where b.id_airline is not null  and c.id_ECHK is not null and a.id_tower_airline is not null
and (nullif(c.location_station1,0) is not null
      OR NULLIF(C.LOCATION_STATION2,0) IS NOT NULL)


union
SELECT  e.id_rec AS ECH, 'ТРАНС_АВТОТРАНС' AS ITEMNUM,a.id_rec AS COUNT
FROM transformers2 A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where b.id_airline is not null  and c.id_ECHS is not null and a.id_tower_airline is not null
and (nullif(c.location_station1,0) is not null
      OR NULLIF(C.LOCATION_STATION2,0) IS NOT NULL)


UNION
SELECT d.id_rec AS ECH,'ТРАНС_АВТОТРАНС' AS ITEMNUM,a.id_rec AS COUNT
from transformers2 a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_device is not null

UNION
--Device2
SELECT f.id_rec AS ECH,'ТРАНС_АВТОТРАНС' AS ITEMNUM,a.id_rec AS COUNT
from transformers2 a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echs,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_eche,0) is null
and ((c.location_station1 is not null and c.location_station2 is not null)
OR (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL AND NULLIF(C.LOCATION_STATION2,0) IS NOT NULL))


UNION
SELECT f.id_rec AS ECH,'ТРАНС_АВТОТРАНС' AS ITEMNUM,a.id_rec AS COUNT
from transformers2 a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echk,0) is not null and nullif(d.id_echs,0) is null and nullif(d.id_eche,0) is null
and ((c.location_station1 is not null and c.location_station2 is not null)
OR (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL AND NULLIF(C.LOCATION_STATION2,0) IS NOT NULL))


Union
SELECT f.id_rec AS ECH,'ТРАНС_АВТОТРАНС' AS ITEMNUM,a.id_rec AS COUNT
from transformers2 a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_eche,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_echs,0) is null

UNION
--object
SELECT  c.id_rec AS ECH, 'ТРАНС_АВТОТРАНС' AS ITEMNUM,a.id_rec AS COUNT
from transformers2 a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
WHERE A.id_object IS NOT NULL

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Траверсы(Traverses)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  e.id_rec AS ECH, 'ТРАВЕРСЫ' AS ITEMNUM,a.id_rec AS COUNT
FROM Traverses A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where b.id_airline is not null and c.id_ECHK is not null
and (nullif(c.location_station1,0) is not null
      OR NULLIF(C.LOCATION_STATION2,0) IS NOT NULL)

union
SELECT  e.id_rec AS ECH, 'ТРАВЕРСЫ' AS ITEMNUM,a.id_rec AS COUNT
FROM Traverses A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where b.id_airline is not null and c.id_ECHS is not null
and (nullif(c.location_station1,0) is not null
      OR NULLIF(C.LOCATION_STATION2,0) IS NOT NULL)


) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Грузокомпенсирующие устройства(Weight_Compensating)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT f.id_rec AS ECH,'ГРУЗОКОМ_УСТР' AS ITEMNUM,a.id_rec AS COUNT
FROM Weight_Compensating A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_drivings,0) is not null

Union
SELECT f.id_rec AS ECH,'ГРУЗОКОМ_УСТР' AS ITEMNUM,a.id_rec AS COUNT
FROM Weight_Compensating A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
WHERE nullif(c.id_station,0) IS NOT NULL AND nullif(c.id_drivings,0) IS NULL

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Провода воздушных линий(Wires)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  d.id_rec AS ECH,'ПРОВОДА_ВЛ' AS ITEMNUM,a.id_rec AS COUNT
FROM Wires A
inner JOIN Air_Lines b ON b.id_rec=a.id_airline 
      and (nullif(b.location_station1,0) is not null
      or nullif(b.location_station2,0) is not null)
      AND b.ID_ECHK IS NOT NULL
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_airline is not null 

union
SELECT  d.id_rec AS ECH,'ПРОВОДА_ВЛ' AS ITEMNUM,a.id_rec AS COUNT
FROM Wires A
inner JOIN Air_Lines b ON b.id_rec=a.id_airline 
      and (nullif(b.location_station1,0) is not null
      or nullif(b.location_station2,0) is not null)
      AND b.ID_ECHS IS NOT NULL
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_airline is not null

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод ЗПУ (ZPU)
SELECT d.id_rec AS ECH,'ЗПУ' AS ITEMNUM, count (a.id_rec) AS COUNT
from ZPU a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
GROUP BY  d.id_rec
UNION ALL
--Вывод Ограничители перенапряжений(OPN)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT  e.id_rec AS ECH, 'ОПН' AS ITEMNUM,a.id_rec AS COUNT
FROM OPN A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where b.id_airline is not null  and c.id_ECHK is not null and a.id_tower_airline is not null
AND (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL
      or nullif(c.location_station2,0) is not null)

union
SELECT  e.id_rec AS ECH, 'ОПН' AS ITEMNUM,a.id_rec AS COUNT
FROM OPN A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where b.id_airline is not null  and c.id_ECHS is not null and a.id_tower_airline is not null
AND (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL
      or nullif(c.location_station2,0) is not null)

UNION
SELECT f.id_rec AS ECH,'ОПН' AS ITEMNUM,a.id_rec AS COUNT
FROM OPN A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_drivings,0) is not null

Union
SELECT f.id_rec AS ECH,'ОПН' AS ITEMNUM,a.id_rec AS COUNT
FROM OPN A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_station,0) is not null and nullif(c.id_drivings,0) is null

UNION
SELECT d.id_rec AS ECH,'ОПН' AS ITEMNUM,a.id_rec AS COUNT
from OPN a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_device is not null

UNION
--Device2
SELECT f.id_rec AS ECH,'ОПН' AS ITEMNUM,a.id_rec AS COUNT
from OPN a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echs,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_eche,0) is null
and ((c.location_station1 is not null and c.location_station2 is not null)
or (nullif(c.location_station1,0) is not null and nullif(c.location_station2,0) is not null))


UNION
SELECT f.id_rec AS ECH,'ОПН' AS ITEMNUM,a.id_rec AS COUNT
from OPN a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echk,0) is not null and nullif(d.id_echs,0) is null and nullif(d.id_eche,0) is null
and ((c.location_station1 is not null and c.location_station2 is not null)
OR (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL AND NULLIF(C.LOCATION_STATION2,0) IS NOT NULL))


Union
SELECT f.id_rec AS ECH,'ОПН' AS ITEMNUM,a.id_rec AS COUNT
from OPN a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_eche,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_echs,0) is null

UNION
--object
SELECT  c.id_rec AS ECH, 'ОПН' AS ITEMNUM,a.id_rec AS COUNT
from OPN a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
WHERE A.id_object IS NOT NULL

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Электрические соединители (Electric_Connector)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT f.id_rec AS ECH,'ЭЛ_СОЕД' AS ITEMNUM,a.id_rec AS COUNT
FROM Electric_Connector A
Left JOIN Podveska b ON a.id_podveska = b.id_rec
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_drivings,0) is not null and (a.purpose =7 or a.purpose = 8)

Union
SELECT f.id_rec AS ECH,'ЭЛ_СОЕД' AS ITEMNUM,a.id_rec AS COUNT
FROM Electric_Connector A
Left JOIN Podveska b ON a.id_podveska = b.id_rec
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_station,0) is not null and nullif(c.id_drivings,0) is null and (a.purpose =7 or a.purpose = 8)

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
UNION ALL
--Вывод Струны (Electric_Connector)
SELECT  LIST.ECH,  LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
FROM (
SELECT f.id_rec AS ECH,'СТРУНЫ' AS ITEMNUM,a.id_rec AS COUNT
FROM Electric_Connector A
Left JOIN Podveska b ON a.id_podveska = b.id_rec
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_drivings,0) is not null and a.purpose not in (7,8)

Union
SELECT f.id_rec AS ECH,'СТРУНЫ' AS ITEMNUM,a.id_rec AS COUNT
FROM Electric_Connector A
Left JOIN Podveska b ON a.id_podveska = b.id_rec
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
Where nullif(c.id_station,0) is not null and nullif(c.id_drivings,0) is null and a.purpose not in (7,8)

) LIST
group by  list.ECH,  list.ITEMNUM

union all

SELECT d.id_rec as ECH ,'ОПОР_КОНСТР' AS ITEMNUM, count (a.id_rec) AS COUNT
from support a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
left join ECH D on D.ID_REC = C.ID_PARENT
group by d.id_rec

union all

SELECT  LIST.ECH, LIST.ITEMNUM, COUNT(LIST.COUNT) AS COUNT 
from (
SELECT e.id_rec AS ECH, 'ПРЕДОХРАНИТЕЛИ' AS ITEMNUM,a.id_rec AS COUNT
FROM Fuzes A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHK is not null and a.ID_TOWER_AIRLINE is not null
and (nullif(c.location_station1,0) is not null
      OR NULLIF(C.LOCATION_STATION2,0) IS NOT NULL)


union
SELECT e.id_rec AS ECH, 'ПРЕДОХРАНИТЕЛИ' AS ITEMNUM,a.id_rec AS COUNT
FROM Fuzes A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
WHERE B.ID_AIRLINE IS NOT NULL  AND C.ID_ECHS IS NOT NULL AND A.ID_TOWER_AIRLINE IS NOT NULL
and (nullif(c.location_station1,0) is not null
      OR NULLIF(C.LOCATION_STATION2,0) IS NOT NULL)


union
SELECT d.id_rec AS ECH,'ПРЕДОХРАНИТЕЛИ' AS ITEMNUM,a.id_rec AS COUNT
from Fuzes a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.id_device is not null

UNION
--Device2
SELECT f.id_rec AS ECH,'ПРЕДОХРАНИТЕЛИ' AS ITEMNUM,a.id_rec AS COUNT
from Fuzes a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
WHERE A.ID_DEVICE2 IS NOT NULL AND NULLIF(D.ID_ECHS,0) IS NOT NULL AND NULLIF(D.ID_ECHK,0) IS NULL AND NULLIF(D.ID_ECHE,0) IS NULL
and ((c.location_station1 is not null and c.location_station2 is not null)
OR (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL AND NULLIF(C.LOCATION_STATION2,0) IS NOT NULL))


union
SELECT f.id_rec AS ECH, 'ПРЕДОХРАНИТЕЛИ' AS ITEMNUM,a.id_rec AS COUNT
from Fuzes a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_echk,0) is not null and nullif(d.id_echs,0) is null and nullif(d.id_eche,0) is null
and ((c.location_station1 is not null and c.location_station2 is not null)
OR (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL AND NULLIF(C.LOCATION_STATION2,0) IS NOT NULL))


union
SELECT f.id_rec AS ECH, 'ПРЕДОХРАНИТЕЛИ' AS ITEMNUM,a.id_rec AS COUNT
from Fuzes a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.id_device2 is not null and nullif(d.id_eche,0) is not null and nullif(d.id_echk,0) is null and nullif(d.id_echs,0) is null
and ((c.location_station1 is not null and c.location_station2 is not null)
OR (NULLIF(C.LOCATION_STATION1,0) IS NOT NULL AND NULLIF(C.LOCATION_STATION2,0) IS NOT NULL))


UNION
--object
SELECT  c.id_rec AS ECH, 'ПРЕДОХРАНИТЕЛИ' AS ITEMNUM,a.id_rec AS COUNT
from Fuzes a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
WHERE A.id_object IS NOT NULL

) LIST
GROUP BY  LIST.ECH,  LIST.ITEMNUM
</property>
            <xml-property name="designerValues"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<model:DesignValues xmlns:design="http://www.eclipse.org/datatools/connectivity/oda/design" xmlns:model="http://www.eclipse.org/birt/report/model/adapter/odaModel">
  <Version>1.0</Version>
  <design:ResultSets derivedMetaData="true">
    <design:resultSetDefinitions>
      <design:resultSetColumns>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:name>ECH</design:name>
            <design:position>1</design:position>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>10</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>ECH</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>ECH</design:label>
            <design:formattingHints>
              <design:displaySize>10</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:name>ITEMNUM</design:name>
            <design:position>2</design:position>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>19</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>ITEMNUM</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>ITEMNUM</design:label>
            <design:formattingHints>
              <design:displaySize>19</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:name>COUNT</design:name>
            <design:position>3</design:position>
            <design:nativeDataTypeCode>4</design:nativeDataTypeCode>
            <design:precision>10</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>COUNT</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>COUNT</design:label>
            <design:formattingHints>
              <design:displaySize>4</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
      </design:resultSetColumns>
    </design:resultSetDefinitions>
  </design:ResultSets>
</model:DesignValues>]]></xml-property>
        </oda-data-set>
        <script-data-set name="Data Set" id="9436">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">SITEID</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">ECH</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">DESCRIPTION</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">ITEMNUM</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">ITEMDESC</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">CNT</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">7</property>
                    <property name="name">JOI</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">SITEID</property>
                </structure>
                <structure>
                    <property name="columnName">ECH</property>
                </structure>
                <structure>
                    <property name="columnName">DESCRIPTION</property>
                </structure>
                <structure>
                    <property name="columnName">ITEMNUM</property>
                </structure>
                <structure>
                    <property name="columnName">ITEMDESC</property>
                </structure>
                <structure>
                    <property name="columnName">CNT</property>
                </structure>
                <structure>
                    <property name="columnName">JOI</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">SITEID</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">ECH</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">ITEMDESC</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">CNT</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">JOI</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[maximoDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());
	maximoDataSet.open();
	
	
	
	
	var sqlText = new String();

	sqlText =  " WITH DATA AS (SELECT '" + params["mroSite"] + "' AS SITEID FROM DUAL), "
+" LOCLIST AS ( "
+" SELECT  distinct LA.LOCATION LOCATION, CONNECT_BY_ROOT la.parent PRED "
+" FROM MAXIMO.LOCHIERARCHY LA "
+" INNER JOIN MAXIMO.LOCATIONS L ON LA.LOCATION=L.LOCATION AND L.STATUS='РАБОТАЕТ' AND L.SITEID=(SELECT SITEID FROM DATA)  "
+" START WITH LA.PARENT in "
+"                              (select location from maximo.locations where siteid=(SELECT SITEID FROM DATA)  "
+"                              and status='РАБОТАЕТ'  "
+"                              and CLASSSTRUCTUREID='090000000003'  "
+"                              and description like 'ЭЧ-%') "
+"       AND LA.SITEID=(SELECT SITEID FROM DATA)  "
+"       AND LA.SYSTEMID='СЭ' "
+" CONNECT BY NOCYCLE  PRIOR LA.LOCATION =  LA.PARENT   "
+"       AND PRIOR LA.SITEID= LA.SITEID  "
+"       AND PRIOR LA.SYSTEMID= LA.SYSTEMID "
+"       AND (LA.LOCATION LIKE 'ECH%' OR LA.LOCATION LIKE 'LO%' OR LA.LOCATION LIKE 'RU%' OR LA.LOCATION LIKE 'JOINING%')  "
+" ), "

+" LIST AS (  "
+"   SELECT SITEID, ITEMNUM, ASSETNUM,IDINEXTSYSTEM_ALN, PARENT, CONNECT_BY_ROOT LOCATION AS LOCATION  "
+"   FROM MAXIMO.ASSET  "
+"   START WITH PARENT IS NULL  "
 +"            AND EXTSYSTEMID='3'  "
 +"            AND STATUS='РАБОТАЕТ' AND SITEID=(SELECT SITEID FROM DATA) "
 +"            AND LOCATION IN (SELECT LOCATION FROM LOCLIST) "
 +"  CONNECT BY NOCYCLE  PRIOR ASSETNUM =  PARENT AND PRIOR SITEID = SITEID AND PRIOR EXTSYSTEMID = EXTSYSTEMID AND PRIOR STATUS = STATUS " 
 +"  ) " 
 +"    " 
 +"  SELECT   "
+"   L.SITEID , SUBSTR (LOC.PRED, 6, 4)  ECH , L3.DESCRIPTION,  "
+"   CASE WHEN PD.ITEMNUM='ДОП_ПРОВ' THEN 'ОПОРЫ_ДОП_ПРОВ' ELSE L.ITEMNUM END ITEMNUM,  "
+"   CASE WHEN PD.ITEMNUM='ДОП_ПРОВ' THEN 'Опоры дополнительных проводов' ELSE I.DESCRIPTION END ITEMDESC,  "
+"   COUNT (L.ASSETNUM) as CNT, "
+"   SUBSTR (LOC.PRED,6,4)||(CASE WHEN PD.ITEMNUM='ДОП_ПРОВ' THEN 'ОПОРЫ_ДОП_ПРОВ' ELSE L.ITEMNUM END) JOI  "

+"   FROM LIST L  "
+"   LEFT JOIN LOCLIST LOC ON L.LOCATION = LOC.LOCATION  "
+"   LEFT JOIN MAXIMO.LOCATIONS L3 ON L3.LOCATION=LOC.PRED AND L3.STATUS='РАБОТАЕТ' AND L3.SITEID=L.SITEID  "
+"   LEFT JOIN MAXIMO.ASSET PD ON L.PARENT=PD.ASSETNUM AND L.SITEID=PD.SITEID AND PD.EXTSYSTEMID='3' AND PD.STATUS='РАБОТАЕТ'  "
+"   LEFT JOIN MAXIMO.ITEM I ON I.ITEMNUM=L.ITEMNUM  "

+"   GROUP BY L.SITEID, SUBSTR (LOC.PRED, 6, 4), L3.DESCRIPTION, "
+"   CASE WHEN PD.ITEMNUM='ДОП_ПРОВ' THEN 'ОПОРЫ_ДОП_ПРОВ' ELSE L.ITEMNUM END, "
+"   CASE WHEN PD.ITEMNUM='ДОП_ПРОВ' THEN 'Опоры дополнительных проводов' ELSE I.DESCRIPTION END, "
+"   SUBSTR (LOC.PRED,6,4)||(CASE WHEN PD.ITEMNUM='ДОП_ПРОВ' THEN 'ОПОРЫ_ДОП_ПРОВ' ELSE L.ITEMNUM END) "

;

	maximoDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[if (!maximoDataSet.fetch())
	   return (false);

row["SITEID"] = maximoDataSet.getInteger("SITEID");
row["ECH"] = maximoDataSet.getString("ECH");
row["DESCRIPTION"] = maximoDataSet.getString("DESCRIPTION");
row["ITEMNUM"] = maximoDataSet.getString("ITEMNUM");
row["ITEMDESC"] = maximoDataSet.getString("ITEMDESC");
row["CNT"] = maximoDataSet.getInteger("CNT");
row["JOI"] = maximoDataSet.getString("JOI");


return (true);]]></method>
        </script-data-set>
        <joint-data-set name="Data Set1" id="9616">
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">Data Set::SITEID</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">Data Set::ECH</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">Data Set::DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">Data Set::ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">Data Set::ITEMDESC</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">Data Set::CNT</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">Data Set::JOI</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">Data Set2::ECH</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">Data Set2::ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">10</property>
                        <property name="name">Data Set2::COUNT</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">11</property>
                        <property name="name">Data Set2::JOI</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <simple-property-list name="dataSets">
                <value>Data Set</value>
                <value>Data Set2</value>
            </simple-property-list>
            <list-property name="joinConditions">
                <structure>
                    <property name="joinType">full-out</property>
                    <property name="joinOperator">eq</property>
                    <property name="leftDataSet">Data Set</property>
                    <property name="rightDataSet">Data Set2</property>
                    <expression name="leftExpression">dataSetRow["JOI"]</expression>
                    <expression name="rightExpression">dataSetRow["JOI"]</expression>
                </structure>
            </list-property>
        </joint-data-set>
        <script-data-set name="Data Set3" id="9618">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">LOC</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">DESCRIPTION</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">LOC</property>
                </structure>
                <structure>
                    <property name="columnName">DESCRIPTION</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">LOC</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[maximoDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());
	maximoDataSet.open();
	
	var sqlText = new String();

	sqlText =  " select locations.idinextsystem loc, locations.description from maximo.locations "
 +" left join maximo.locationspec on locationspec.location = locations.location "
 +" and locations.siteid = locationspec.siteid "
 +" where locations.siteid = " + params["mroSite"] + " and locationspec.assetattrid = 'TIP_PREDPR' and locationspec.numvalue = 4 and locations.location like 'PRED%' "
 +" and locations.description like 'ЭЧ-%' "


;

	maximoDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[if (!maximoDataSet.fetch())
	   return (false);

row["LOC"] = maximoDataSet.getString("LOC");
row["DESCRIPTION"] = maximoDataSet.getString("DESCRIPTION");


return (true);]]></method>
        </script-data-set>
        <joint-data-set name="Data Set4" id="9619">
            <list-property name="computedColumns">
                <structure>
                    <property name="name">1</property>
                    <expression name="expression">if (row["Data Set1::Data Set::DESCRIPTION"] == null) (row["Data Set3::DESCRIPTION"])
else (row["Data Set1::Data Set::DESCRIPTION"])</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">2</property>
                    <expression name="expression">if (row["Data Set1::Data Set::ECH"] == null) (row["Data Set3::LOC"])
else (row["Data Set1::Data Set::ECH"])</expression>
                    <property name="dataType">integer</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">Data Set1::Data Set::SITEID</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">Data Set1::Data Set::ECH</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">Data Set1::Data Set::DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">Data Set1::Data Set::ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">Data Set1::Data Set::ITEMDESC</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">Data Set1::Data Set::CNT</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">Data Set1::Data Set::JOI</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">Data Set1::Data Set2::ECH</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">Data Set1::Data Set2::ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">10</property>
                        <property name="name">Data Set1::Data Set2::COUNT</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">11</property>
                        <property name="name">Data Set1::Data Set2::JOI</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">12</property>
                        <property name="name">Data Set3::LOC</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">13</property>
                        <property name="name">Data Set3::DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">14</property>
                        <property name="name">1</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">15</property>
                        <property name="name">2</property>
                        <property name="dataType">integer</property>
                    </structure>
                </list-property>
            </structure>
            <simple-property-list name="dataSets">
                <value>Data Set1</value>
                <value>Data Set3</value>
            </simple-property-list>
            <list-property name="joinConditions">
                <structure>
                    <property name="joinType">left-out</property>
                    <property name="joinOperator">eq</property>
                    <property name="leftDataSet">Data Set1</property>
                    <property name="rightDataSet">Data Set3</property>
                    <expression name="leftExpression">dataSetRow["Data Set2::ECH"]</expression>
                    <expression name="rightExpression">dataSetRow["LOC"]</expression>
                </structure>
            </list-property>
        </joint-data-set>
        <script-data-set name="Data Set31" id="9674">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">ITEMNUM</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">DESCRIPTION</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">ITEMNUM</property>
                </structure>
                <structure>
                    <property name="columnName">DESCRIPTION</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[maximoDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());
	maximoDataSet.open();
	
	var sqlText = new String();

	sqlText =  " select distinct asset.itemnum, item.description from maximo.asset "
 +" left join maximo.item on item.itemnum = asset.itemnum "
 +" where extsystemid = 3 "
 +" union all"
 +" select 'ОПОРЫ_ДОП_ПРОВ' itemnum, 'Опоры дополнительных проводов' description from dual "
 +" union all"
 +" select 'ЭЛ_СОЕД' itemnum, 'Электрические соединители' description from dual "

;

	maximoDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[if (!maximoDataSet.fetch())
	   return (false);

row["ITEMNUM"] = maximoDataSet.getString("ITEMNUM");
row["DESCRIPTION"] = maximoDataSet.getString("DESCRIPTION");


return (true);]]></method>
        </script-data-set>
        <joint-data-set name="Data Set5" id="9730">
            <list-property name="computedColumns">
                <structure>
                    <property name="name">Model</property>
                    <expression name="expression">if (row["Data Set4::Data Set1::Data Set::ITEMDESC"] == null) (row["Data Set31::DESCRIPTION"])
else (row["Data Set4::Data Set1::Data Set::ITEMDESC"])</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">CNT</property>
                    <expression name="expression">if (row["Data Set4::Data Set1::Data Set::CNT"] == null) (0)
else (row["Data Set4::Data Set1::Data Set::CNT"])</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">COUNT</property>
                    <expression name="expression">if (row["Data Set4::Data Set1::Data Set2::COUNT"] == null) (0)
else (row["Data Set4::Data Set1::Data Set2::COUNT"])</expression>
                    <property name="dataType">integer</property>
                </structure>
            </list-property>
            <list-property name="filter">
                <structure>
                    <property name="operator">is-not-null</property>
                    <expression name="expr">row["Data Set4::1"]</expression>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">Data Set4::Data Set1::Data Set::SITEID</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">Data Set4::Data Set1::Data Set::ECH</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">Data Set4::Data Set1::Data Set::DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">Data Set4::Data Set1::Data Set::ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">Data Set4::Data Set1::Data Set::ITEMDESC</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">Data Set4::Data Set1::Data Set::CNT</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">Data Set4::Data Set1::Data Set::JOI</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">Data Set4::Data Set1::Data Set2::ECH</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">Data Set4::Data Set1::Data Set2::ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">10</property>
                        <property name="name">Data Set4::Data Set1::Data Set2::COUNT</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">11</property>
                        <property name="name">Data Set4::Data Set1::Data Set2::JOI</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">12</property>
                        <property name="name">Data Set4::Data Set3::LOC</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">13</property>
                        <property name="name">Data Set4::Data Set3::DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">14</property>
                        <property name="name">Data Set4::1</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">15</property>
                        <property name="name">Data Set4::2</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">16</property>
                        <property name="name">Data Set31::ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">17</property>
                        <property name="name">Data Set31::DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">18</property>
                        <property name="name">Model</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">19</property>
                        <property name="name">CNT</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">20</property>
                        <property name="name">COUNT</property>
                        <property name="dataType">integer</property>
                    </structure>
                </list-property>
            </structure>
            <simple-property-list name="dataSets">
                <value>Data Set4</value>
                <value>Data Set31</value>
            </simple-property-list>
            <list-property name="joinConditions">
                <structure>
                    <property name="joinType">left-out</property>
                    <property name="joinOperator">eq</property>
                    <property name="leftDataSet">Data Set4</property>
                    <property name="rightDataSet">Data Set31</property>
                    <expression name="leftExpression">dataSetRow["Data Set1::Data Set2::ITEMNUM"]</expression>
                    <expression name="rightExpression">dataSetRow["ITEMNUM"]</expression>
                </structure>
            </list-property>
        </joint-data-set>
    </data-sets>
    <cubes>
        <tabular-cube name="Data Cube" id="10010">
            <property name="dimensions">
                <tabular-dimension name="Group" id="10011">
                    <property name="defaultHierarchy">NewTabularHierarchy</property>
                    <property name="hierarchies">
                        <tabular-hierarchy name="NewTabularHierarchy" id="10012">
                            <property name="levels">
                                <tabular-level name="Data Set4::1" id="10013">
                                    <property name="dataType">string</property>
                                    <property name="columnName">Data Set4::1</property>
                                </tabular-level>
                            </property>
                        </tabular-hierarchy>
                    </property>
                </tabular-dimension>
                <tabular-dimension name="Group1" id="10014">
                    <property name="defaultHierarchy">NewTabularHierarchy1</property>
                    <property name="hierarchies">
                        <tabular-hierarchy name="NewTabularHierarchy1" id="10015">
                            <property name="levels">
                                <tabular-level name="Model" id="10016">
                                    <property name="dataType">string</property>
                                    <property name="columnName">Model</property>
                                </tabular-level>
                            </property>
                        </tabular-hierarchy>
                    </property>
                </tabular-dimension>
                <tabular-dimension name="Group2" id="10236">
                    <property name="defaultHierarchy">NewTabularHierarchy2</property>
                    <property name="hierarchies">
                        <tabular-hierarchy name="NewTabularHierarchy2" id="10237">
                            <property name="levels">
                                <tabular-level name="Data Set4::2" id="10238">
                                    <property name="dataType">integer</property>
                                    <property name="levelType">dynamic</property>
                                    <property name="columnName">Data Set4::2</property>
                                </tabular-level>
                            </property>
                        </tabular-hierarchy>
                    </property>
                </tabular-dimension>
            </property>
            <property name="measureGroups">
                <tabular-measure-group name="Summary Field" id="10017">
                    <property name="measures">
                        <tabular-measure name="CNT" id="10018">
                            <property name="function">sum</property>
                            <expression name="measureExpression">dataSetRow["CNT"]</expression>
                            <property name="dataType">integer</property>
                        </tabular-measure>
                        <tabular-measure name="COUNT" id="10019">
                            <expression name="measureExpression">dataSetRow["COUNT"]</expression>
                            <property name="dataType">integer</property>
                        </tabular-measure>
                        <tabular-measure name="%%" id="10111">
                            <property name="function">sum</property>
                            <expression name="measureExpression">if (dataSetRow["COUNT"] == 0)  (0)
else (dataSetRow["CNT"]/dataSetRow["COUNT"]*100)</expression>
                            <property name="dataType">string</property>
                        </tabular-measure>
                        <tabular-measure name="delta" id="10112">
                            <property name="function">sum</property>
                            <expression name="measureExpression">dataSetRow["CNT"]-dataSetRow["COUNT"]</expression>
                            <property name="dataType">integer</property>
                        </tabular-measure>
                    </property>
                </tabular-measure-group>
            </property>
            <property name="dataSet">Data Set5</property>
        </tabular-cube>
    </cubes>
    <page-setup>
        <simple-master-page name="maximoLandscape" id="47" extends="MaximoSystemLibrary.maximoLandscape">
            <property name="type">a4</property>
            <property name="leftMargin">0.0625in</property>
            <property name="rightMargin">0.0625in</property>
            <overridden-values>
                <ref-entry baseId="304" name="NewGrid2" id="304"/>
                <ref-entry baseId="305" id="305"/>
                <ref-entry baseId="306" id="306"/>
                <ref-entry baseId="307" id="307"/>
                <ref-entry baseId="308" id="308"/>
                <ref-entry baseId="340" name="NewImage1" id="340">
                    <list-property name="visibility">
                        <structure>
                            <property name="format">all</property>
                            <expression name="valueExpr">true</expression>
                        </structure>
                    </list-property>
                </ref-entry>
                <ref-entry baseId="309" id="309"/>
                <ref-entry baseId="310" name="NewImage" id="310">
                    <list-property name="visibility">
                        <structure>
                            <property name="format">all</property>
                            <expression name="valueExpr">true</expression>
                        </structure>
                    </list-property>
                </ref-entry>
                <ref-entry baseId="322" name="NewGrid" id="322"/>
                <ref-entry baseId="323" id="323"/>
                <ref-entry baseId="324" id="324"/>
                <ref-entry baseId="325" id="325"/>
                <ref-entry baseId="326" id="326"/>
                <ref-entry baseId="328" name="NewText" id="328"/>
                <ref-entry baseId="327" id="327"/>
                <ref-entry baseId="329" name="NewGrid1" id="329"/>
                <ref-entry baseId="330" id="330"/>
                <ref-entry baseId="331" id="331"/>
                <ref-entry baseId="332" id="332"/>
                <ref-entry baseId="333" id="333"/>
                <ref-entry baseId="334" id="334"/>
                <ref-entry baseId="335" name="NewAutoText" id="335"/>
                <ref-entry baseId="336" id="336"/>
                <ref-entry baseId="337" name="NewText1" id="337"/>
                <ref-entry baseId="338" id="338"/>
                <ref-entry baseId="339" name="NewAutoText1" id="339"/>
            </overridden-values>
        </simple-master-page>
    </page-setup>
    <body>
        <data id="10181">
            <property name="fontSize">medium</property>
            <property name="fontWeight">bold</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">Column Binding</property>
                    <expression name="expression">if ( params["mroSite"] == 1 ) {

     "Загрузка ЕТБ-Э Октябрьской ЖД";

} else if ( params["mroSite"] == 24 ) {

     "Загрузка ЕТБ-Э Горьковской ЖД";

} else if ( params["mroSite"] == 61 ) {

     "Загрузка ЕТБ-Э Приволжской ЖД";

} else if ( params["mroSite"] == 10 ) {

     "Загрузка ЕТБ-Э Калининградской ЖД";

} else if ( params["mroSite"] == 17 ) {

     "Загрузка ЕТБ-Э Московской ЖД";

} else if ( params["mroSite"] == 28 ) {

     "Загрузка ЕТБ-Э Северной ЖД";

} else if ( params["mroSite"] == 51 ) {

     "Загрузка ЕТБ-Э Северо-Кавказской ЖД";

} else if ( params["mroSite"] == 58 ) {

     "Загрузка ЕТБ-Э Юго-Восточной ЖД";

} else if ( params["mroSite"] == 63 ) {

     "Загрузка ЕТБ-Э Куйбышевской ЖД";

} else if ( params["mroSite"] == 76 ) {

     "Загрузка ЕТБ-Э Свердловской ЖД";

} else if ( params["mroSite"] == 80 ) {

     "Загрузка ЕТБ-Э Южно-Уральской ЖД";

} else if ( params["mroSite"] == 83 ) {

     "Загрузка ЕТБ-Э Западно-Сибирской ЖД";

} else if ( params["mroSite"] == 88 ) {

     "Загрузка ЕТБ-Э Красноярской ЖД";

} else if ( params["mroSite"] == 92 ) {

     "Загрузка ЕТБ-Э Восточно-Сибирской ЖД";

} else if ( params["mroSite"] == 94 ) {

     "Загрузка ЕТБ-Э Забайкальской ЖД";

} else if ( params["mroSite"] == 96 ) {

     "Загрузка ЕТБ-Э Дальневосточной ЖД";

}</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <property name="resultSetColumn">Column Binding</property>
        </data>
        <extended-item extensionName="Crosstab" extensionVersion="2.3.0" id="10113">
            <property name="emptyCellValue">0</property>
            <property name="measures">
                <extended-item extensionName="MeasureView" id="10124">
                    <property name="measure">CNT</property>
                    <property name="detail">
                        <extended-item extensionName="AggregationCell" id="10125">
                            <property name="aggregationOnRow">Group1/Model</property>
                            <property name="aggregationOnColumn">Group2/Data Set4::2</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="10126">
                                    <property name="textAlign">center</property>
                                    <property name="resultSetColumn">CNT_Group1/Model_Group2/Data Set4::2</property>
                                </data>
                            </property>
                        </extended-item>
                    </property>
                    <property name="aggregations">
                        <extended-item extensionName="AggregationCell" id="10156">
                            <property name="aggregationOnRow">Group1/Model</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">medium</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="10157">
                                    <property name="textAlign">center</property>
                                    <property name="resultSetColumn">CNT_Group1/Model</property>
                                </data>
                            </property>
                        </extended-item>
                        <extended-item extensionName="AggregationCell" id="10158">
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="10159">
                                    <property name="textAlign">center</property>
                                    <property name="resultSetColumn">CNT</property>
                                </data>
                            </property>
                        </extended-item>
                        <extended-item extensionName="AggregationCell" id="10228">
                            <property name="aggregationOnColumn">Group/Data Set4::1</property>
                            <property name="content">
                                <data id="10229">
                                    <property name="resultSetColumn">CNT_Group/Data Set4::1</property>
                                </data>
                            </property>
                        </extended-item>
                        <extended-item extensionName="AggregationCell" id="10243">
                            <property name="aggregationOnColumn">Group2/Data Set4::2</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">medium</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="10244">
                                    <property name="resultSetColumn">CNT_Group2/Data Set4::2</property>
                                </data>
                            </property>
                        </extended-item>
                    </property>
                    <property name="header">
                        <extended-item extensionName="CrosstabCell" id="10127">
                            <property name="content">
                                <label id="10128">
                                    <property name="textAlign">center</property>
                                    <text-property name="text">ЕТБ</text-property>
                                </label>
                            </property>
                            <property name="fontWeight">bold</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                        </extended-item>
                    </property>
                </extended-item>
                <extended-item extensionName="MeasureView" id="10129">
                    <property name="measure">COUNT</property>
                    <property name="detail">
                        <extended-item extensionName="AggregationCell" id="10130">
                            <property name="aggregationOnRow">Group1/Model</property>
                            <property name="aggregationOnColumn">Group2/Data Set4::2</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="10131">
                                    <property name="textAlign">center</property>
                                    <property name="resultSetColumn">COUNT_Group1/Model_Group2/Data Set4::2</property>
                                </data>
                            </property>
                        </extended-item>
                    </property>
                    <property name="aggregations">
                        <extended-item extensionName="AggregationCell" id="10161">
                            <property name="aggregationOnRow">Group1/Model</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="10162">
                                    <property name="textAlign">center</property>
                                    <property name="resultSetColumn">COUNT_Group1/Model</property>
                                </data>
                            </property>
                        </extended-item>
                        <extended-item extensionName="AggregationCell" id="10163">
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="10164">
                                    <property name="textAlign">center</property>
                                    <property name="resultSetColumn">COUNT_1</property>
                                </data>
                            </property>
                        </extended-item>
                        <extended-item extensionName="AggregationCell" id="10230">
                            <property name="aggregationOnColumn">Group/Data Set4::1</property>
                            <property name="content">
                                <data id="10231">
                                    <property name="resultSetColumn">COUNT_Group/Data Set4::1_1</property>
                                </data>
                            </property>
                        </extended-item>
                        <extended-item extensionName="AggregationCell" id="10245">
                            <property name="aggregationOnColumn">Group2/Data Set4::2</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">medium</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="10246">
                                    <property name="resultSetColumn">COUNT_Group2/Data Set4::2</property>
                                </data>
                            </property>
                        </extended-item>
                    </property>
                    <property name="header">
                        <extended-item extensionName="CrosstabCell" id="10132">
                            <property name="content">
                                <label id="10133">
                                    <property name="textAlign">center</property>
                                    <text-property name="text">АСУЭ</text-property>
                                </label>
                            </property>
                            <property name="fontWeight">bold</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                        </extended-item>
                    </property>
                </extended-item>
                <extended-item extensionName="MeasureView" id="10134">
                    <property name="measure">%%</property>
                    <property name="detail">
                        <extended-item extensionName="AggregationCell" id="10135">
                            <property name="aggregationOnRow">Group1/Model</property>
                            <property name="aggregationOnColumn">Group2/Data Set4::2</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="10174">
                                    <property name="textAlign">center</property>
                                    <property name="resultSetColumn">%%_Group1/Model_Group2/Data Set4::2</property>
                                </data>
                            </property>
                        </extended-item>
                    </property>
                    <property name="aggregations">
                        <extended-item extensionName="AggregationCell" id="10165">
                            <property name="aggregationOnRow">Group1/Model</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="10258">
                                    <property name="resultSetColumn">Column Binding_6</property>
                                </data>
                            </property>
                        </extended-item>
                        <extended-item extensionName="AggregationCell" id="10167">
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="10259">
                                    <property name="resultSetColumn">Column Binding_7</property>
                                </data>
                            </property>
                        </extended-item>
                        <extended-item extensionName="AggregationCell" id="10232">
                            <property name="aggregationOnColumn">Group/Data Set4::1</property>
                            <property name="content">
                                <data id="10233">
                                    <property name="resultSetColumn">%%_Group/Data Set4::1</property>
                                </data>
                            </property>
                        </extended-item>
                        <extended-item extensionName="AggregationCell" id="10247">
                            <property name="aggregationOnColumn">Group2/Data Set4::2</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">medium</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="10256">
                                    <property name="resultSetColumn">Column Binding_5</property>
                                </data>
                            </property>
                        </extended-item>
                    </property>
                    <property name="header">
                        <extended-item extensionName="CrosstabCell" id="10137">
                            <property name="content">
                                <label id="10138">
                                    <property name="textAlign">center</property>
                                    <text-property name="text">%%</text-property>
                                </label>
                            </property>
                            <property name="fontWeight">bold</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                        </extended-item>
                    </property>
                </extended-item>
                <extended-item extensionName="MeasureView" id="10139">
                    <property name="measure">delta</property>
                    <property name="detail">
                        <extended-item extensionName="AggregationCell" id="10140">
                            <property name="aggregationOnRow">Group1/Model</property>
                            <property name="aggregationOnColumn">Group2/Data Set4::2</property>
                            <property name="backgroundColor">#91F38B</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <list-property name="highlightRules">
                                <structure>
                                    <property name="operator">not-in</property>
                                    <expression name="testExpr">data["delta_Group1/Model_Group/Data Set4::1"]</expression>
                                    <simple-property-list name="value1">
                                        <value>0</value>
                                        <value>null</value>
                                    </simple-property-list>
                                    <property name="backgroundColor">#F3F18B</property>
                                </structure>
                            </list-property>
                            <property name="content">
                                <data id="10141">
                                    <property name="textAlign">center</property>
                                    <property name="resultSetColumn">delta_Group1/Model_Group2/Data Set4::2</property>
                                </data>
                            </property>
                        </extended-item>
                    </property>
                    <property name="aggregations">
                        <extended-item extensionName="AggregationCell" id="10169">
                            <property name="aggregationOnRow">Group1/Model</property>
                            <property name="backgroundColor">#91F38B</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <list-property name="highlightRules">
                                <structure>
                                    <property name="operator">not-in</property>
                                    <expression name="testExpr">data["delta_Group1/Model"]</expression>
                                    <simple-property-list name="value1">
                                        <value>0</value>
                                        <value>null</value>
                                    </simple-property-list>
                                    <property name="backgroundColor">#F3F18B</property>
                                </structure>
                            </list-property>
                            <property name="content">
                                <data id="10170">
                                    <property name="textAlign">center</property>
                                    <property name="resultSetColumn">delta_Group1/Model_1</property>
                                </data>
                            </property>
                        </extended-item>
                        <extended-item extensionName="AggregationCell" id="10171">
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="10261">
                                    <property name="backgroundColor">#91F38B</property>
                                    <list-property name="highlightRules">
                                        <structure>
                                            <property name="operator">not-in</property>
                                            <property name="backgroundColor">#F3F18B</property>
                                            <expression name="testExpr">data["Aggregation"]</expression>
                                            <simple-property-list name="value1">
                                                <value>0</value>
                                                <value>null</value>
                                            </simple-property-list>
                                        </structure>
                                    </list-property>
                                    <property name="resultSetColumn">Aggregation</property>
                                </data>
                                <data id="10262">
                                    <property name="backgroundColor">#91F38B</property>
                                    <list-property name="highlightRules">
                                        <structure>
                                            <property name="operator">not-in</property>
                                            <property name="backgroundColor">#F3F18B</property>
                                            <expression name="testExpr">data["Column Binding_8"]</expression>
                                            <simple-property-list name="value1">
                                                <value>0</value>
                                                <value>null</value>
                                            </simple-property-list>
                                        </structure>
                                    </list-property>
                                    <property name="resultSetColumn">Column Binding_8</property>
                                </data>
                            </property>
                        </extended-item>
                        <extended-item extensionName="AggregationCell" id="10234">
                            <property name="aggregationOnColumn">Group/Data Set4::1</property>
                            <property name="content">
                                <data id="10235">
                                    <property name="resultSetColumn">delta_Group/Data Set4::1_1</property>
                                </data>
                            </property>
                        </extended-item>
                        <extended-item extensionName="AggregationCell" id="10249">
                            <property name="aggregationOnColumn">Group2/Data Set4::2</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">medium</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="10250">
                                    <property name="backgroundColor">#91F38B</property>
                                    <list-property name="highlightRules">
                                        <structure>
                                            <property name="operator">not-in</property>
                                            <property name="backgroundColor">#F3F18B</property>
                                            <expression name="testExpr">data["delta_Group2/Data Set4::2"]</expression>
                                            <simple-property-list name="value1">
                                                <value>0</value>
                                                <value>null</value>
                                            </simple-property-list>
                                        </structure>
                                    </list-property>
                                    <property name="resultSetColumn">delta_Group2/Data Set4::2</property>
                                </data>
                                <data id="10257">
                                    <property name="backgroundColor">#91F38B</property>
                                    <list-property name="highlightRules">
                                        <structure>
                                            <property name="operator">not-in</property>
                                            <property name="backgroundColor">#F3F18B</property>
                                            <expression name="testExpr">data["Column Binding_4"]</expression>
                                            <simple-property-list name="value1">
                                                <value>0</value>
                                                <value>null</value>
                                            </simple-property-list>
                                        </structure>
                                    </list-property>
                                    <property name="resultSetColumn">Column Binding_4</property>
                                </data>
                            </property>
                        </extended-item>
                    </property>
                    <property name="header">
                        <extended-item extensionName="CrosstabCell" id="10142">
                            <property name="content">
                                <label id="10143">
                                    <property name="textAlign">center</property>
                                    <text-property name="text">Δ</text-property>
                                </label>
                            </property>
                            <property name="fontWeight">bold</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                        </extended-item>
                    </property>
                </extended-item>
            </property>
            <property name="rows">
                <extended-item extensionName="CrosstabView" id="10115">
                    <property name="grandTotal">
                        <extended-item extensionName="CrosstabCell" id="10145">
                            <property name="content">
                                <label id="10154">
                                    <property name="textAlign">center</property>
                                    <text-property name="text">Итого (лишних)</text-property>
                                </label>
                                <label id="10263">
                                    <property name="textAlign">center</property>
                                    <text-property name="text">Итого (незагруженных)</text-property>
                                </label>
                            </property>
                            <property name="fontWeight">bold</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">medium</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                        </extended-item>
                    </property>
                    <property name="views">
                        <extended-item extensionName="DimensionView" id="10120">
                            <property name="dimension">Group1</property>
                            <property name="levels">
                                <extended-item extensionName="LevelView" name="NewLevel View1" id="10121">
                                    <property name="level">Group1/Model</property>
                                    <property name="member">
                                        <extended-item extensionName="CrosstabCell" id="10122">
                                            <property name="content">
                                                <data name="Model" id="10123">
                                                    <property name="textAlign">center</property>
                                                    <property name="resultSetColumn">Model</property>
                                                </data>
                                            </property>
                                            <property name="fontWeight">bold</property>
                                            <property name="textAlign">left</property>
                                            <property name="borderTopStyle">solid</property>
                                            <property name="borderTopWidth">thin</property>
                                            <property name="borderTopColor">#000000</property>
                                            <property name="borderLeftStyle">solid</property>
                                            <property name="borderLeftWidth">thin</property>
                                            <property name="borderLeftColor">#000000</property>
                                            <property name="borderBottomStyle">solid</property>
                                            <property name="borderBottomWidth">thin</property>
                                            <property name="borderBottomColor">#000000</property>
                                            <property name="borderRightStyle">solid</property>
                                            <property name="borderRightWidth">thin</property>
                                            <property name="borderRightColor">#000000</property>
                                        </extended-item>
                                    </property>
                                </extended-item>
                            </property>
                        </extended-item>
                    </property>
                </extended-item>
            </property>
            <property name="columns">
                <extended-item extensionName="CrosstabView" id="10144">
                    <property name="grandTotal">
                        <extended-item extensionName="CrosstabCell" id="10155">
                            <property name="content">
                                <label id="10160">
                                    <property name="fontWeight">bold</property>
                                    <property name="textAlign">center</property>
                                    <text-property name="text">Итого</text-property>
                                </label>
                            </property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                        </extended-item>
                    </property>
                    <property name="views">
                        <extended-item extensionName="DimensionView" id="10116">
                            <property name="dimension">Group</property>
                            <property name="levels">
                                <extended-item extensionName="LevelView" name="NewLevel View" id="10117">
                                    <property name="level">Group/Data Set4::1</property>
                                    <property name="member">
                                        <extended-item extensionName="CrosstabCell" id="10118">
                                            <property name="content">
                                                <data name="Data Set4::1" id="10119">
                                                    <property name="resultSetColumn">Data Set4::1</property>
                                                </data>
                                            </property>
                                            <property name="fontWeight">bold</property>
                                            <property name="textAlign">center</property>
                                            <property name="borderTopStyle">solid</property>
                                            <property name="borderTopWidth">thin</property>
                                            <property name="borderTopColor">#000000</property>
                                            <property name="borderLeftStyle">solid</property>
                                            <property name="borderLeftWidth">thin</property>
                                            <property name="borderLeftColor">#000000</property>
                                            <property name="borderBottomStyle">solid</property>
                                            <property name="borderBottomWidth">thin</property>
                                            <property name="borderBottomColor">#000000</property>
                                            <property name="borderRightStyle">solid</property>
                                            <property name="borderRightWidth">thin</property>
                                            <property name="borderRightColor">#000000</property>
                                        </extended-item>
                                    </property>
                                </extended-item>
                            </property>
                        </extended-item>
                        <extended-item extensionName="DimensionView" id="10239">
                            <property name="dimension">Group2</property>
                            <property name="levels">
                                <extended-item extensionName="LevelView" name="NewLevel View2" id="10240">
                                    <property name="level">Group2/Data Set4::2</property>
                                    <property name="member">
                                        <extended-item extensionName="CrosstabCell" id="10241">
                                            <property name="content">
                                                <data name="Data Set4::2" id="10242">
                                                    <list-property name="visibility">
                                                        <structure>
                                                            <property name="format">all</property>
                                                            <expression name="valueExpr">true</expression>
                                                        </structure>
                                                    </list-property>
                                                    <property name="resultSetColumn">Data Set4::2</property>
                                                </data>
                                                <label id="10254">
                                                    <property name="textAlign">center</property>
                                                    <text-property name="text">ЭЧС</text-property>
                                                    <structure name="action">
                                                        <property name="linkType">drill-through</property>
                                                        <property name="reportName">asue-etb-echs.rptdesign</property>
                                                        <property name="targetWindow">_blank</property>
                                                        <property name="targetFileType">report-design</property>
                                                        <list-property name="paramBindings">
                                                            <structure>
                                                                <property name="paramName">where</property>
                                                                <expression name="expression">"1=1"</expression>
                                                            </structure>
                                                            <structure>
                                                                <property name="paramName">appname</property>
                                                                <expression name="expression">"ASSET_E"</expression>
                                                            </structure>
                                                            <structure>
                                                                <property name="paramName">mroSite</property>
                                                                <expression name="expression">params["mroSite"].value</expression>
                                                            </structure>
                                                            <structure>
                                                                <property name="paramName">ech</property>
                                                                <expression name="expression">parseInt(data["Data Set4::2"])</expression>
                                                            </structure>
                                                        </list-property>
                                                    </structure>
                                                </label>
                                                <label id="10253">
                                                    <property name="textAlign">center</property>
                                                    <text-property name="text">ЭЧК</text-property>
                                                    <structure name="action">
                                                        <property name="linkType">drill-through</property>
                                                        <property name="reportName">asue-etb-echk.rptdesign</property>
                                                        <property name="targetWindow">_blank</property>
                                                        <property name="targetFileType">report-design</property>
                                                        <list-property name="paramBindings">
                                                            <structure>
                                                                <property name="paramName">appname</property>
                                                                <expression name="expression">"ASSET_E"</expression>
                                                            </structure>
                                                            <structure>
                                                                <property name="paramName">where</property>
                                                                <expression name="expression">"1=1"</expression>
                                                            </structure>
                                                            <structure>
                                                                <property name="paramName">mroSite</property>
                                                                <expression name="expression">params["mroSite"].value</expression>
                                                            </structure>
                                                            <structure>
                                                                <property name="paramName">ech</property>
                                                                <expression name="expression">parseInt(data["Data Set4::2"])</expression>
                                                            </structure>
                                                        </list-property>
                                                    </structure>
                                                </label>
                                                <label id="10255">
                                                    <property name="textAlign">center</property>
                                                    <text-property name="text">ЭЧЭ</text-property>
                                                    <structure name="action">
                                                        <property name="linkType">drill-through</property>
                                                        <property name="reportName">asue-etb-eche.rptdesign</property>
                                                        <property name="targetWindow">_blank</property>
                                                        <property name="targetFileType">report-design</property>
                                                        <list-property name="paramBindings">
                                                            <structure>
                                                                <property name="paramName">mroSite</property>
                                                                <expression name="expression">params["mroSite"].value</expression>
                                                            </structure>
                                                            <structure>
                                                                <property name="paramName">ech</property>
                                                                <expression name="expression">parseInt(data["Data Set4::2"])</expression>
                                                            </structure>
                                                            <structure>
                                                                <property name="paramName">where</property>
                                                                <expression name="expression">"1=1"</expression>
                                                            </structure>
                                                            <structure>
                                                                <property name="paramName">appname</property>
                                                                <expression name="expression">"ASSET_E"</expression>
                                                            </structure>
                                                        </list-property>
                                                    </structure>
                                                </label>
                                            </property>
                                            <property name="borderTopStyle">solid</property>
                                            <property name="borderTopWidth">thin</property>
                                            <property name="borderTopColor">#000000</property>
                                            <property name="borderLeftStyle">solid</property>
                                            <property name="borderLeftWidth">thin</property>
                                            <property name="borderLeftColor">#000000</property>
                                            <property name="borderBottomStyle">solid</property>
                                            <property name="borderBottomWidth">thin</property>
                                            <property name="borderBottomColor">#000000</property>
                                            <property name="borderRightStyle">solid</property>
                                            <property name="borderRightWidth">thin</property>
                                            <property name="borderRightColor">#000000</property>
                                        </extended-item>
                                    </property>
                                </extended-item>
                            </property>
                        </extended-item>
                    </property>
                </extended-item>
            </property>
            <property name="header">
                <extended-item extensionName="CrosstabCell" id="10114">
                    <property name="borderTopStyle">solid</property>
                    <property name="borderTopWidth">thin</property>
                    <property name="borderTopColor">#000000</property>
                    <property name="borderLeftStyle">solid</property>
                    <property name="borderLeftWidth">thin</property>
                    <property name="borderLeftColor">#000000</property>
                    <property name="borderBottomStyle">solid</property>
                    <property name="borderBottomWidth">thin</property>
                    <property name="borderBottomColor">#000000</property>
                    <property name="borderRightStyle">solid</property>
                    <property name="borderRightWidth">thin</property>
                    <property name="borderRightColor">#000000</property>
                </extended-item>
            </property>
            <property name="cube">Data Cube</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">Data Set4::1</property>
                    <expression name="expression">dimension["Group"]["Data Set4::1"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Model</property>
                    <expression name="expression">dimension["Group1"]["Model"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">CNT_Group1/Model</property>
                    <expression name="expression">measure["CNT"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">COUNT_Group1/Model</property>
                    <expression name="expression">measure["COUNT"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">%%_Group1/Model</property>
                    <expression name="expression">measure["%%"]</expression>
                    <property name="dataType">float</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">delta_Group1/Model</property>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">measure["delta"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">CNT_Group1/Model_Group/Data Set4::1</property>
                    <expression name="expression">measure["CNT"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                        <value>Group/Data Set4::1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">COUNT_Group1/Model_Group/Data Set4::1</property>
                    <expression name="expression">measure["COUNT"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                        <value>Group/Data Set4::1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">%%_Group1/Model_Group/Data Set4::1</property>
                    <expression name="expression">measure["%%"]</expression>
                    <property name="dataType">float</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                        <value>Group/Data Set4::1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">delta_Group1/Model_Group/Data Set4::1</property>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                        <value>Group/Data Set4::1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">measure["delta"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">CNT_Group/Data Set4::1</property>
                    <expression name="expression">measure["CNT"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group/Data Set4::1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">COUNT_Group/Data Set4::1</property>
                    <expression name="expression">measure["COUNT"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group/Data Set4::1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">%%_Group/Data Set4::1</property>
                    <expression name="expression">measure["%%"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group/Data Set4::1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">delta_Group/Data Set4::1</property>
                    <expression name="expression">measure["delta"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group/Data Set4::1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">CNT</property>
                    <property name="dataType">integer</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">measure["CNT"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">COUNT</property>
                    <property name="dataType">integer</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">measure["COUNT"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">%%</property>
                    <expression name="expression">measure["%%"]</expression>
                    <property name="dataType">integer</property>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">delta</property>
                    <property name="dataType">integer</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">measure["delta"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">Column Binding</property>
                    <expression name="expression">if (data["COUNT_Group1/Model_Group/Data Set4::1"] == 0) (0)
else (data["CNT_Group1/Model_Group/Data Set4::1"]/data["COUNT_Group1/Model_Group/Data Set4::1"]*100)</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">Column Binding_1</property>
                    <expression name="expression">if (data["COUNT_Group/Data Set4::1"] == 0) (0)
else (data["CNT_Group/Data Set4::1"]/data["COUNT_Group/Data Set4::1"]*100)</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">Column Binding_2</property>
                    <expression name="expression">if (data["COUNT_Group1/Model"] == 0) (0)
else (data["CNT_Group1/Model"]/data["COUNT_Group1/Model"]*100)</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">Column Binding_3</property>
                    <expression name="expression">data["CNT"]/data["COUNT"]*100</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">deltaplus</property>
                    <property name="displayName">deilaplus</property>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group/Data Set4::1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">measure["delta"]</expression>
                        </structure>
                    </list-property>
                    <expression name="filterExpr">if (measure["delta"] > 0 ) {measure["delta"]}</expression>
                </structure>
                <structure>
                    <property name="name">deltaminus</property>
                    <property name="displayName">deilaminus</property>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group/Data Set4::1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">measure["delta"]</expression>
                        </structure>
                    </list-property>
                    <expression name="filterExpr">if (measure["delta"] &lt; 0 ) {measure["delta"]}</expression>
                </structure>
                <structure>
                    <property name="name">ideltaminus</property>
                    <property name="displayName">deltaminus</property>
                    <property name="dataType">integer</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">measure["delta"]</expression>
                        </structure>
                    </list-property>
                    <expression name="filterExpr">if (measure["delta"] &lt; 0 ) {measure["delta"]}</expression>
                </structure>
                <structure>
                    <property name="name">ideltaplus</property>
                    <property name="displayName">deltaplus</property>
                    <property name="dataType">integer</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">measure["delta"]</expression>
                        </structure>
                    </list-property>
                    <expression name="filterExpr">if ( measure["delta"] >0 ) {measure["delta"]}</expression>
                </structure>
                <structure>
                    <property name="name">COUNT_Group/Data Set4::1_1</property>
                    <expression name="expression">measure["COUNT"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group/Data Set4::1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                </structure>
                <structure>
                    <property name="name">delta_Group/Data Set4::1_1</property>
                    <expression name="expression">measure["delta"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group/Data Set4::1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                </structure>
                <structure>
                    <property name="name">delta_Group1/Model_Group/Data Set4::1_1</property>
                    <expression name="expression">measure["delta"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                        <value>Group/Data Set4::1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                </structure>
                <structure>
                    <property name="name">Data Set4::2</property>
                    <expression name="expression">dimension["Group2"]["Data Set4::2"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">delta_Group1/Model_1</property>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">measure["delta"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">COUNT_1</property>
                    <expression name="expression">measure["COUNT"]</expression>
                    <property name="dataType">integer</property>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">delta_1</property>
                    <expression name="expression">measure["delta"]</expression>
                    <property name="dataType">integer</property>
                    <property name="aggregateFunction">SUM</property>
                </structure>
                <structure>
                    <property name="name">CNT_Group2/Data Set4::2</property>
                    <expression name="expression">measure["CNT"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group2/Data Set4::2</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">COUNT_Group2/Data Set4::2</property>
                    <expression name="expression">measure["COUNT"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group2/Data Set4::2</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">%%_Group2/Data Set4::2</property>
                    <expression name="expression">measure["%%"]</expression>
                    <property name="dataType">string</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group2/Data Set4::2</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">delta_Group2/Data Set4::2</property>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group2/Data Set4::2</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">measure["delta"]</expression>
                        </structure>
                    </list-property>
                    <expression name="filterExpr">if (measure["delta"] >= 0 ) {measure["delta"]}</expression>
                </structure>
                <structure>
                    <property name="name">CNT_Group1/Model_Group2/Data Set4::2</property>
                    <expression name="expression">measure["CNT"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                        <value>Group2/Data Set4::2</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">COUNT_Group1/Model_Group2/Data Set4::2</property>
                    <expression name="expression">measure["COUNT"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                        <value>Group2/Data Set4::2</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">%%_Group1/Model_Group2/Data Set4::2</property>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                        <value>Group2/Data Set4::2</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">measure["%%"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">delta_Group1/Model_Group2/Data Set4::2</property>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                        <value>Group2/Data Set4::2</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">measure["delta"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">Column Binding_4</property>
                    <expression name="expression">data["CNT_Group2/Data Set4::2"]-data["delta_Group2/Data Set4::2"]-data["COUNT_Group2/Data Set4::2"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">Column Binding_5</property>
                    <expression name="expression">if (data["COUNT_Group2/Data Set4::2"] == 0) (0)
else ((data["CNT_Group2/Data Set4::2"]-data["delta_Group2/Data Set4::2"])/data["COUNT_Group2/Data Set4::2"]*100)</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">Column Binding_6</property>
                    <expression name="expression">if (data["COUNT_Group1/Model"] == 0) (0)
else (data["CNT_Group1/Model"]/data["COUNT_Group1/Model"]*100)</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">Column Binding_7</property>
                    <expression name="expression">if (data["COUNT"] == 0) (0)
else ((data["CNT"]-data["Aggregation"])/data["COUNT"]*100)</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">Aggregation</property>
                    <property name="dataType">integer</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">measure["delta"]</expression>
                        </structure>
                    </list-property>
                    <expression name="filterExpr">if (measure["delta"] > 0 ) {measure["delta"]}</expression>
                </structure>
                <structure>
                    <property name="name">Column Binding_8</property>
                    <expression name="expression">data["CNT"]-data["Aggregation"]-data["COUNT"]</expression>
                    <property name="dataType">integer</property>
                </structure>
            </list-property>
        </extended-item>
    </body>
</report>