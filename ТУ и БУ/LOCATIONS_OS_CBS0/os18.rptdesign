<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.17" id="1">
    <property name="createdBy">Eclipse BIRT Designer Version 2.3.2.r232_20090202 Build &lt;2.3.2.v20090218-0730></property>
    <property name="units">in</property>
    <property name="comments">IBM Confidential

OCO Source Materials

5724-M19

(C) COPYRIGHT IBM CORP. 2006

The source code for this program is not published or otherwise
divested of its trade secrets, irrespective of what has been
deposited with the U.S. Copyright Office.</property>
    <html-property name="description">This template will create a report with one or more groups, each having identical data fields, and contains three styles of charts.</html-property>
    <method name="initialize"><![CDATA[importPackage(Packages.com.ibm.tivoli.maximo.report.script);

mxReportScriptContext = MXReportScriptContext.initialize(reportContext);


mxReportScriptContext = MXReportScriptContext.initialize(reportContext);
mxReportScriptContext.setDefaultLogLevel("DEBUG");
mxReportScriptContext.setDefaultLogFile("c:/temp/tetttt.txt");
]]></method>
    <method name="afterFactory"><![CDATA[MXReportScriptContext.close();]]></method>
    <property name="theme">MaximoSystemLibrary.maximoTheme</property>
    <text-property name="displayName">Tivoli Maximo Grouped Chart Template</text-property>
    <list-property name="libraries">
        <structure>
            <property name="fileName">MaximoSystemLibrary.rptlibrary</property>
            <property name="namespace">MaximoSystemLibrary</property>
        </structure>
    </list-property>
    <parameters>
        <scalar-parameter name="where" id="25">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <property name="defaultValue">1=1</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="appname" id="240">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="paramdelimiter" id="241">
            <property name="hidden">true</property>
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="paramstring" id="242">
            <property name="hidden">true</property>
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="mroSite" id="12753">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="hoz" id="12754">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <script-data-source name="maximoDataSource" id="64" extends="MaximoSystemLibrary.maximoDataSource"/>
    </data-sources>
    <data-sets>
        <script-data-set name="1" id="1085">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">LOCATION</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">DESCRIPTION</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">SOP</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">UIO</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">NOINV</property>
                    <property name="dataType">integer</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">SL</property>
                </structure>
                <structure>
                    <property name="columnName">ALLASSET</property>
                </structure>
                <structure>
                    <property name="columnName">NOM</property>
                </structure>
                <structure>
                    <property name="columnName">NEBAL</property>
                </structure>
                <structure>
                    <property name="columnName">NOSET</property>
                </structure>
                <structure>
                    <property name="columnName">EXTSYSTEMID</property>
                </structure>
                <structure>
                    <property name="columnName">SOP</property>
                </structure>
                <structure>
                    <property name="columnName">ALLASSET1</property>
                </structure>
                <structure>
                    <property name="columnName">NESOP1</property>
                </structure>
                <structure>
                    <property name="columnName">SOP1</property>
                </structure>
                <structure>
                    <property name="columnName">NEYCH</property>
                </structure>
                <structure>
                    <property name="columnName">LOCATION</property>
                </structure>
                <structure>
                    <property name="columnName">DESCRIPTION</property>
                </structure>
                <structure>
                    <property name="columnName">UIO</property>
                </structure>
                <structure>
                    <property name="columnName">NOINV</property>
                </structure>
                <structure>
                    <property name="columnName">NOM1</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">LOCATION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">SOP</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">UIO</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">NOINV</property>
                        <property name="dataType">integer</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[maximoDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());
maximoDataSet.open();



 
var sqlText = new String();




if (params["hoz"].value == 2)

{sqlText =  ""
  +" WITH PRED_LIST AS "
 +"      ( SELECT   locations.location , "
 +"                locations.siteid    , "
 +"                locations.description "
 +"      FROM      MAXIMO.LOCATIONSPEC "
 +"                LEFT JOIN MAXIMO.LOCATIONS "
 +"                ON        locations.location  = locationspec.location "
 +"                AND       locations.siteid    = locationspec.siteid "
 +"                AND       LOCATIONS.STATUS    = 'РАБОТАЕТ' "
 +"      WHERE     locationspec.classstructureid = '090000000003' "
 +"      AND       LOCATIONSPEC.ASSETATTRID      = 'TIP_PREDPR' "
 +"      AND       locationspec.numvalue         = 3 "
 +"      AND       locationspec.siteid           = '" + params["mroSite"] + "' "
 +"      AND       locations.extsystemid         = 1 "
 +"      ) "
 +" SELECT ass.description           , "
 +"        ass.location              , "
 +"        COUNT(ASSET.ASSETNUM) SOP , "
 +"        COUNT( "
 +"        CASE "
 +"               WHEN asset.inv_nom IS NULL "
 +"               THEN 1 "
 +"        END) noinv , "
 +"        COUNT( "
 +"        CASE "
 +"               WHEN EXISTS "
 +"                      ( SELECT 1 "
 +"                      FROM    MAXIMO.FIXEDASSET "
 +"                      WHERE   FIXEDASSET.FIXEDASSETID = asset.FIXEDASSETID "
 +"                      AND     fixedasset.UIO1        != asset.UIO1 "
 +"                      ) "
 +"               THEN assetnum "
 +"        END) uio "
 +" FROM   MAXIMO.ASSET "
 +"        JOIN "
 +"               ( SELECT pl.description , "
 +"                       pl.location     , "
 +"                       column_value "
 +"               FROM    pred_list pl "
 +"                       JOIN TABLE (MAXIMO.pred_podr_assets(pl.LOCATION, pl.siteid, 'ПУТЬП')) "
 +"                       ON      1 = 1 "
 +"                "
 +"               UNION ALL "
 +"                "
 +"               SELECT pl.description , "
 +"                      pl.location    , "
 +"                      column_value "
 +"               FROM   pred_list pl "
 +"                      JOIN TABLE (MAXIMO.pred_podr_assets(pl.LOCATION, pl.siteid, 'СТП')) "
 +"                      ON     1 = 1 "
 +"                "
 +"               UNION ALL "
 +"                "
 +"               SELECT pl.description , "
 +"                      pl.location    , "
 +"                      column_value "
 +"               FROM   pred_list pl "
 +"                      JOIN TABLE (MAXIMO.pred_podr_assets(pl.LOCATION, pl.siteid, 'СТАНПУТЬ')) "
 +"                      ON     1 = 1 "
 +"                "
 +"               UNION ALL "
 +"                "
 +"               SELECT pl.description , "
 +"                      pl.location    , "
 +"                      column_value "
 +"               FROM   pred_list pl "
 +"                      JOIN TABLE (MAXIMO.pred_podr_assets(pl.LOCATION, pl.siteid, 'ПЕРЕЕЗД')) "
 +"                      ON     1 = 1 "
 +"                "
 +"               UNION ALL "
 +"                "
 +"               SELECT pl.description , "
 +"                      pl.location    , "
 +"                      column_value "
 +"               FROM   pred_list pl "
 +"                      JOIN TABLE (MAXIMO.pred_podr_assets(pl.LOCATION, pl.siteid, 'ГППС')) "
 +"                      ON     1 = 1 "
 +"                "
 +"               UNION ALL "
 +"                "
 +"               SELECT pl.description , "
 +"                      pl.location    , "
 +"                      column_value "
 +"               FROM   pred_list pl "
 +"                      JOIN TABLE (MAXIMO.pred_podr_assets(pl.LOCATION, pl.siteid, 'СООР_ЗП')) "
 +"                      ON     1 = 1 "
 +"                "
 +"               UNION ALL "
 +"                "
 +"               SELECT pl.description , "
 +"                      pl.location    , "
 +"                      column_value "
 +"               FROM   pred_list pl "
 +"                      JOIN TABLE (MAXIMO.pred_podr_assets(pl.LOCATION, pl.siteid, 'ИССО')) "
 +"                      ON     1 = 1 "
 +"                "
 +"               UNION ALL "
 +"                "
 +"               SELECT pl.description , "
 +"                      pl.location    , "
 +"                      column_value "
 +"               FROM   pred_list pl "
 +"                      JOIN TABLE (MAXIMO.pred_podr_assets(pl.LOCATION, pl.siteid, 'ГЛПУТЬ')) "
 +"                      ON     1 = 1 "
 +"               ) "
 +"               ASS "
 +"        ON     ASS.column_value = ASSET.ASSETNUM "
 +" WHERE  EXTSYSTEMID = 2 "
 +" AND    ORGID       = 'РЖД' "
 +" AND    STATUS IN ('РАБОТАЕТ'       , "
 +"                   'ЭКСПЛУАТИРУЕТСЯ', "
 +"                   'ОЖИДАЕТ РЕШЕНИЯ') "
 +" AND    SITEID = '" + params["mroSite"] + "' "
 +" AND    EXISTS "
 +"        ( SELECT 1 "
 +"        FROM    MAXIMO.FIXEDASSET "
 +"        WHERE   FIXEDASSET.FIXEDASSETID = ASSET.FIXEDASSETID "
 +"        ) "
 +" AND "
 +"        ( "
 +"               EXISTS "
 +"               (SELECT 1 "
 +"               FROM    maximo.UIOCLASSSTRUCTURE "
 +"               WHERE   UIOCLASSSTRUCTURE.CLASSSTRUCTUREID = asset.CLASSSTRUCTUREID "
 +"               ) "
 +"        OR "
 +"               ( "
 +"                      EXISTS "
 +"                      (SELECT 1 "
 +"                      FROM    MAXIMO.FIXEDASSET "
 +"                      WHERE   FIXEDASSET.FIXEDASSETID = asset.FIXEDASSETID "
 +"                      ) "
 +"               AND    NOT EXISTS "
 +"                      (SELECT 1 "
 +"                      FROM    maximo.UIOCLASSSTRUCTURE "
 +"                      WHERE   UIOCLASSSTRUCTURE.CLASSSTRUCTUREID = asset.CLASSSTRUCTUREID "
 +"                      ) "
 +"               ) "
 +"        ) "
 +" GROUP BY ass.description, "
 +"          ass.location "

  
  }
  
  
 
 
else if (params["hoz"].value == 3)

{
sqlText =  ""
  +" WITH LOCLIST AS "
 +"      ( SELECT DISTINCT LA.LOCATION                               LOCATION , "
 +"                                        CONNECT_BY_ROOT la.parent PODR "
 +"                       FROM             MAXIMO.LOCHIERARCHY LA START WITH LA.PARENT IN "
 +"                                        ( SELECT LOCATIONS.LOCATION "
 +"                                        FROM    maximo.locations "
 +"                                                JOIN maximo.locationspec "
 +"                                                ON      locations.location       = locationspec.location "
 +"                                                AND     locations.siteid         = locationspec.siteid "
 +"                                                AND     locationspec.assetattrid = 'TIP_PREDPR' "
 +"                                                AND     numvalue                 = 4 "
 +"                                        WHERE   locations.siteid                 = '" + params["mroSite"] + "' "
 +"                                        AND     locations.STATUS                 = 'РАБОТАЕТ' "
 +"                                        ) "
 +"                       AND              LA.SITEID   = '" + params["mroSite"] + "' "
 +"                       AND              LA.SYSTEMID = 'СЭ' "
 +"                       AND              'РАБОТАЕТ'  = "
 +"                                        ( SELECT STATUS "
 +"                                        FROM    maximo.locations "
 +"                                        WHERE   location = la.location "
 +"                                        AND     siteid   = la.siteid "
 +"                                        ) "
 +"                       AND              SUBSTR(LA.LOCATION,0,3) IN ('ECH','RRU')  "
 +"                       CONNECT BY NOCYCLE PRIOR LA.LOCATION = LA.PARENT "
 +"                       AND              PRIOR LA.SITEID     = LA.SITEID "
 +"                       AND              PRIOR LA.SYSTEMID   = LA.SYSTEMID "
 +"                       AND              'РАБОТАЕТ'          = "
 +"                                        ( SELECT STATUS "
 +"                                        FROM    maximo.locations "
 +"                                        WHERE   location = la.location "
 +"                                        AND     siteid   = la.siteid "
 +"                                        ) "
 +"                       AND "
 +"                                        ( "
 +"                                                         SUBSTR(LA.LOCATION,0,3) = 'ECH' "
 +"                                        OR               SUBSTR(LA.LOCATION,0,2) IN ('LO', 'RU') "
 +"                                        OR               SUBSTR(LA.LOCATION,0,7) = 'JOINING' "
 +"                                        ) "
 +"      ) "
 +"      , "
 +"      list AS "
 +"      ( SELECT ASSETNUM    , "
 +"              inv_nom      , "
 +"              set_nom      , "
 +"              FIXEDASSETID , "
 +"              UIO1         , "
 +"              CLASSSTRUCTUREID, "
 +"              parent, "
 +"              CONNECT_BY_ROOT LOCATION LOCATION "
 +"      FROM    MAXIMO.ASSET START WITH PARENT IS NULL "
 +"      AND     EXTSYSTEMID                          = '3' "
 +"      AND     STATUS                               = 'РАБОТАЕТ' "
 +"      AND     SITEID                               = '" + params["mroSite"] + "' "
 +"      AND     LOCATION IN "
 +"              ( SELECT LOCATION "
 +"              FROM    LOCLIST "
 +"              ) "
 +"              CONNECT BY NOCYCLE PRIOR ASSETNUM = PARENT "
 +"      AND     PRIOR SITEID                      = SITEID "
 +"      AND     PRIOR EXTSYSTEMID                 = EXTSYSTEMID "
 +"      AND     PRIOR STATUS                      = STATUS "
 +"      ) "
 +" SELECT   PREDS.DESCRIPTION   , "
 +"          PREDS.LOCATION      , "
 +"          COUNT(ASSETNUM) SOP , "
 +"          COUNT( "
 +"          CASE "
 +"                   WHEN list.inv_nom IS NULL "
 +"                   THEN 1 "
 +"          END) noinv , "
 +"          COUNT( "
 +"          CASE "
 +"                   WHEN EXISTS "
 +"                            ( SELECT 1 "
 +"                            FROM    MAXIMO.FIXEDASSET "
 +"                            WHERE   FIXEDASSET.FIXEDASSETID = list.FIXEDASSETID "
 +"                            AND     fixedasset.UIO1        != list.UIO1 "
 +"                            ) "
 +"                   THEN assetnum "
 +"          END) uio "
 +" FROM     list "
 +"          JOIN LOCLIST "
 +"          ON       list.location = LOCLIST.location "
 +"          JOIN MAXIMO.PREDS "
 +"          ON       LOCLIST.PODR = PREDS.location "
 +" WHERE    EXISTS "
 +"          ( SELECT 1 "
 +"          FROM    MAXIMO.FIXEDASSET "
 +"          WHERE   FIXEDASSET.FIXEDASSETID = list.FIXEDASSETID "
 +"          ) "
 +" AND "
 +"          ( "
 +"                   EXISTS "
 +"                   ( SELECT 1 "
 +"                   FROM    maximo.UIOCLASSSTRUCTURE "
 +"                   WHERE   UIOCLASSSTRUCTURE.CLASSSTRUCTUREID = list.CLASSSTRUCTUREID "
 +"                   ) "
 +"          OR "
 +"                   ( "
 +"                            NOT EXISTS "
 +"                            ( SELECT 1 "
 +"                            FROM    maximo.UIOCLASSSTRUCTURE "
 +"                            WHERE   UIOCLASSSTRUCTURE.CLASSSTRUCTUREID = list.CLASSSTRUCTUREID "
 +"                            ) "
 +"                   AND      EXISTS "
 +"                            ( SELECT 1 "
 +"                            FROM    maximo.asset ast "
 +"                            WHERE   ast.assetnum = list.parent "
 +"                            AND     ast.set_nom  = list.set_nom "
 +"                            ) "
 +"                   ) "
 +"          ) "
 +" GROUP BY PREDS.LOCATION , "
 +"          PREDS.DESCRIPTION "
 }

 else if (params["hoz"].value == 4)

{sqlText =  "" 
  +" WITH loclist AS "
 +"      ( SELECT location, "
 +"              CONNECT_BY_ROOT parent PRED "
 +"      FROM    maximo.lochierarchy "
 +"      WHERE   SUBSTR(location,1,3) IN ('PRZ','OBJ','ISS')  "
 +"               START WITH parent IN "
 +"              (SELECT PREDS.location "
 +"              FROM    MAXIMO.PREDS "
 +"                      JOIN MAXIMO.LOCATIONSPEC "
 +"                      ON      preds.location = locationspec.location "
 +"                      AND     preds.siteid   = locationspec.siteid "
 +"                      AND     assetattrid    = 'TIP_PREDPR' "
 +"                      AND     numvalue       = 5 "
 +"              ) "
 +"      AND     siteid        ='" + params["mroSite"] + "' "
 +"      AND     systemid      ='Ш'  "
 +"      CONNECT BY nocycle prior location = parent "
 +"      AND     prior siteid  = siteid "
 +"      AND     prior systemid=systemid "
 +"      ) "
 +"      , "
 +"      LIST AS "
 +"      ( SELECT ASSETNUM   , "
 +"              inv_nom     , "
 +"              set_nom     , "
 +"              uio1        , "
 +"              FIXEDASSETID, "
 +"              CLASSSTRUCTUREID, "
 +"              parent, "
 +"              ASSET.LOCATION "
 +"      FROM    MAXIMO.ASSET "
 +"      WHERE   EXTSYSTEMID='4' "
 +"      AND     STATUS     ='РАБОТАЕТ' "
 +"      AND     SITEID     = '" + params["mroSite"] + "' "
 +"      AND     LOCATION IN "
 +"              (SELECT LOCATION "
 +"              FROM    LOCLIST "
 +"              ) "
 +"      ) "
 +" SELECT    "
 +"          PREDS.DESCRIPTION        , "
 +"          PREDS.LOCATION           , "
 +"          COUNT (ASSETNUM) SOP     , "
 +"          COUNT ( "
 +"          CASE "
 +"                   WHEN list.inv_nom IS NULL "
 +"                   THEN 1 "
 +"          END) noinv, "
 +"          COUNT( "
 +"          CASE "
 +"                   WHEN EXISTS "
 +"                            (SELECT 1 "
 +"                            FROM    MAXIMO.FIXEDASSET "
 +"                            WHERE   FIXEDASSET.FIXEDASSETID = list.FIXEDASSETID "
 +"                            AND     fixedasset.UIO1        != list.UIO1 "
 +"                            ) "
 +"                   THEN assetnum "
 +"          END ) uio "
 +" FROM     list "
 +"          JOIN LOCLIST "
 +"          ON       list.location = LOCLIST.location "
 +"          JOIN MAXIMO.PREDS "
 +"          ON       LOCLIST.PRED = PREDS.location "
 +" WHERE    EXISTS "
 +"          (SELECT 1 "
 +"          FROM    MAXIMO.FIXEDASSET "
 +"          WHERE   FIXEDASSET.FIXEDASSETID = list.FIXEDASSETID "
 +"          ) "
 +" AND "
 +"          ( "
 +"                   EXISTS "
 +"                   ( SELECT 1 "
 +"                   FROM    maximo.UIOCLASSSTRUCTURE "
 +"                   WHERE   UIOCLASSSTRUCTURE.CLASSSTRUCTUREID = list.CLASSSTRUCTUREID "
 +"                   ) "
 +"          OR "
 +"                   ( "
 +"                            NOT EXISTS "
 +"                            ( SELECT 1 "
 +"                            FROM    maximo.UIOCLASSSTRUCTURE "
 +"                            WHERE   UIOCLASSSTRUCTURE.CLASSSTRUCTUREID = list.CLASSSTRUCTUREID "
 +"                            ) "
 +"                   AND      EXISTS "
 +"                            ( SELECT 1 "
 +"                            FROM    maximo.asset ast "
 +"                            WHERE   ast.assetnum = list.parent "
 +"                            AND     ast.set_nom  = list.set_nom "
 +"                            ) "
 +"                   ) "
 +"          ) "
 +" GROUP BY PREDS.LOCATION   , "
 +"          PREDS.DESCRIPTION "
}
 
  else if (params["hoz"].value == 21)

{
sqlText =  ""
  +" WITH loclist AS "
 +"      ( SELECT location, "
 +"              pred "
 +"      FROM    ( SELECT   loch2.Location , "
 +"                        loch.Parent Pred, "
 +"                        systemid "
 +"              FROM      Maximo.Lochierarchy Loch "
 +"                        LEFT JOIN Maximo.Lochierarchy Loch1 "
 +"                        ON        Loch1.Parent   = Loch.Location "
 +"                        AND       Loch1.Systemid = 'ОС' "
 +"                        LEFT JOIN MAXIMO.LOCHIERARCHY LOCH2 "
 +"                        ON        LOCH2.parent   = LOCH1.location "
 +"                        AND       LOCH2.SYSTEMID = 'ОС' "
 +"                        JOIN maximo.locationspec ls "
 +"                        ON        Loch.parent = ls.location "
 +"                        AND       assetattrid = 'TIP_PREDPR' "
 +"                        AND       numvalue    = 8 "
 +"              WHERE     LOCH.SITEID           = '" + params["mroSite"] + "' "
 +"              AND       Loch.Systemid         = 'ОС' "
 +"              ) "
 +"              locpred "
 +"      WHERE   pred IN "
 +"              ( SELECT   locations.location "
 +"              FROM      MAXIMO.LOCATIONSPEC "
 +"                        LEFT JOIN MAXIMO.LOCATIONS "
 +"                        ON        locations.location =locationspec.location "
 +"                        AND       locations.siteid   =locationspec.siteid "
 +"                        AND       locations.status   ='РАБОТАЕТ' "
 +"              WHERE     locationspec.classstructureid='090000000003' "
 +"              AND       locationspec.assetattrid     ='TIP_PREDPR' "
 +"              AND       LOCATIONSPEC.NUMVALUE        =8 "
 +"              AND       locationspec.siteid          = '" + params["mroSite"] + "' "
 +"              AND       locations.extsystemid        =1 "
 +"              ) "
 +"      AND     systemid = 'ОС' "
 +"      ) "
 +"      , "
 +"      list AS "
 +"      ( SELECT assetnum, "
 +"              location , "
 +"              set_nom  , "
 +"              inv_nom  , "
 +"              uio1     , "
 +"              fixedassetid, "
 +"              CLASSSTRUCTUREID, "
 +"              parent "
 +"      FROM    maximo.asset "
 +"      WHERE   location IN "
 +"              (SELECT location "
 +"              FROM    loclist "
 +"              ) "
 +"      AND     siteid      = '" + params["mroSite"] + "' "
 +"      AND     extsystemid = 21 "
 +"      AND     asset.status IN ( 'ЭКСПЛУАТИРУЕТСЯ', 'ОЖИДАЕТ РЕШЕНИЯ', 'ЗАКОНСЕРВИРОВАН') "
 +"      and SUBSTR(assetnum,0,2) = 'OB' "
 +"      ) "
 +" SELECT   "
 +"          PREDS.DESCRIPTION        , "
 +"          PREDS.LOCATION           , "
 +"          COUNT (ASSETNUM) SOP     , "
 +"          COUNT ( "
 +"          CASE "
 +"                   WHEN list.inv_nom IS NULL "
 +"                   THEN 1 "
 +"          END) noinv, "
 +"          COUNT( "
 +"          CASE "
 +"                   WHEN EXISTS "
 +"                            (SELECT 1 "
 +"                            FROM    MAXIMO.FIXEDASSET "
 +"                            WHERE   FIXEDASSET.FIXEDASSETID = list.FIXEDASSETID "
 +"                            AND     fixedasset.UIO1        != list.UIO1 "
 +"                            ) "
 +"                   THEN assetnum "
 +"          END ) uio "
 +" FROM     list "
 +"          JOIN LOCLIST "
 +"          ON       list.location = LOCLIST.location "
 +"          JOIN MAXIMO.PREDS "
 +"          ON       LOCLIST.PRED = PREDS.location "
 +" WHERE    EXISTS "
 +"          (SELECT 1 "
 +"          FROM    MAXIMO.FIXEDASSET "
 +"          WHERE   FIXEDASSET.FIXEDASSETID = list.FIXEDASSETID "
 +"          ) "
 +" AND "
 +"          ( "
 +"                   EXISTS "
 +"                   ( SELECT 1 "
 +"                   FROM    maximo.UIOCLASSSTRUCTURE "
 +"                   WHERE   UIOCLASSSTRUCTURE.CLASSSTRUCTUREID = list.CLASSSTRUCTUREID "
 +"                   ) "
 +"          OR "
 +"                   ( "
 +"                            NOT EXISTS "
 +"                            ( SELECT 1 "
 +"                            FROM    maximo.UIOCLASSSTRUCTURE "
 +"                            WHERE   UIOCLASSSTRUCTURE.CLASSSTRUCTUREID = list.CLASSSTRUCTUREID "
 +"                            ) "
 +"                   AND      EXISTS "
 +"                            ( SELECT 1 "
 +"                            FROM    maximo.asset ast "
 +"                            WHERE   ast.assetnum = list.parent "
 +"                            AND     ast.set_nom  = list.set_nom "
 +"                            ) "
 +"                   ) "
 +"          ) "
 +" GROUP BY PREDS.LOCATION   , "
 +"          PREDS.DESCRIPTION "

 }
 
 
 ;
 
 
 



maximoDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[if (!maximoDataSet.fetch())
	return (false);

row["LOCATION"] = maximoDataSet.getString("LOCATION");
row["DESCRIPTION"] = maximoDataSet.getString("DESCRIPTION");
row["SOP"] = maximoDataSet.getString("SOP");
row["UIO"] = maximoDataSet.getString("UIO");
row["NOINV"] = maximoDataSet.getString("NOINV");
//row["NOM1"] = maximoDataSet.getString("NOM");
return (true);]]></method>
        </script-data-set>
        <script-data-set name="11" id="11901">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">DESCRIPTION</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">DESCRIPTION</property>
                </structure>
                <structure>
                    <property name="columnName">SET_NOM</property>
                </structure>
                <structure>
                    <property name="columnName">SITE</property>
                </structure>
                <structure>
                    <property name="columnName">INVLAST</property>
                </structure>
                <structure>
                    <property name="columnName">SETLAST</property>
                </structure>
                <structure>
                    <property name="columnName">LOCATION</property>
                </structure>
                <structure>
                    <property name="columnName">ASSETNUM</property>
                </structure>
                <structure>
                    <property name="columnName">sdrgagr</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[maximoDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());
maximoDataSet.open();




var sqlText = new String();

{sqlText =  "select description from maximo.site where siteid = '" + params["mroSite"] + "'"
 }

;


maximoDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[if (!maximoDataSet.fetch())
	return (false);


row["DESCRIPTION"] = maximoDataSet.getString("DESCRIPTION");



	
return (true);]]></method>
        </script-data-set>
    </data-sets>
    <page-setup>
        <simple-master-page name="maximoLandscape" id="47" extends="MaximoSystemLibrary.maximoLandscape">
            <property name="type">a4</property>
            <property name="leftMargin">0.5in</property>
            <overridden-values>
                <ref-entry baseId="304" name="NewGrid2" id="304"/>
                <ref-entry baseId="305" id="305"/>
                <ref-entry baseId="306" id="306"/>
                <ref-entry baseId="307" id="307"/>
                <ref-entry baseId="308" id="308"/>
                <ref-entry baseId="340" name="NewImage1" id="340">
                    <property name="height">1px</property>
                    <property name="width">1px</property>
                </ref-entry>
                <ref-entry baseId="309" id="309"/>
                <ref-entry baseId="310" name="NewImage" id="310">
                    <property name="height">1px</property>
                    <property name="width">1px</property>
                </ref-entry>
                <ref-entry baseId="322" name="NewGrid" id="322"/>
                <ref-entry baseId="323" id="323"/>
                <ref-entry baseId="324" id="324"/>
                <ref-entry baseId="325" id="325"/>
                <ref-entry baseId="326" id="326"/>
                <ref-entry baseId="328" name="NewText" id="328"/>
                <ref-entry baseId="327" id="327"/>
                <ref-entry baseId="329" name="NewGrid1" id="329"/>
                <ref-entry baseId="330" id="330"/>
                <ref-entry baseId="331" id="331"/>
                <ref-entry baseId="332" id="332"/>
                <ref-entry baseId="333" id="333"/>
                <ref-entry baseId="334" id="334"/>
                <ref-entry baseId="335" name="NewAutoText" id="335"/>
                <ref-entry baseId="336" id="336"/>
                <ref-entry baseId="337" name="NewText1" id="337"/>
                <ref-entry baseId="338" id="338"/>
                <ref-entry baseId="339" name="NewAutoText1" id="339"/>
            </overridden-values>
        </simple-master-page>
    </page-setup>
    <body>
        <data id="12759">
            <property name="fontSize">medium</property>
            <property name="fontWeight">bold</property>
            <property name="textAlign">center</property>
            <property name="dataSet">11</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">DESCRIPTION</property>
                    <property name="displayName">DESCRIPTION</property>
                    <expression name="expression">if (params["hoz"].value == 2)
{this.text = "Статистика сопоставления ИН и СН для контроля качества по хозяйству П " + dataSetRow["DESCRIPTION"].replace("ая","ой") + " ж.д."}
else if 
 (params["hoz"].value == 3)
 {this.text = "Статистика сопоставления ИН и СН для контроля качества по хозяйству Э " + dataSetRow["DESCRIPTION"].replace("ая","ой") + " ж.д."}
 else if
 (params["hoz"].value == 4)
 {this.text = "Статистика сопоставления ИН и СН для контроля качества по хозяйству Ш " + dataSetRow["DESCRIPTION"].replace("ая","ой") + " ж.д."}
 else if 
 (params["hoz"].value == 21)
 {this.text = "Статистика сопоставления ИН и СН для контроля качества по хозяйству НГС " + dataSetRow["DESCRIPTION"].replace("ая","ой") + " ж.д."}</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <property name="resultSetColumn">DESCRIPTION</property>
        </data>
        <data id="12758"/>
        <text id="12757"/>
        <table id="12613">
            <property name="width">100%</property>
            <property name="dataSet">1</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">LOCATION</property>
                    <property name="displayName">LOCATION</property>
                    <expression name="expression">dataSetRow["LOCATION"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">DESCRIPTION</property>
                    <property name="displayName">DESCRIPTION</property>
                    <expression name="expression">dataSetRow["DESCRIPTION"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">SOP</property>
                    <property name="displayName">SOP</property>
                    <expression name="expression">dataSetRow["SOP"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">UIO</property>
                    <property name="displayName">UIO</property>
                    <expression name="expression">dataSetRow["UIO"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">NOINV</property>
                    <property name="displayName">NOINV</property>
                    <expression name="expression">dataSetRow["NOINV"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">%uio</property>
                    <expression name="expression">BirtMath.round(dataSetRow["UIO"]/dataSetRow["SOP"]*100)</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">%noinv</property>
                    <expression name="expression">BirtMath.round(dataSetRow["NOINV"]/dataSetRow["SOP"]*100)</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">site_sop</property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">row["SOP"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">all_site_sop</property>
                    <property name="dataType">string</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">row["SOP"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">site_uio</property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">row["UIO"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">all_site_uio</property>
                    <property name="dataType">string</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">row["UIO"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">site_noinv</property>
                    <property name="dataType">float</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">row["NOINV"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">all_site_noinv</property>
                    <property name="dataType">string</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">row["NOINV"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">%site_uio</property>
                    <expression name="expression">row["site_uio"]/row["site_sop"]*100</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">%all_site_uio</property>
                    <expression name="expression">BirtMath.round(row["all_site_uio"]/row["all_site_sop"]*100)</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">%site_noinv</property>
                    <expression name="expression">row["site_noinv"]/row["site_sop"]*100</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">%all_site_noinv</property>
                    <expression name="expression">BirtMath.round(row["all_site_noinv"]/row["all_site_uio"])</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">NOM1</property>
                    <property name="displayName">NOM1</property>
                    <expression name="expression">dataSetRow["NOM1"]</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="sort">
                <structure>
                    <expression name="key">row["DESCRIPTION"].replace(/\D{1,}$/,"").replace (/^\D{1,}/, "") * 1</expression>
                    <property name="direction">asc</property>
                </structure>
            </list-property>
            <column id="12652"/>
            <column id="12653"/>
            <column id="12654"/>
            <column id="12655"/>
            <column id="12656"/>
            <column id="12657"/>
            <header>
                <row id="12614">
                    <cell id="12615">
                        <property name="colSpan">1</property>
                        <property name="rowSpan">3</property>
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <data id="12756"/>
                        <label id="8184">
                            <text-property name="text">Предприятие</text-property>
                        </label>
                    </cell>
                    <cell id="12617">
                        <property name="colSpan">5</property>
                        <property name="rowSpan">1</property>
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="7968">
                            <property name="textAlign">center</property>
                            <text-property name="text">Объекты технического учета</text-property>
                        </label>
                    </cell>
                </row>
                <row id="12730">
                    <cell id="12732">
                        <property name="colSpan">1</property>
                        <property name="rowSpan">2</property>
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="8186">
                            <property name="textAlign">center</property>
                            <text-property name="text">Сопоставлено</text-property>
                        </label>
                    </cell>
                    <cell id="12733">
                        <property name="colSpan">2</property>
                        <property name="rowSpan">1</property>
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="12043">
                            <text-property name="text">Расхождение УИО с объектами БУ</text-property>
                        </label>
                    </cell>
                    <cell id="12735">
                        <property name="colSpan">2</property>
                        <property name="rowSpan">1</property>
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="12044">
                            <property name="textAlign">center</property>
                            <text-property name="text">Пустые значение ИН</text-property>
                        </label>
                    </cell>
                </row>
                <row id="12723">
                    <cell id="12726">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="12047">
                            <property name="textAlign">center</property>
                            <text-property name="text">Кол-во</text-property>
                        </label>
                    </cell>
                    <cell id="12727">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="12048">
                            <property name="textAlign">center</property>
                            <text-property name="text">%</text-property>
                        </label>
                    </cell>
                    <cell id="12728">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="12737">
                            <property name="textAlign">center</property>
                            <text-property name="text">Кол-во</text-property>
                        </label>
                    </cell>
                    <cell id="12729">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="12738">
                            <property name="textAlign">center</property>
                            <text-property name="text">%</text-property>
                        </label>
                    </cell>
                </row>
                <row id="12662">
                    <cell id="12663">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="12178">
                            <property name="textAlign">center</property>
                            <text-property name="text">1</text-property>
                        </label>
                    </cell>
                    <cell id="12664">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="12179">
                            <property name="textAlign">center</property>
                            <text-property name="text">2</text-property>
                        </label>
                    </cell>
                    <cell id="12665">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="12180">
                            <property name="textAlign">center</property>
                            <text-property name="text">3</text-property>
                        </label>
                    </cell>
                    <cell id="12666">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="12659">
                            <property name="textAlign">center</property>
                            <text-property name="text">4</text-property>
                        </label>
                    </cell>
                    <cell id="12667">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="12660">
                            <property name="textAlign">center</property>
                            <text-property name="text">5</text-property>
                        </label>
                    </cell>
                    <cell id="12668">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">center</property>
                        <label id="12661">
                            <property name="textAlign">center</property>
                            <text-property name="text">6</text-property>
                        </label>
                    </cell>
                </row>
            </header>
            <detail>
                <row id="12629">
                    <cell id="12630">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="12752">
                            <property name="resultSetColumn">DESCRIPTION</property>
                            <structure name="action">
                                <property name="linkType">none</property>
                            </structure>
                        </data>
                        <data id="12751">
                            <list-property name="visibility">
                                <structure>
                                    <property name="format">all</property>
                                    <expression name="valueExpr">true</expression>
                                </structure>
                            </list-property>
                            <property name="resultSetColumn">LOCATION</property>
                        </data>
                    </cell>
                    <cell id="12632">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">right</property>
                        <data id="12639">
                            <property name="resultSetColumn">SOP</property>
                        </data>
                    </cell>
                    <cell id="12634">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">right</property>
                        <data id="12641">
                            <property name="resultSetColumn">UIO</property>
                            <structure name="action">
                                <property name="linkType">drill-through</property>
                                <property name="reportName">os19.rptdesign</property>
                                <property name="targetWindow">_blank</property>
                                <property name="targetFileType">report-design</property>
                                <list-property name="paramBindings">
                                    <structure>
                                        <property name="paramName">where</property>
                                        <expression name="expression">"1=1"</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">appname</property>
                                        <expression name="expression">"CONS_OS"</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">mroSite</property>
                                        <expression name="expression">params["mroSite"].value</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">hoz</property>
                                        <expression name="expression">params["hoz"].value</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">loc</property>
                                        <expression name="expression">row["LOCATION"]</expression>
                                    </structure>
                                </list-property>
                            </structure>
                        </data>
                    </cell>
                    <cell id="12636">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">right</property>
                        <data id="12739">
                            <property name="resultSetColumn">%uio</property>
                        </data>
                    </cell>
                    <cell id="12638">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">right</property>
                        <data id="12643">
                            <property name="resultSetColumn">NOINV</property>
                            <structure name="action">
                                <property name="linkType">drill-through</property>
                                <property name="reportName">os20.rptdesign</property>
                                <property name="targetWindow">_blank</property>
                                <property name="targetFileType">report-design</property>
                                <list-property name="paramBindings">
                                    <structure>
                                        <property name="paramName">appname</property>
                                        <expression name="expression">"CONS_OS"</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">where</property>
                                        <expression name="expression">"1=1"</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">mroSite</property>
                                        <expression name="expression">params["mroSite"].value</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">hoz</property>
                                        <expression name="expression">params["hoz"].value</expression>
                                    </structure>
                                    <structure>
                                        <property name="paramName">loc</property>
                                        <expression name="expression">row["LOCATION"]</expression>
                                    </structure>
                                </list-property>
                            </structure>
                        </data>
                    </cell>
                    <cell id="12640">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">right</property>
                        <data id="12740">
                            <property name="resultSetColumn">%noinv</property>
                        </data>
                    </cell>
                </row>
            </detail>
            <footer>
                <row id="12644">
                    <cell id="12645">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <label id="8249">
                            <property name="fontWeight">bold</property>
                            <text-property name="text">Итого</text-property>
                        </label>
                    </cell>
                    <cell id="12646">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">right</property>
                        <data id="12742">
                            <property name="resultSetColumn">all_site_sop</property>
                        </data>
                    </cell>
                    <cell id="12647">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">right</property>
                        <data id="12744">
                            <property name="resultSetColumn">all_site_uio</property>
                        </data>
                    </cell>
                    <cell id="12648">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">right</property>
                        <data id="12748">
                            <property name="resultSetColumn">%all_site_uio</property>
                        </data>
                    </cell>
                    <cell id="12649">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">right</property>
                        <data id="12746">
                            <property name="resultSetColumn">all_site_noinv</property>
                        </data>
                    </cell>
                    <cell id="12650">
                        <property name="backgroundColor">#C0C0C0</property>
                        <property name="fontWeight">bold</property>
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <property name="textAlign">right</property>
                        <data id="12750">
                            <property name="resultSetColumn">%all_site_noinv</property>
                        </data>
                    </cell>
                </row>
            </footer>
        </table>
    </body>
</report>
