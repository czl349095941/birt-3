<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.17" id="1">
    <property name="createdBy">Eclipse BIRT Designer Version 2.3.2.r232_20090202 Build &lt;2.3.2.v20090218-0730></property>
    <property name="units">in</property>
    <property name="comments">IBM Confidential

OCO Source Materials

5724-M19

(C) COPYRIGHT IBM CORP. 2006

The source code for this program is not published or otherwise
divested of its trade secrets, irrespective of what has been
deposited with the U.S. Copyright Office.</property>
    <html-property name="description">This template will create a report with one or more groups, each having identical data fields, and contains three styles of charts.</html-property>
    <list-property name="userProperties">
        <structure>
            <property name="name">Data Cube.1.x</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.1.y</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.1.width</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.1.height</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set1.x</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set1.y</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set1.width</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set1.height</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.webservice.x</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.webservice.y</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.webservice.width</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.webservice.height</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set5.x</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set5.y</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set5.width</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set5.height</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
    </list-property>
    <property name="Data Cube.1.x">135</property>
    <property name="Data Cube.1.y">59</property>
    <property name="Data Cube.1.width">150</property>
    <property name="Data Cube.1.height">200</property>
    <property name="Data Cube.Data Set1.x">106</property>
    <property name="Data Cube.Data Set1.y">37</property>
    <property name="Data Cube.Data Set1.width">150</property>
    <property name="Data Cube.Data Set1.height">200</property>
    <property name="Data Cube.webservice.x">85</property>
    <property name="Data Cube.webservice.y">72</property>
    <property name="Data Cube.webservice.width">150</property>
    <property name="Data Cube.webservice.height">200</property>
    <property name="Data Cube.Data Set5.x">123</property>
    <property name="Data Cube.Data Set5.y">103</property>
    <property name="Data Cube.Data Set5.width">150</property>
    <property name="Data Cube.Data Set5.height">200</property>
    <list-property name="propertyBindings">
        <structure>
            <property name="name">odaURL</property>
            <property name="id">9434</property>
            <expression name="value">var siteid = "";
siteid = (params["mroSite"]);
if (siteid == "10") 
{ "jdbc:inetdae7a:10.10.1.120:1433" }
else if (siteid == "17") 
{ "jdbc:inetdae7a:10.23.250.56:1433" }
else if (siteid == "24") 
{ "jdbc:inetdae7a:10.24.223.234:1433" }
else if (siteid == "28") 
{ "jdbc:inetdae7a:10.43.195.99:1433" }
else if (siteid == "51") 
{ "jdbc:inetdae7a:10.51.5.67:1433" }
else if (siteid == "58") 
{ "jdbc:inetdae7a:10.58.1.198:1433" }
else if (siteid == "63") 
{ "jdbc:inetdae7a:10.64.24.179:1433" }
else if (siteid == "76") 
{ "jdbc:inetdae7a:10.76.0.129:1433" }
else if (siteid == "80") 
{ "jdbc:inetdae7a:10.81.28.126:1433" }
else if (siteid == "83") 
{ "jdbc:inetdae7a:10.132.71.29:1433" }
else if (siteid == "88") 
{ "jdbc:inetdae7a:10.89.250.175:1433" }
else if (siteid == "92") 
{ "jdbc:inetdae7a:10.111.24.226:1433" }
else if (siteid == "94") 
{ "jdbc:inetdae7a:10.123.169.124:1433" }
else { " - " }</expression>
        </structure>
        <structure>
            <property name="name">odaUser</property>
            <property name="id">9434</property>
            <expression name="value">var siteid = "";
siteid = (params["mroSite"]);
if (siteid == "10") 
{ "asui" }
else if (siteid == "17") 
{ "ocrv" }
else if (siteid == "24") 
{ "trset" }
else if (siteid == "28") 
{ "asui" }
else if (siteid == "51") 
{ "ASUEOCSKZD" }
else if (siteid == "58") 
{ "ASUE_OCRV" }
else if (siteid == "63") 
{ "ekasui" }
else if (siteid == "76") 
{ "asui" }
else if (siteid == "80") 
{ "chel" }
else if (siteid == "83") 
{ "asui" }
else if (siteid == "88") 
{ "asui" }
else if (siteid == "92") 
{ "asui" }
else if (siteid == "94") 
{ "asui" }
else { " - " }</expression>
        </structure>
        <structure>
            <property name="name">odaPassword</property>
            <property name="id">9434</property>
            <expression name="value">var siteid = "";
siteid = (params["mroSite"]);
if (siteid == "10") 
{ "asui" }
else if (siteid == "17") 
{ "ocrvuser" }
else if (siteid == "24") 
{ "tr_set" }
else if (siteid == "28") 
{ "asui" }
else if (siteid == "51") 
{ "As16Eo98Z45" }
else if (siteid == "58") 
{ "D2_12345678" }
else if (siteid == "63") 
{ "ekasui" }
else if (siteid == "76") 
{ "asui" }
else if (siteid == "80") 
{ "chelchel" }
else if (siteid == "83") 
{ "asui" }
else if (siteid == "88") 
{ "asui" }
else if (siteid == "92") 
{ "asui" }
else if (siteid == "94") 
{ "ZrwElectro-75" }
else { " - " }</expression>
        </structure>
    </list-property>
    <method name="initialize"><![CDATA[importPackage(Packages.com.ibm.tivoli.maximo.report.script);

mxReportScriptContext = MXReportScriptContext.initialize(reportContext);
mxReportScriptContext.setDefaultLogLevel("DEBUG");
mxReportScriptContext.setDefaultLogFile("c:/temp/tetttt.txt");

]]></method>
    <method name="afterFactory"><![CDATA[MXReportScriptContext.close();]]></method>
    <property name="theme">MaximoSystemLibrary.maximoTheme</property>
    <text-property name="displayName">Tivoli Maximo Grouped Chart Template</text-property>
    <property name="bidiLayoutOrientation">ltr</property>
    <list-property name="libraries">
        <structure>
            <property name="fileName">MaximoSystemLibrary.rptlibrary</property>
            <property name="namespace">MaximoSystemLibrary</property>
        </structure>
    </list-property>
    <parameters>
        <scalar-parameter name="where" id="25">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <property name="defaultValue">1=1</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="appname" id="240">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="paramdelimiter" id="241">
            <property name="hidden">true</property>
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="paramstring" id="242">
            <property name="hidden">true</property>
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="mroSite" id="10179">
            <property name="valueType">static</property>
            <property name="dataType">integer</property>
            <property name="paramType">simple</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="podr" id="10182">
            <property name="valueType">static</property>
            <property name="dataType">integer</property>
            <property name="paramType">simple</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <script-data-source name="maximoDataSource" id="64" extends="MaximoSystemLibrary.maximoDataSource"/>
        <oda-data-source extensionID="org.eclipse.birt.report.data.oda.jdbc" name="Data Source" id="9434">
            <property name="odaDriverClass">com.inet.tds.TdsDriver</property>
            <property name="odaURL">jdbc:inetdae7a:10.32.1.223:1433</property>
            <property name="odaUser">asui</property>
            <encrypted-property name="odaPassword" encryptionID="base64">YXN1aQ==</encrypted-property>
            <property name="odaJndiName">com.inet.tds.TdsDriver</property>
        </oda-data-source>
    </data-sources>
    <data-sets>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="Data Set2" id="9435">
            <list-property name="computedColumns">
                <structure>
                    <property name="name">IDINEXT</property>
                    <expression name="expression">row["ITEMNUM"]+"_"+row["ID_OBJ"]</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">LOCATION</property>
                    <property name="displayName">LOCATION</property>
                </structure>
                <structure>
                    <property name="columnName">ECH</property>
                    <property name="displayName">ECH</property>
                </structure>
                <structure>
                    <property name="columnName">ID_ECH</property>
                    <property name="displayName">ID_ECH</property>
                </structure>
                <structure>
                    <property name="columnName">PODR</property>
                    <property name="displayName">PODR</property>
                </structure>
                <structure>
                    <property name="columnName">ITEMNUM</property>
                    <property name="displayName">ITEMNUM</property>
                </structure>
                <structure>
                    <property name="columnName">ID_OBJ</property>
                    <property name="displayName">ID_OBJ</property>
                </structure>
            </list-property>
            <list-property name="filter">
                <structure>
                    <property name="operator">eq</property>
                    <expression name="expr">row["LOCATION"]</expression>
                    <simple-property-list name="value1">
                        <value>params["podr"].value</value>
                    </simple-property-list>
                </structure>
                <structure>
                    <property name="operator">like</property>
                    <expression name="expr">row["PODR"]</expression>
                    <simple-property-list name="value1">
                        <value>'ЭЧК%'</value>
                    </simple-property-list>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">LOCATION</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">ECH</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">ID_ECH</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">PODR</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">ID_OBJ</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">IDINEXT</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data Source</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">LOCATION</property>
                    <property name="nativeName">LOCATION</property>
                    <property name="dataType">integer</property>
                    <property name="nativeDataType">4</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">ECH</property>
                    <property name="nativeName">ECH</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">ID_ECH</property>
                    <property name="nativeName">ID_ECH</property>
                    <property name="dataType">integer</property>
                    <property name="nativeDataType">4</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">PODR</property>
                    <property name="nativeName">PODR</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">ITEMNUM</property>
                    <property name="nativeName">ITEMNUM</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">ID_OBJ</property>
                    <property name="nativeName">ID_OBJ</property>
                    <property name="dataType">decimal</property>
                    <property name="nativeDataType">2</property>
                </structure>
            </list-property>
            <property name="queryText">--Вывод Дополнительный провод(Additional_Wires)
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH, d.name AS PODR,'ДОП_ПРОВ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Additional_Wires A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_DRIVINGS,0) is not null

Union
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ДОП_ПРОВ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Additional_Wires A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_STATION,0) is not null and NULLIF(B.ID_DRIVINGS,0) is null



UNION
--Вывод Воздушных стрелок (Air_Arrows)
 

SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ВОЗДУШ_СТРЕЛКИ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Air_Arrows A
Left JOIN Drivings_ECHK b ON a.id_drivings = b.id_rec 
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_DRIVINGS,0) is not null

Union
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ВОЗДУШ_СТРЕЛКИ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Air_Arrows A 
Left JOIN Station_ECHK b ON a.id_station = b.id_rec
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_STATION,0) is not null and NULLIF(a.ID_DRIVINGS,0) is null



UNION
--Вывод Пересечения (Air_intersections)
 

SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ПЕРЕСЕЧЕНИЯ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Air_intersections A
Left JOIN Drivings_ECHK b ON a.id_drivings = b.id_rec 
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_DRIVINGS,0) is not null

Union
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ПЕРЕСЕЧЕНИЯ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Air_intersections A 
Left JOIN Station_ECHK b ON a.id_station = b.id_rec
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_STATION,0) is not null and NULLIF(a.ID_DRIVINGS,0) is null



UNION
--Вывод ВЛ(Air_Lines)
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'ВОЗД_ЛИНИИ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Air_Lines A 
Left JOIN ECHK b ON b.id_rec = a.id_ECHK
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.ID_ECHK is not null

union
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'ВОЗД_ЛИНИИ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Air_Lines A 
Left JOIN ECHS b ON b.id_rec = a.id_ECHS
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.ID_ECHS is not null

UNION
--Вывод Выключатель постоянного тока (Breaker_Const)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ВЫКЛ_ПОСТ_ТОКА' AS ITEMNUM, a.id_rec AS ID_OBJ
from Breaker_Const a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
LEFT JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null 

UNION
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'ВЫКЛ_ПОСТ_ТОКА' AS ITEMNUM, A.id_rec AS ID_OBJ
from Breaker_Const a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null

UNION
--Вывод Выключатель переменного тока(Breaker_Variable)
 

SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ВЫКЛ_ПЕР_ТОКА' AS ITEMNUM, a.id_rec AS ID_OBJ
from Breaker_Variable a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null

UNION
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ВЫКЛ_ПЕР_ТОКА' AS ITEMNUM, a.id_rec AS ID_OBJ
from Breaker_Variable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ВЫКЛ_ПЕР_ТОКА' AS ITEMNUM, a.id_rec AS ID_OBJ
from Breaker_Variable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ВЫКЛ_ПЕР_ТОКА' AS ITEMNUM, a.id_rec AS ID_OBJ
from Breaker_Variable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null

UNION
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'ВЫКЛ_ПЕР_ТОКА' AS ITEMNUM, A.id_rec AS ID_OBJ
from Breaker_Variable a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null



UNION
--Вывод Контрольный кабель(Cable и Cable2)

SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'КОНТР_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Cable a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null and a.PURPOSE =3

UNION
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОНТР_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null and a.PURPOSE =3

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОНТР_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null and a.PURPOSE =3

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОНТР_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null and a.PURPOSE =3

UNION
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'КОНТР_КАБЕЛ' AS ITEMNUM, A.id_rec AS ID_OBJ
from Cable a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null and a.PURPOSE =3

--Cable2
UNION
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'КОНТР_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cable2 A 
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where B.ID_ECHK is not null and a.PURPOSE =3

union
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'КОНТР_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cable2 A 
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where B.ID_ECHS is not null and a.PURPOSE =3

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОНТР_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cable2 A
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null and a.PURPOSE =3

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОНТР_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cable2 A
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null and a.PURPOSE =3

UNION
--Вывод Силовой кабель(Cable и Cable2)
 

SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'СИЛ_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Cable a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null and a.PURPOSE =2

UNION
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'СИЛ_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null and a.PURPOSE =2

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'СИЛ_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null and a.PURPOSE =2

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'СИЛ_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null and a.PURPOSE =2

UNION
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'СИЛ_КАБЕЛ' AS ITEMNUM, A.id_rec AS ID_OBJ
from Cable a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null and a.PURPOSE =2

--Cable2
UNION
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'СИЛ_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cable2 A 
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where B.ID_ECHK is not null and a.PURPOSE =2

union
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'СИЛ_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cable2 A 
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where B.ID_ECHS is not null and a.PURPOSE =2

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'СИЛ_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cable2 A
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null and a.PURPOSE =2

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'СИЛ_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cable2 A
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null and a.PURPOSE =2



UNION
--Вывод Высоковольтный кабель(Cable и Cable2)
 

SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Cable a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null and a.PURPOSE =1

UNION
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null and a.PURPOSE =1

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null and a.PURPOSE =1

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null and a.PURPOSE =1

UNION
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM, A.id_rec AS ID_OBJ
from Cable a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null and a.PURPOSE =1

--Cable2
UNION
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cable2 A 
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where B.ID_ECHK is not null and a.PURPOSE =1

union
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cable2 A 
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where B.ID_ECHS is not null and a.PURPOSE =1

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cable2 A
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null and a.PURPOSE =1

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cable2 A
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null and a.PURPOSE =1



UNION
--Вывод Кабельные вставки(Cable_Insertions)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'КАБ_ВСТАВ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cable_Insertions A
Left JOIN Air_Lines b ON b.id_rec=a.id_airline
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_AIRLINE is not null and ID_ECHK is not null

union
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'КАБ_ВСТАВ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cable_Insertions A
Left JOIN Air_Lines b ON b.id_rec=a.id_airline
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_AIRLINE is not null and ID_ECHS is not null

UNION
--Вывод Кабельные линии(Cable_Lines)
 

SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'КАБ_ЛИНИИ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cable_Lines A 
Left JOIN ECHK b ON b.id_rec = a.id_ECHK
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.ID_ECHK is not null

union
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'КАБ_ЛИНИИ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cable_Lines A 
Left JOIN ECHS b ON b.id_rec = a.id_ECHS
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.ID_ECHS is not null

UNION
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КАБ_ЛИНИИ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cable_Lines A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_DRIVINGS,0) is not null and a.ID_ECHK is null and a.ID_ECHK is null

Union
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КАБ_ЛИНИИ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cable_Lines A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_STATION,0) is not null and NULLIF(B.ID_DRIVINGS,0) is null and a.ID_ECHK is null and a.ID_ECHK is null



UNION
--Вывод Кабельные муфты(Cables_Muffs)
 

SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'КАБ_МУФ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cables_Muffs A
Left JOIN Air_Lines b ON b.id_rec=a.id_airline
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_AIRLINE is not null and ID_ECHK is not null

union
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'КАБ_МУФ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cables_Muffs A
Left JOIN Air_Lines b ON b.id_rec=a.id_airline
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_AIRLINE is not null and ID_ECHS is not null 

UNION
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КАБ_МУФ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Cables_Muffs a
Left JOIN Cable b ON b.id_rec = a.id_cable
Left JOIN Distributing_Devices c ON c.id_rec = b.id_device
Left JOIN ECHE d ON c.id_parent = d.id_rec
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_DEVICE is not null and a.ID_CABLE is not null

UNION
--Device2
SELECT f.id_rec AS LOCATION,g.name AS ECH, g.id_rec as ID_ECH, f.name AS PODR,'КАБ_МУФ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Cables_Muffs a
Left JOIN Cable b ON b.id_rec = a.id_cable
Left JOIN Distributing_Devices2 c ON c.id_rec = b.id_device2
Left JOIN Gen_Inf_TP d ON c.id_parent = d.id_echs
Left JOIN TP_Echs e ON d.id_echs = e.id_rec
Left JOIN Echs f ON f.id_rec = e.id_echs
Left JOIN ECH g ON g.id_rec = f.id_parent
where B.ID_DEVICE2 is not null and NULLIF(E.ID_ECHS,0) is not null and NULLIF(E.ID_ECHK,0) is null and NULLIF(E.ID_ECHE,0) is null and a.ID_CABLE is not null

UNION
SELECT f.id_rec AS LOCATION,g.name AS ECH, g.id_rec as ID_ECH,f.name AS PODR,'КАБ_МУФ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Cables_Muffs a
Left JOIN Cable b ON b.id_rec = a.id_cable
Left JOIN Distributing_Devices2 c ON c.id_rec = b.id_device2
Left JOIN Gen_Inf_TP d ON c.id_parent = d.id_echs
Left JOIN TP_Echs e ON d.id_echs = e.id_rec
Left JOIN ECHK f ON f.id_rec = e.id_ECHK
Left JOIN ECH g ON g.id_rec = f.id_parent
where B.ID_DEVICE2 is not null and NULLIF(E.ID_ECHK,0) is not null and NULLIF(E.ID_ECHS,0) is null and NULLIF(E.ID_ECHE,0) is null and a.ID_CABLE is not null

Union
SELECT f.id_rec AS LOCATION,g.name AS ECH, g.id_rec as ID_ECH,f.name AS PODR,'КАБ_МУФ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Cables_Muffs a
Left JOIN Cable b ON b.id_rec = a.id_cable
Left JOIN Distributing_Devices2 c ON c.id_rec = b.id_device2
Left JOIN Gen_Inf_TP d ON c.id_parent = d.id_echs
Left JOIN TP_Echs e ON d.id_echs = e.id_rec
Left JOIN EchE f ON f.id_rec = e.id_echE
Left JOIN ECH g ON g.id_rec = f.id_parent
where B.ID_DEVICE2 is not null and NULLIF(E.ID_ECHE,0) is not null and NULLIF(E.ID_ECHK,0) is null and NULLIF(E.ID_ECHS,0) is null and a.ID_CABLE is not null

UNION
--object
SELECT e.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,e.NAME AS PODR,'КАБ_МУФ' AS ITEMNUM, A.id_rec AS ID_OBJ
from Cables_Muffs a
Left JOIN Cable b ON b.id_rec = a.id_cable
Left JOIN Line_Objects c ON c.id_rec = b.id_object
Left JOIN ECH d ON d.id_rec = c.id_parent
LEFT JOIN ECHE e ON e.id_rec = c.belong_ECHE
where B.ID_OBJECT is not null and a.ID_CABLE2 is not null

--Cable2
UNION
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КАБ_МУФ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cables_Muffs A 
Left JOIN Cable2 b ON b.id_rec = a.id_cable2
Left JOIN Cable_Lines c ON c.id_rec = b.id_cableline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where C.ID_ECHK is not null and a.ID_CABLE2 is not null

union
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КАБ_МУФ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cables_Muffs A 
Left JOIN Cable2 b ON b.id_rec = a.id_cable2
Left JOIN Cable_Lines c ON c.id_rec = b.id_cableline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where C.ID_ECHS is not null and a.ID_CABLE2 is not null

UNION
SELECT f.id_rec AS LOCATION,g.name AS ECH, g.id_rec as ID_ECH,f.name AS PODR,'КАБ_МУФ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cables_Muffs A
Left JOIN Cable2 b ON b.id_rec = a.id_cable2
Left JOIN Cable_Lines c ON c.id_rec = b.id_cableline
Left JOIN Ways d ON c.id_way = d.id_rec 
Left JOIN Drivings_ECHK e ON d.id_drivings = e.id_rec 
Left JOIN ECHK f ON f.id_rec = e.id_ECHK
Left JOIN ECH g ON g.id_rec = f.id_parent
where NULLIF(D.ID_DRIVINGS,0) is not null and a.ID_CABLE2 is not null

Union
SELECT f.id_rec AS LOCATION,g.name AS ECH, g.id_rec as ID_ECH,f.name AS PODR,'КАБ_МУФ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cables_Muffs A
Left JOIN Cable2 b ON b.id_rec = a.id_cable2
Left JOIN Cable_Lines c ON c.id_rec = b.id_cableline
Left JOIN Ways d ON c.id_way = d.id_rec 
Left JOIN Station_ECHK e ON d.id_station = e.id_rec
Left JOIN ECHK f ON f.id_rec = e.id_ECHK
Left JOIN ECH g ON g.id_rec = f.id_parent
where NULLIF(D.ID_STATION,0) is not null and NULLIF(D.ID_DRIVINGS,0) is null and a.ID_CABLE2 is not null

UNION
--Add_ware 
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КАБ_МУФ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cables_Muffs A
Left JOIN Additional_Wires b ON a.id_add = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null and a.ID_ADD is not null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КАБ_МУФ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Cables_Muffs A
Left JOIN Additional_Wires b ON a.id_add = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null and a.ID_ADD is not null



UNION
--Вывод Компенсирующее устройство (Compensating_Devices)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'КОМП_УСТР' AS ITEMNUM, a.id_rec AS ID_OBJ
from Compensating_Devices a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null

UNION
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'КОМП_УСТР' AS ITEMNUM, A.id_rec AS ID_OBJ
from Compensating_Devices a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null

UNION
--Вывод Консоли(Console)
 

SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОНСОЛЬ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Console A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОНСОЛЬ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Console A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null

UNION
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КОНСОЛЬ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Console A
Left JOIN Hard_crossbeams b ON a.zhp = b.id_rec
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_DRIVINGS,0) is not null

Union
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КОНСОЛЬ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Console A
Left JOIN Hard_crossbeams b ON a.zhp = b.id_rec
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_STATION,0) is not null and NULLIF(B.ID_DRIVINGS,0) is null



UNION
--Вывод Счетчик электроэнергии(Counters)
 

SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'СЧЕТ_Э' AS ITEMNUM, a.id_rec AS ID_OBJ
from Counters a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null

UNION
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'СЧЕТ_Э' AS ITEMNUM, a.id_rec AS ID_OBJ
from Counters a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'СЧЕТ_Э' AS ITEMNUM, a.id_rec AS ID_OBJ
from Counters a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'СЧЕТ_Э' AS ITEMNUM, a.id_rec AS ID_OBJ
from Counters a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null

UNION
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'СЧЕТ_Э' AS ITEMNUM, A.id_rec AS ID_OBJ
from Counters a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null



UNION
--Вывод Токопровод (Current_Wire)
 

SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ТОКОПРОВОД' AS ITEMNUM, a.id_rec AS ID_OBJ
from Current_Wire a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null

UNION
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТОКОПРОВОД' AS ITEMNUM, a.id_rec AS ID_OBJ
from Current_Wire a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТОКОПРОВОД' AS ITEMNUM, a.id_rec AS ID_OBJ
from Current_Wire a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТОКОПРОВОД' AS ITEMNUM, a.id_rec AS ID_OBJ
from Current_Wire a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null

UNION
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'ТОКОПРОВОД' AS ITEMNUM, A.id_rec AS ID_OBJ
from Current_Wire a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null



UNION
--Вывод Дизель-генер(Dies_Gen)
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'ДИЗ_ГЕН' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Dies_Gen A 
Left JOIN ECHE b ON b.id_rec = a.id_parent
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.ID_PARENT is not null 

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ДИЗ_ГЕН' AS ITEMNUM, a.id_rec AS ID_OBJ
from Dies_Gen a
Left JOIN Gen_Inf_TP c ON a.id_tp_echs = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ДИЗ_ГЕН' AS ITEMNUM, a.id_rec AS ID_OBJ
from Dies_Gen a
Left JOIN Gen_Inf_TP c ON a.id_tp_echs = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ДИЗ_ГЕН' AS ITEMNUM, a.id_rec AS ID_OBJ
from Dies_Gen a
Left JOIN Gen_Inf_TP c ON a.id_tp_echs = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null

UNION
--Вывод Разрядники(Dischargers)
 

SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'РАЗРЯДНИКИ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Dischargers A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHK is not null and a.ID_TOWER_AIRLINE is not null

union
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'РАЗРЯДНИКИ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Dischargers A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHS is not null and a.ID_TOWER_AIRLINE is not null

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'РАЗРЯДНИКИ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Dischargers A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'РАЗРЯДНИКИ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Dischargers A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null

UNION
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'РАЗРЯДНИКИ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Dischargers a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null

UNION
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'РАЗРЯДНИКИ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Dischargers a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'РАЗРЯДНИКИ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Dischargers a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'РАЗРЯДНИКИ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Dischargers a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null

UNION
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'РАЗРЯДНИКИ' AS ITEMNUM, A.id_rec AS ID_OBJ
from Dischargers a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null



UNION
--Вывод Разъединители(Disconnectors)
 

SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Disconnectors A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHK is not null and a.ID_TOWER_AIRLINE is not null

union
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Disconnectors A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHS is not null and a.ID_TOWER_AIRLINE is not null

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Disconnectors A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Disconnectors A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null

UNION
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Disconnectors a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null

UNION
--device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Disconnectors a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Disconnectors a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Disconnectors a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null

UNION
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM, A.id_rec AS ID_OBJ
from Disconnectors a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null



UNION
--Вывод Приводы разъединителей(Drives2)
 

SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ПРИВ_РАЗЪЕД' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Drives2 A
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Towers_Airlines c ON b.id_tower_airline = c.id_rec
Left JOIN Air_Lines d ON d.id_rec=c.id_airline
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where C.ID_AIRLINE is not null  and D.ID_ECHK is not null and B.ID_TOWER_AIRLINE is not null and a.ID_DISCONNECTOR is not null

union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ПРИВ_РАЗЪЕД' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Drives2 A
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Towers_Airlines c ON b.id_tower_airline = c.id_rec
Left JOIN Air_Lines d ON d.id_rec=c.id_airline
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where C.ID_AIRLINE is not null  and D.ID_ECHS is not null and B.ID_TOWER_AIRLINE is not null and a.ID_DISCONNECTOR is not null

UNION
SELECT f.id_rec AS LOCATION,g.name AS ECH, g.id_rec as ID_ECH,f.name AS PODR,'ПРИВ_РАЗЪЕД' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Drives2 A
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Towers c ON c.id_rec = b.id_tower
Left JOIN Ways d ON c.id_way = d.id_rec 
Left JOIN Drivings_ECHK e ON d.id_drivings = e.id_rec 
Left JOIN ECHK f ON f.id_rec = e.id_ECHK
Left JOIN ECH g ON g.id_rec = f.id_parent
where NULLIF(D.ID_DRIVINGS,0) is not null and a.ID_DISCONNECTOR is not null

Union
SELECT f.id_rec AS LOCATION,g.name AS ECH, g.id_rec as ID_ECH,f.name AS PODR,'ПРИВ_РАЗЪЕД' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Drives2 A
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Towers c ON c.id_rec = b.id_tower
Left JOIN Ways d ON c.id_way = d.id_rec 
Left JOIN Station_ECHK e ON d.id_station = e.id_rec
Left JOIN ECHK f ON f.id_rec = e.id_ECHK
Left JOIN ECH g ON g.id_rec = f.id_parent
where NULLIF(D.ID_STATION,0) is not null and NULLIF(D.ID_DRIVINGS,0) is null and a.ID_DISCONNECTOR is not null

UNION
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ПРИВ_РАЗЪЕД' AS ITEMNUM, a.id_rec AS ID_OBJ
from Drives2 a
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Distributing_Devices c ON c.id_rec = b.id_device
Left JOIN ECHE d ON c.id_parent = d.id_rec
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_DEVICE is not null and a.ID_DISCONNECTOR is not null

UNION
--Device2
SELECT f.id_rec AS LOCATION,g.name AS ECH, g.id_rec as ID_ECH,f.name AS PODR,'ПРИВ_РАЗЪЕД' AS ITEMNUM, a.id_rec AS ID_OBJ
from Drives2 a
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Distributing_Devices2 c ON c.id_rec = b.id_device2
Left JOIN Gen_Inf_TP d ON c.id_parent = d.id_echs
Left JOIN TP_Echs e ON d.id_echs = e.id_rec
Left JOIN Echs f ON f.id_rec = e.id_echs
Left JOIN ECH g ON g.id_rec = f.id_parent
where B.ID_DEVICE2 is not null and NULLIF(E.ID_ECHS,0) is not null and NULLIF(E.ID_ECHK,0) is null and NULLIF(E.ID_ECHE,0) is null and a.ID_DISCONNECTOR is not null

UNION
SELECT f.id_rec AS LOCATION,g.name AS ECH, g.id_rec as ID_ECH,f.name AS PODR,'ПРИВ_РАЗЪЕД' AS ITEMNUM, a.id_rec AS ID_OBJ
from Drives2 a
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Distributing_Devices2 c ON c.id_rec = b.id_device2
Left JOIN Gen_Inf_TP d ON c.id_parent = d.id_echs
Left JOIN TP_Echs e ON d.id_echs = e.id_rec
Left JOIN ECHK f ON f.id_rec = e.id_ECHK
Left JOIN ECH g ON g.id_rec = f.id_parent
where B.ID_DEVICE2 is not null and NULLIF(E.ID_ECHK,0) is not null and NULLIF(E.ID_ECHS,0) is null and NULLIF(E.ID_ECHE,0) is null and a.ID_DISCONNECTOR is not null

Union
SELECT f.id_rec AS LOCATION,g.name AS ECH, g.id_rec as ID_ECH,f.name AS PODR,'ПРИВ_РАЗЪЕД' AS ITEMNUM, a.id_rec AS ID_OBJ
from Drives2 a
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Distributing_Devices2 c ON c.id_rec = b.id_device2
Left JOIN Gen_Inf_TP d ON c.id_parent = d.id_echs
Left JOIN TP_Echs e ON d.id_echs = e.id_rec
Left JOIN EchE f ON f.id_rec = e.id_echE
Left JOIN ECH g ON g.id_rec = f.id_parent
where B.ID_DEVICE2 is not null and NULLIF(E.ID_ECHE,0) is not null and NULLIF(E.ID_ECHK,0) is null and NULLIF(E.ID_ECHS,0) is null and a.ID_DISCONNECTOR is not null

UNION
--object
SELECT e.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,e.NAME AS PODR,'ПРИВ_РАЗЪЕД' AS ITEMNUM, A.id_rec AS ID_OBJ
from Drives2 a
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Line_Objects c ON c.id_rec = b.id_object
Left JOIN ECH d ON d.id_rec = c.id_parent
LEFT JOIN ECHE e ON e.id_rec = c.belong_ECHE
where B.ID_OBJECT is not null and a.ID_DISCONNECTOR is not null



UNION
--Вывод Гибкая поперечина (Flexible_crossbeams)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ГИБК_ПОПЕРЕЧ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Flexible_crossbeams A
Left JOIN Drivings_ECHK b ON a.id_drivings = b.id_rec 
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_DRIVINGS,0) is not null

UNION
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ГИБК_ПОПЕРЕЧ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Flexible_crossbeams A 
Left JOIN Station_ECHK b ON a.id_station = b.id_rec
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_STATION,0) is not null and NULLIF(a.ID_DRIVINGS,0) is null

UNION
--Вывод Трансформаторные подстанции (Gen_Inf_TP)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ТРАНСФ_ПОДСТ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Gen_Inf_TP a
Left JOIN TP_Echs b ON b.id_rec = a.id_echs
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(B.ID_ECHS,0) is not null and NULLIF(B.ID_ECHK,0) is null and NULLIF(B.ID_ECHE,0) is null

union
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ТРАНСФ_ПОДСТ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Gen_Inf_TP a
Left JOIN TP_Echs b ON b.id_rec = a.id_echs
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(B.ID_ECHK,0) is not null and NULLIF(B.ID_ECHS,0) is null and NULLIF(B.ID_ECHE,0) is null

union
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ТРАНСФ_ПОДСТ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Gen_Inf_TP a
Left JOIN TP_Echs b ON b.id_rec = a.id_echs
Left JOIN ECHE c ON c.id_rec = b.id_eche
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(B.ID_ECHE,0) is not null and NULLIF(B.ID_ECHK,0) is null and NULLIF(B.ID_ECHS,0) is null

UNION
-- Вывод Заземляющее устройство (Ground_Devices)
 

SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ЗАЗЕМ_УСТР' AS ITEMNUM, a.id_rec AS ID_OBJ
from Ground_Devices a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null

UNION
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ЗАЗЕМ_УСТР' AS ITEMNUM, a.id_rec AS ID_OBJ
from Ground_Devices a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ЗАЗЕМ_УСТР' AS ITEMNUM, a.id_rec AS ID_OBJ
from Ground_Devices a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ЗАЗЕМ_УСТР' AS ITEMNUM, a.id_rec AS ID_OBJ
from Ground_Devices a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null

UNION
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'ЗАЗЕМ_УСТР' AS ITEMNUM, A.id_rec AS ID_OBJ
from Ground_Devices a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null



UNION
--Вывод Жесткая поперечина (Hard_crossbeams)
 

SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ЖЕСТ_ПОПЕРЕЧ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Hard_crossbeams A
Left JOIN Drivings_ECHK b ON a.id_drivings = b.id_rec 
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_DRIVINGS,0) is not null

Union
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ЖЕСТ_ПОПЕРЕЧ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Hard_crossbeams A 
Left JOIN Station_ECHK b ON a.id_station = b.id_rec
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_STATION,0) is not null and NULLIF(a.ID_DRIVINGS,0) is null



UNION
--Вывод Шкаф обогрева (Heating_shkaf)
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'ШКАФ_ОБОГР' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Heating_shkaf A 
Left JOIN ECHS b ON b.id_rec = a.id_parent
left join ECH C on C.ID_REC = B.ID_PARENT

UNION
--Вывод Кронштейны(Holders)
 

SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КРОНШТЕЙН' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Holders A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КРОНШТЕЙН' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Holders A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null

UNION
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КРОНШТЕЙН' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Holders A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null and C.ID_ECHK is not null

union
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КРОНШТЕЙН' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Holders A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null and C.ID_ECHS is not null



UNION
--Вывод Крючья и штыри(Hooks)
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КШ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Hooks A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null and C.ID_ECHK is not null

union
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КШ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Hooks A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null and C.ID_ECHS is not null

UNION
--Вывод Изолирующие сопряжения и нейтральные вставки (Insertions)
 

SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ИЗОЛ_СОПР_НЕЙТР_ВСТ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Insertions A
Left JOIN Drivings_ECHK b ON a.id_drivings = b.id_rec 
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_DRIVINGS,0) is not null

Union
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ИЗОЛ_СОПР_НЕЙТР_ВСТ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Insertions A 
Left JOIN Station_ECHK b ON a.id_station = b.id_rec
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_STATION,0) is not null and NULLIF(a.ID_DRIVINGS,0) is null



UNION
--Вывод Изоляторы в целом(Insulators)
 

SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Insulators A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHK is not null and a.ID_TOWER_AIRLINE is not null

union
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Insulators A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHS is not null and a.ID_TOWER_AIRLINE is not null

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Insulators A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Insulators A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null

UNION
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Insulators A
Left JOIN Flexible_crossbeams b ON a.gp = b.id_rec
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_DRIVINGS,0) is not null

Union
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Insulators A
Left JOIN Flexible_crossbeams b ON a.gp = b.id_rec
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_STATION,0) is not null and NULLIF(B.ID_DRIVINGS,0) is null

UNION
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Insulators A
Left JOIN Hard_crossbeams b ON a.zhp = b.id_rec
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_DRIVINGS,0) is not null

Union
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Insulators A
Left JOIN Hard_crossbeams b ON a.zhp = b.id_rec
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_STATION,0) is not null and NULLIF(B.ID_DRIVINGS,0) is null

UNION
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Insulators a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null

UNION
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Insulators a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Insulators a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Insulators a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null

UNION
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, A.id_rec AS ID_OBJ
from Insulators a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null



UNION
--Вывод Освещение(Lamps)
 

SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'ОСВЕЩЕНИЕ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Lamps A 
Left JOIN ECHK b ON b.id_rec = a.id_ECHK
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.ID_ECHK is not null and NULLIF(a.ID_MAST,0) is null and a.ID_TOWER_AIRLINE is null and a.ID_ECHS is null and a.ID_ECHE is null

union
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'ОСВЕЩЕНИЕ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Lamps A 
Left JOIN ECHS b ON b.id_rec = a.id_ECHS
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.ID_ECHS is not null and NULLIF(a.ID_MAST,0) is null and a.ID_TOWER_AIRLINE is null and a.ID_ECHK is null and a.ID_ECHE is null

union
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'ОСВЕЩЕНИЕ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Lamps A 
Left JOIN ECHE b ON b.id_rec = a.id_ECHE
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.ID_ECHE is not null and NULLIF(a.ID_MAST,0) is null and a.ID_TOWER_AIRLINE is null and a.ID_ECHK is null and a.ID_ECHS is null

UNION
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ОСВЕЩЕНИЕ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Lamps A 
Left JOIN Mast b ON b.id_rec = a.id_mast
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where B.ID_ECHK is not null and B.ID_ECHE is null and B.ID_PARENT is null

UNION
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ОСВЕЩЕНИЕ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Lamps A 
Left JOIN Mast b ON b.id_rec = a.id_mast
Left JOIN ECHS c ON c.id_rec = b.id_parent
Left JOIN ECH d ON d.id_rec = c.id_parent
where B.ID_PARENT is not null and B.ID_ECHE is null and B.ID_ECHK is null

UNION
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ОСВЕЩЕНИЕ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Lamps A 
Left JOIN Mast b ON b.id_rec = a.id_mast
Left JOIN ECHE c ON c.id_rec = b.id_eche
Left JOIN ECH d ON d.id_rec = c.id_parent
where B.ID_ECHE is not null and B.ID_PARENT is null and B.ID_ECHK is null

UNION
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ОСВЕЩЕНИЕ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Lamps A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null and C.ID_ECHK is not null and a.ID_ECHK is null and a.ID_ECHS is null and a.ID_ECHE is null

union
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ОСВЕЩЕНИЕ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Lamps A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null and C.ID_ECHS is not null and a.ID_ECHK is null and a.ID_ECHS is null and a.ID_ECHE is null



UNION
--Вывод Прожекторные мачты(Mast)
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'ПРОЖ_МАЧТ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Mast A 
Left JOIN ECHK b ON b.id_rec = a.id_ECHK
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.ID_ECHK is not null

union
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'ПРОЖ_МАЧТ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Mast A 
Left JOIN ECHS b ON b.id_rec = a.id_parent
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.ID_PARENT is not null

union
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'ПРОЖ_МАЧТ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Mast A 
Left JOIN ECHE b ON b.id_rec = a.id_ECHE
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.ID_ECHE is not null

UNION
--Вывод Контактные подвески (Podveska)
 

SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КОНТ_ПОДВЕС' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Podveska A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_DRIVINGS,0) is not null --and (label_wire1 ='0' and label_wire2 ='0' and type_wire = '0' and type_wire_1 = '0' and type_wire_2 ='0' and type_cable = '0' and type_cable2 = '0')

Union
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КОНТ_ПОДВЕС' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Podveska A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_STATION,0) is not null and NULLIF(B.ID_DRIVINGS,0) is null --and (label_wire1 ='0' and label_wire2 ='0' and type_wire = '0' and type_wire_1 = '0' and type_wire_2 ='0' and type_cable = '0' and type_cable2 = '0')



UNION
--Вывод Секционный изолятор (Sectional_Insulators)
 

SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'СЕКЦ_ИЗОЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Sectional_Insulators A
Left JOIN Drivings_ECHK b ON a.id_drivings = b.id_rec 
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_DRIVINGS,0) is not null

Union
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'СЕКЦ_ИЗОЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Sectional_Insulators A 
Left JOIN Station_ECHK b ON a.id_station = b.id_rec
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_STATION,0) is not null and NULLIF(a.ID_DRIVINGS,0) is null



UNION
--Вывод Короткозамыкатели (ShortClosers)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'КОРОТКОЗАМЫКАТЕЛИ' AS ITEMNUM, a.id_rec AS ID_OBJ
from ShortClosers a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null

UNION
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОРОТКОЗАМЫКАТЕЛИ' AS ITEMNUM, a.id_rec AS ID_OBJ
from ShortClosers a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОРОТКОЗАМЫКАТЕЛИ' AS ITEMNUM, a.id_rec AS ID_OBJ
from ShortClosers a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОРОТКОЗАМЫКАТЕЛИ' AS ITEMNUM, a.id_rec AS ID_OBJ
from ShortClosers a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null

UNION
--Вывод Сглаживающие устройства(Smooth_Devices)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'СГЛАЖ_УСТР' AS ITEMNUM, a.id_rec AS ID_OBJ
from Smooth_Devices a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
left join ECH D on D.ID_REC = C.ID_PARENT

UNION
--Вывод Искровые промежутки(Sparkling_Gaps)
 

SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ИСКР_ПРОМ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Sparkling_Gaps A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ИСКР_ПРОМ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Sparkling_Gaps A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null



UNION
--Вывод Аккумуляторная батарея(Storage_Battery)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'АБ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Storage_Battery a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
left join ECH D on D.ID_REC = C.ID_PARENT

UNION
--Вывод Коммутационная аппаратура (Switchgear)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'КОММ_АПП' AS ITEMNUM, a.id_rec AS ID_OBJ
from Switchgear a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null

UNION
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОММ_АПП' AS ITEMNUM, a.id_rec AS ID_OBJ
from Switchgear a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОММ_АПП' AS ITEMNUM, a.id_rec AS ID_OBJ
from Switchgear a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОММ_АПП' AS ITEMNUM, a.id_rec AS ID_OBJ
from Switchgear a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null

UNION
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'КОММ_АПП' AS ITEMNUM, A.id_rec AS ID_OBJ
from Switchgear a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null

UNION
--Вывод Опоры КС(Towers)
 

SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ОПОРЫ_КС' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Towers A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
LEFT JOIN ECHK d ON d.id_rec = c.id_ECHK
LEFT JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_DRIVINGS,0) is not null

UNION
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ОПОРЫ_КС' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Towers A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
LEFT JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_STATION,0) is not null and NULLIF(B.ID_DRIVINGS,0) is null



UNION
--Вывод ОПОРЫ ВЛ(Towers_airlines)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ОПОРЫ_ВЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Towers_airlines A
Left JOIN Air_Lines b ON b.id_rec=a.id_airline
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_AIRLINE is not null and ID_ECHK is not null

union
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ОПОРЫ_ВЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Towers_airlines A
Left JOIN Air_Lines b ON b.id_rec=a.id_airline
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_AIRLINE is not null and ID_ECHS is not null

UNION
--Вывод ОПОРЫ ДОП ПРОВ(Towers_airlines)
 

SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ОПОРЫ_ДОП_ПРОВ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Towers_airlines A
Left JOIN Additional_Wires b ON a.id_add_wire = b.id_rec
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null

union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ОПОРЫ_ДОП_ПРОВ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Towers_airlines A
Left JOIN Additional_Wires b ON a.id_add_wire = b.id_rec
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null



UNION
--Вывод Преобразовательные трансформаторы (Transformer)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ПРЕОБ_ТРАНСФ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Transformer a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
left join ECH D on D.ID_REC = C.ID_PARENT

UNION
--Вывод Трансформатор тока (Transformers_Current)
 

SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ТРАНСФ_ТОКА' AS ITEMNUM, a.id_rec AS ID_OBJ
from Transformers_Current a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null

UNION
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТРАНСФ_ТОКА' AS ITEMNUM, a.id_rec AS ID_OBJ
from Transformers_Current a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТРАНСФ_ТОКА' AS ITEMNUM, a.id_rec AS ID_OBJ
from Transformers_Current a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТРАНСФ_ТОКА' AS ITEMNUM, a.id_rec AS ID_OBJ
from Transformers_Current a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null

UNION
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'ТРАНСФ_ТОКА' AS ITEMNUM, A.id_rec AS ID_OBJ
from Transformers_Current a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null



UNION
--Выводы Дроссель-трансформатор (Transformers_Suction purpose=11)
 

SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ДРОСС_ТРАНСФ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Transformers_Suction A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_DRIVINGS,0) is not null and a.PURPOSE = '11'

Union
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ДРОСС_ТРАНСФ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Transformers_Suction A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_STATION,0) is not null and NULLIF(B.ID_DRIVINGS,0) is null and a.PURPOSE = '11'



UNION
--Выводы Отсасывающий трансформатор(Transformers_Suction purpose=2)
 

SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ОТСАСЫВ_ТРАНСФ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Transformers_Suction A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_DRIVINGS,0) is not null and a.PURPOSE = '2'

Union
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ОТСАСЫВ_ТРАНСФ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Transformers_Suction A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_STATION,0) is not null and NULLIF(B.ID_DRIVINGS,0) is null and a.PURPOSE = '2'



UNION
--Вывод Трансформаторы напряжения (Transformers_Voltage)
 

SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ТРАНС_НАПР' AS ITEMNUM, a.id_rec AS ID_OBJ
from Transformers_Voltage a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null

UNION
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТРАНС_НАПР' AS ITEMNUM, a.id_rec AS ID_OBJ
from Transformers_Voltage a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТРАНС_НАПР' AS ITEMNUM, a.id_rec AS ID_OBJ
from Transformers_Voltage a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТРАНС_НАПР' AS ITEMNUM, a.id_rec AS ID_OBJ
from Transformers_Voltage a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null

UNION
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'ТРАНС_НАПР' AS ITEMNUM, A.id_rec AS ID_OBJ
from Transformers_Voltage a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null



UNION
--Вывод Трансформаторы и автотрансформаторы силовые(transformers2)
 

SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ТРАНС_АВТОТРАНС' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM transformers2 A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHK is not null and a.ID_TOWER_AIRLINE is not null

union
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ТРАНС_АВТОТРАНС' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM transformers2 A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHS is not null and a.ID_TOWER_AIRLINE is not null

UNION
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ТРАНС_АВТОТРАНС' AS ITEMNUM, a.id_rec AS ID_OBJ
from transformers2 a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null

UNION
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТРАНС_АВТОТРАНС' AS ITEMNUM, a.id_rec AS ID_OBJ
from transformers2 a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТРАНС_АВТОТРАНС' AS ITEMNUM, a.id_rec AS ID_OBJ
from transformers2 a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТРАНС_АВТОТРАНС' AS ITEMNUM, a.id_rec AS ID_OBJ
from transformers2 a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null

UNION
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'ТРАНС_АВТОТРАНС' AS ITEMNUM, A.id_rec AS ID_OBJ
from transformers2 a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null



UNION
--Вывод Траверсы(Traverses)
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ТРАВЕРСЫ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Traverses A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null and C.ID_ECHK is not null

union
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ТРАВЕРСЫ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Traverses A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null and C.ID_ECHS is not null

UNION
--Вывод Грузокомпенсирующие устройства(Weight_Compensating)
 

SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ГРУЗОКОМ_УСТР' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Weight_Compensating A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ГРУЗОКОМ_УСТР' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Weight_Compensating A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null



UNION
--Вывод Провода воздушных линий(Wires)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ПРОВОДА_ВЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Wires A
Left JOIN Air_Lines b ON b.id_rec=a.id_airline
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_AIRLINE is not null and ID_ECHK is not null

union
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ПРОВОДА_ВЛ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Wires A
Left JOIN Air_Lines b ON b.id_rec=a.id_airline
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_AIRLINE is not null and ID_ECHS is not null

UNION
--Вывод ЗПУ (ZPU)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ЗПУ' AS ITEMNUM, a.id_rec AS ID_OBJ
from ZPU a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
left join ECH D on D.ID_REC = C.ID_PARENT

UNION
--Вывод Ограничители перенапряжений(OPN)
 

SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ОПН' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM OPN A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHK is not null and a.ID_TOWER_AIRLINE is not null

union
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ОПН' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM OPN A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHS is not null and a.ID_TOWER_AIRLINE is not null

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ОПН' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM OPN A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ОПН' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM OPN A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null

UNION
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ОПН' AS ITEMNUM, a.id_rec AS ID_OBJ
from OPN a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null

UNION
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ОПН' AS ITEMNUM, a.id_rec AS ID_OBJ
from OPN a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null

UNION
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ОПН' AS ITEMNUM, a.id_rec AS ID_OBJ
from OPN a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ОПН' AS ITEMNUM, a.id_rec AS ID_OBJ
from OPN a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null

UNION
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'ОПН' AS ITEMNUM, A.id_rec AS ID_OBJ
from OPN a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null



UNION
--Вывод Электрические соединители (Electric_Connector)
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ЭЛ_СОЕД' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Electric_Connector A
Left JOIN Podveska b ON a.id_podveska = b.id_rec
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null and (a.PURPOSE =7 or a.PURPOSE = 8)

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ЭЛ_СОЕД' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Electric_Connector A
Left JOIN Podveska b ON a.id_podveska = b.id_rec
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null and (a.PURPOSE =7 or a.PURPOSE = 8)

UNION
--Вывод Струны (Electric_Connector)
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'СТРУНЫ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Electric_Connector A
Left JOIN Podveska b ON a.id_podveska = b.id_rec
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null and a.PURPOSE not in (7,8)

Union
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'СТРУНЫ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Electric_Connector A
Left JOIN Podveska b ON a.id_podveska = b.id_rec
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null and a.PURPOSE not in (7,8)

UNION
SELECT c.id_rec  AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH, c.name AS PODR,'ОПОР_КОНСТР' AS ITEMNUM, a.id_rec AS ID_OBJ
from support a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
left join ECH D on D.ID_REC = C.ID_PARENT

UNION
 

SELECT  d.id_rec   AS LOCATION, e.name AS ECH, e.id_rec as ID_ECH, d.name AS PODR,'ПРЕДОХРАНИТЕЛИ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Fuzes A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHK is not null and a.ID_TOWER_AIRLINE is not null

union
SELECT  d.id_rec  AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH, d.name AS PODR,'ПРЕДОХРАНИТЕЛИ' AS ITEMNUM, a.id_rec AS ID_OBJ
FROM Fuzes A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHS is not null and a.ID_TOWER_AIRLINE is not null

union
SELECT  c.id_rec   AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH, c.name AS PODR,'ПРЕДОХРАНИТЕЛИ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Fuzes a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null

UNION
--Device2
SELECT e.id_rec  AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,  e.name AS PODR,'ПРЕДОХРАНИТЕЛИ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Fuzes a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null

union
SELECT  e.id_rec  AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,  e.name AS PODR,'ПРЕДОХРАНИТЕЛИ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Fuzes a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null

union
SELECT  e.id_rec   AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH, e.name AS PODR,'ПРЕДОХРАНИТЕЛИ' AS ITEMNUM, a.id_rec AS ID_OBJ
from Fuzes a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null

UNION
--object
SELECT  d.id_rec   AS LOCATION, c.NAME AS ECH, c.id_rec as ID_ECH, d.NAME AS PODR,'ПРЕДОХРАНИТЕЛИ' AS ITEMNUM, A.id_rec AS ID_OBJ
from Fuzes a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null


</property>
            <xml-property name="designerValues"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<model:DesignValues xmlns:design="http://www.eclipse.org/datatools/connectivity/oda/design" xmlns:model="http://www.eclipse.org/birt/report/model/adapter/odaModel">
  <Version>1.0</Version>
  <design:ResultSets derivedMetaData="true">
    <design:resultSetDefinitions>
      <design:resultSetColumns>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:name>ECH</design:name>
            <design:position>1</design:position>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>10</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>ECH</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>ECH</design:label>
            <design:formattingHints>
              <design:displaySize>10</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:name>ITEMNUM</design:name>
            <design:position>2</design:position>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>19</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>ITEMNUM</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>ITEMNUM</design:label>
            <design:formattingHints>
              <design:displaySize>19</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:name>COUNT</design:name>
            <design:position>3</design:position>
            <design:nativeDataTypeCode>4</design:nativeDataTypeCode>
            <design:precision>10</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>COUNT</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>COUNT</design:label>
            <design:formattingHints>
              <design:displaySize>4</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
      </design:resultSetColumns>
    </design:resultSetDefinitions>
  </design:ResultSets>
</model:DesignValues>]]></xml-property>
        </oda-data-set>
        <script-data-set name="Data Set" id="11283">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">LOCATION</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">DESCRIPTION</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">ITEMNUM</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">ITEMDESC</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">ASSETNUM</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">IDINEXTSYSTEM_ALN</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">7</property>
                    <property name="name">IDINEXTSYSTEM</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">LOCATION</property>
                </structure>
                <structure>
                    <property name="columnName">DESCRIPTION</property>
                </structure>
                <structure>
                    <property name="columnName">ITEMNUM</property>
                </structure>
                <structure>
                    <property name="columnName">ITEMDESC</property>
                </structure>
                <structure>
                    <property name="columnName">ASSETNUM</property>
                </structure>
                <structure>
                    <property name="columnName">IDINEXTSYSTEM_ALN</property>
                </structure>
                <structure>
                    <property name="columnName">IDINEXTSYSTEM</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">LOCATION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">ITEMDESC</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">ASSETNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">IDINEXTSYSTEM_ALN</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">IDINEXTSYSTEM</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[maximoDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());
	maximoDataSet.open();
	
	var sqlText = new String();

	sqlText =  " WITH  "
 +" LIST AS (  "
 +" SELECT SITEID, ITEMNUM, ASSETNUM,  IDINEXTSYSTEM, PARENT, CONNECT_BY_ROOT LOCATION AS LOCATION  "
 +" FROM MAXIMO.ASSET  "
 +" START WITH PARENT IS NULL  "
 +"       AND EXTSYSTEMID='3'  "
 +"       AND STATUS='РАБОТАЕТ'  "
 +"       and SITEID= " + params["mroSite"]
 +"       AND LOCATION = 'ECHK_" + params["mroSite"] + "_" + params["podr"] +"'"
 +" CONNECT BY NOCYCLE  PRIOR ASSETNUM =  PARENT "
 +"       AND PRIOR SITEID = SITEID "
 +"       AND PRIOR EXTSYSTEMID = EXTSYSTEMID  "
 +"       AND PRIOR STATUS = STATUS  "
 
 +"   )  "
 +" SELECT   "
 +"  L.LOCATION,L3.DESCRIPTION,  "
 +" CASE WHEN PD.ITEMNUM='ДОП_ПРОВ' THEN 'ОПОРЫ_ДОП_ПРОВ' ELSE L.ITEMNUM END ITEMNUM,  "
 +" case when PD.ITEMNUM='ДОП_ПРОВ' then 'Опоры дополнительных проводов' else I.DESCRIPTION end ITEMDESC,  "
 +" L.ASSETNUM,  CASE WHEN PD.ITEMNUM='ДОП_ПРОВ' THEN 'ОПОРЫ_ДОП_ПРОВ' ELSE L.ITEMNUM END||'_'||L.IDINEXTSYSTEM IDINEXTSYSTEM_ALN, L.IDINEXTSYSTEM "
 +" FROM LIST L  "
 +" LEFT JOIN MAXIMO.LOCATIONS L3 ON L3.LOCATION=L.LOCATION AND L3.STATUS='РАБОТАЕТ' AND L3.SITEID=L.SITEID  "
 +" LEFT JOIN MAXIMO.ASSET PD ON L.PARENT=PD.ASSETNUM AND L.SITEID=PD.SITEID AND PD.EXTSYSTEMID='3' AND PD.STATUS='РАБОТАЕТ'  "
 +" LEFT JOIN MAXIMO.ITEM I ON I.ITEMNUM=L.ITEMNUM  "



;

	maximoDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[if (!maximoDataSet.fetch())
	   return (false);

row["LOCATION"] = maximoDataSet.getString("LOCATION");
row["DESCRIPTION"] = maximoDataSet.getString("DESCRIPTION");
row["ITEMNUM"] = maximoDataSet.getString("ITEMNUM");
row["ITEMDESC"] = maximoDataSet.getString("ITEMDESC");
row["ASSETNUM"] = maximoDataSet.getString("ASSETNUM");
row["IDINEXTSYSTEM_ALN"] = maximoDataSet.getString("IDINEXTSYSTEM_ALN");
row["IDINEXTSYSTEM"] = maximoDataSet.getString("IDINEXTSYSTEM");


return (true);]]></method>
        </script-data-set>
        <joint-data-set name="Data Set1" id="11364">
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">Data Set::LOCATION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">Data Set::DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">Data Set::ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">Data Set::ITEMDESC</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">Data Set::ASSETNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">Data Set::IDINEXTSYSTEM_ALN</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">Data Set::IDINEXTSYSTEM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">Data Set2::LOCATION</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">Data Set2::ECH</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">10</property>
                        <property name="name">Data Set2::ID_ECH</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">11</property>
                        <property name="name">Data Set2::PODR</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">12</property>
                        <property name="name">Data Set2::ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">13</property>
                        <property name="name">Data Set2::ID_OBJ</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">14</property>
                        <property name="name">Data Set2::IDINEXT</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <simple-property-list name="dataSets">
                <value>Data Set</value>
                <value>Data Set2</value>
            </simple-property-list>
            <list-property name="joinConditions">
                <structure>
                    <property name="joinType">full-out</property>
                    <property name="joinOperator">eq</property>
                    <property name="leftDataSet">Data Set</property>
                    <property name="rightDataSet">Data Set2</property>
                    <expression name="leftExpression">dataSetRow["IDINEXTSYSTEM_ALN"]</expression>
                    <expression name="rightExpression">dataSetRow["IDINEXT"]</expression>
                </structure>
            </list-property>
        </joint-data-set>
        <script-data-set name="Data Set31" id="9674">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">ITEMNUM</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">DESCRIPTION</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">ITEMNUM</property>
                </structure>
                <structure>
                    <property name="columnName">DESCRIPTION</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[maximoDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());
	maximoDataSet.open();
	
	var sqlText = new String();

	sqlText =  " select distinct asset.itemnum, item.description from maximo.asset "
 +" left join maximo.item on item.itemnum = asset.itemnum "
 +" where extsystemid = 3 "
 +" union all"
 +" select 'ОПОРЫ_ДОП_ПРОВ' itemnum, 'Опоры дополнительных проводов' description from dual "
 +" union all"
 +" select 'ЭЛ_СОЕД' itemnum, 'Электрические соединители' description from dual "

;

	maximoDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[if (!maximoDataSet.fetch())
	   return (false);

row["ITEMNUM"] = maximoDataSet.getString("ITEMNUM");
row["DESCRIPTION"] = maximoDataSet.getString("DESCRIPTION");


return (true);]]></method>
        </script-data-set>
        <joint-data-set name="Data Set3" id="11671">
            <list-property name="computedColumns">
                <structure>
                    <property name="name">ITEM</property>
                    <expression name="expression">if (row["Data Set1::Data Set::ITEMNUM"] == null) (row["Data Set31::ITEMNUM"])
else (row["Data Set1::Data Set::ITEMNUM"])</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">ITEMDESC</property>
                    <expression name="expression">if (row["Data Set1::Data Set::ITEMDESC"] == null) (row["Data Set31::DESCRIPTION"])
else (row["Data Set1::Data Set::ITEMDESC"])</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">Data Set1::Data Set::LOCATION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">Data Set1::Data Set::DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">Data Set1::Data Set::ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">Data Set1::Data Set::ITEMDESC</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">Data Set1::Data Set::ASSETNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">Data Set1::Data Set::IDINEXTSYSTEM_ALN</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">Data Set1::Data Set::IDINEXTSYSTEM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">Data Set1::Data Set2::LOCATION</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">Data Set1::Data Set2::ECH</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">10</property>
                        <property name="name">Data Set1::Data Set2::ID_ECH</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">11</property>
                        <property name="name">Data Set1::Data Set2::PODR</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">12</property>
                        <property name="name">Data Set1::Data Set2::ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">13</property>
                        <property name="name">Data Set1::Data Set2::ID_OBJ</property>
                        <property name="dataType">decimal</property>
                    </structure>
                    <structure>
                        <property name="position">14</property>
                        <property name="name">Data Set1::Data Set2::IDINEXT</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">15</property>
                        <property name="name">Data Set31::ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">16</property>
                        <property name="name">Data Set31::DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">17</property>
                        <property name="name">ITEM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">18</property>
                        <property name="name">ITEMDESC</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <simple-property-list name="dataSets">
                <value>Data Set1</value>
                <value>Data Set31</value>
            </simple-property-list>
            <list-property name="joinConditions">
                <structure>
                    <property name="joinType">left-out</property>
                    <property name="joinOperator">eq</property>
                    <property name="leftDataSet">Data Set1</property>
                    <property name="rightDataSet">Data Set31</property>
                    <expression name="leftExpression">dataSetRow["Data Set2::ITEMNUM"]</expression>
                    <expression name="rightExpression">dataSetRow["ITEMNUM"]</expression>
                </structure>
            </list-property>
        </joint-data-set>
        <script-data-set name="Data Set311" id="11879">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">DESCRIPTION</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">DESCRIPTION</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[maximoDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());
	maximoDataSet.open();
	
	var sqlText = new String();

	sqlText =  " select description from maximo.locations where location = 'ECHK_"+params["mroSite"]+"_"+params["podr"]+"' "


;

	maximoDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[if (!maximoDataSet.fetch())
	   return (false);

row["DESCRIPTION"] = maximoDataSet.getString("DESCRIPTION");


return (true);]]></method>
        </script-data-set>
    </data-sets>
    <page-setup>
        <simple-master-page name="maximoLandscape" id="47" extends="MaximoSystemLibrary.maximoLandscape">
            <property name="type">a4</property>
            <property name="leftMargin">0.0625in</property>
            <property name="rightMargin">0.0625in</property>
            <overridden-values>
                <ref-entry baseId="304" name="NewGrid2" id="304">
                    <list-property name="visibility">
                        <structure>
                            <property name="format">all</property>
                            <expression name="valueExpr">true</expression>
                        </structure>
                    </list-property>
                </ref-entry>
                <ref-entry baseId="305" id="305"/>
                <ref-entry baseId="306" id="306"/>
                <ref-entry baseId="307" id="307"/>
                <ref-entry baseId="308" id="308"/>
                <ref-entry baseId="340" name="NewImage1" id="340">
                    <list-property name="visibility">
                        <structure>
                            <property name="format">all</property>
                            <expression name="valueExpr">true</expression>
                        </structure>
                    </list-property>
                </ref-entry>
                <ref-entry baseId="309" id="309"/>
                <ref-entry baseId="310" name="NewImage" id="310">
                    <list-property name="visibility">
                        <structure>
                            <property name="format">all</property>
                            <expression name="valueExpr">true</expression>
                        </structure>
                    </list-property>
                </ref-entry>
                <ref-entry baseId="322" name="NewGrid" id="322"/>
                <ref-entry baseId="323" id="323"/>
                <ref-entry baseId="324" id="324"/>
                <ref-entry baseId="325" id="325"/>
                <ref-entry baseId="326" id="326"/>
                <ref-entry baseId="328" name="NewText" id="328">
                    <list-property name="visibility">
                        <structure>
                            <property name="format">all</property>
                            <expression name="valueExpr">true</expression>
                        </structure>
                    </list-property>
                </ref-entry>
                <ref-entry baseId="327" id="327"/>
                <ref-entry baseId="329" name="NewGrid1" id="329"/>
                <ref-entry baseId="330" id="330"/>
                <ref-entry baseId="331" id="331"/>
                <ref-entry baseId="332" id="332"/>
                <ref-entry baseId="333" id="333"/>
                <ref-entry baseId="334" id="334"/>
                <ref-entry baseId="335" name="NewAutoText" id="335"/>
                <ref-entry baseId="336" id="336"/>
                <ref-entry baseId="337" name="NewText1" id="337"/>
                <ref-entry baseId="338" id="338"/>
                <ref-entry baseId="339" name="NewAutoText1" id="339"/>
            </overridden-values>
        </simple-master-page>
    </page-setup>
    <body>
        <data id="11878">
            <property name="fontSize">medium</property>
            <property name="fontWeight">bold</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">Column Binding</property>
                    <expression name="expression">if ( params["mroSite"] == 1 ) {
     "Загрузка ЕТБ-Э Октябрьской ЖД";
} else if ( params["mroSite"] == 24 ) {
     "Загрузка ЕТБ-Э Горьковской ЖД";
} else if ( params["mroSite"] == 61 ) {
     "Загрузка ЕТБ-Э Приволжской ЖД";
} else if ( params["mroSite"] == 10 ) {
     "Загрузка ЕТБ-Э Калининградской ЖД";
} else if ( params["mroSite"] == 17 ) {
     "Загрузка ЕТБ-Э Московской ЖД";
} else if ( params["mroSite"] == 28 ) {
     "Загрузка ЕТБ-Э Северной ЖД";
} else if ( params["mroSite"] == 51 ) {
     "Загрузка ЕТБ-Э Северо-Кавказской ЖД";
} else if ( params["mroSite"] == 58 ) {
     "Загрузка ЕТБ-Э Юго-Восточной ЖД";
} else if ( params["mroSite"] == 63 ) {
     "Загрузка ЕТБ-Э Куйбышевской ЖД";
} else if ( params["mroSite"] == 76 ) {
     "Загрузка ЕТБ-Э Свердловской ЖД";
} else if ( params["mroSite"] == 80 ) {
     "Загрузка ЕТБ-Э Южно-Уральской ЖД";
} else if ( params["mroSite"] == 83 ) {
     "Загрузка ЕТБ-Э Западно-Сибирской ЖД";
} else if ( params["mroSite"] == 88 ) {
     "Загрузка ЕТБ-Э Красноярской ЖД";
} else if ( params["mroSite"] == 92 ) {
     "Загрузка ЕТБ-Э Восточно-Сибирской ЖД";
} else if ( params["mroSite"] == 94 ) {
     "Загрузка ЕТБ-Э Забайкальской ЖД";
} else if ( params["mroSite"] == 96 ) {
     "Загрузка ЕТБ-Э Дальневосточной ЖД";
}</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <property name="resultSetColumn">Column Binding</property>
        </data>
        <data id="11880">
            <property name="fontSize">medium</property>
            <property name="fontWeight">bold</property>
            <property name="dataSet">Data Set311</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">DESCRIPTION</property>
                    <property name="displayName">DESCRIPTION</property>
                    <expression name="expression">"На" + dataSetRow["DESCRIPTION"]</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <property name="resultSetColumn">DESCRIPTION</property>
        </data>
        <table id="11672">
            <property name="width">100%</property>
            <property name="dataSet">Data Set3</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">Data Set1::Data Set::LOCATION</property>
                    <property name="displayName">Data Set1::Data Set::LOCATION</property>
                    <expression name="expression">dataSetRow["Data Set1::Data Set::LOCATION"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Data Set1::Data Set::DESCRIPTION</property>
                    <property name="displayName">Data Set1::Data Set::DESCRIPTION</property>
                    <expression name="expression">dataSetRow["Data Set1::Data Set::DESCRIPTION"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Data Set1::Data Set::ITEMNUM</property>
                    <property name="displayName">Data Set1::Data Set::ITEMNUM</property>
                    <expression name="expression">dataSetRow["Data Set1::Data Set::ITEMNUM"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Data Set1::Data Set::ITEMDESC</property>
                    <property name="displayName">Data Set1::Data Set::ITEMDESC</property>
                    <expression name="expression">dataSetRow["Data Set1::Data Set::ITEMDESC"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Data Set1::Data Set::ASSETNUM</property>
                    <property name="displayName">Data Set1::Data Set::ASSETNUM</property>
                    <expression name="expression">dataSetRow["Data Set1::Data Set::ASSETNUM"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Data Set1::Data Set::IDINEXTSYSTEM_ALN</property>
                    <property name="displayName">Data Set1::Data Set::IDINEXTSYSTEM_ALN</property>
                    <expression name="expression">dataSetRow["Data Set1::Data Set::IDINEXTSYSTEM_ALN"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Data Set1::Data Set2::LOCATION</property>
                    <property name="displayName">Data Set1::Data Set2::LOCATION</property>
                    <expression name="expression">dataSetRow["Data Set1::Data Set2::LOCATION"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">Data Set1::Data Set2::ECH</property>
                    <property name="displayName">Data Set1::Data Set2::ECH</property>
                    <expression name="expression">dataSetRow["Data Set1::Data Set2::ECH"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Data Set1::Data Set2::ID_ECH</property>
                    <property name="displayName">Data Set1::Data Set2::ID_ECH</property>
                    <expression name="expression">dataSetRow["Data Set1::Data Set2::ID_ECH"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">Data Set1::Data Set2::PODR</property>
                    <property name="displayName">Data Set1::Data Set2::PODR</property>
                    <expression name="expression">dataSetRow["Data Set1::Data Set2::PODR"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Data Set1::Data Set2::ITEMNUM</property>
                    <property name="displayName">Data Set1::Data Set2::ITEMNUM</property>
                    <expression name="expression">dataSetRow["Data Set1::Data Set2::ITEMNUM"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Data Set1::Data Set2::ID_OBJ</property>
                    <property name="displayName">Data Set1::Data Set2::ID_OBJ</property>
                    <expression name="expression">dataSetRow["Data Set1::Data Set2::ID_OBJ"]</expression>
                    <property name="dataType">decimal</property>
                </structure>
                <structure>
                    <property name="name">Data Set1::Data Set2::IDINEXT</property>
                    <property name="displayName">Data Set1::Data Set2::IDINEXT</property>
                    <expression name="expression">dataSetRow["Data Set1::Data Set2::IDINEXT"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Data Set31::ITEMNUM</property>
                    <property name="displayName">Data Set31::ITEMNUM</property>
                    <expression name="expression">dataSetRow["Data Set31::ITEMNUM"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Data Set31::DESCRIPTION</property>
                    <property name="displayName">Data Set31::DESCRIPTION</property>
                    <expression name="expression">dataSetRow["Data Set31::DESCRIPTION"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">ITEM</property>
                    <property name="displayName">ITEM</property>
                    <expression name="expression">"(" + dataSetRow["ITEM"] + ")"</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">ITEMDESC</property>
                    <property name="displayName">ITEMDESC</property>
                    <expression name="expression">dataSetRow["ITEMDESC"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Data Set1::Data Set::IDINEXTSYSTEM</property>
                    <property name="displayName">Data Set1::Data Set::IDINEXTSYSTEM</property>
                    <expression name="expression">dataSetRow["Data Set1::Data Set::IDINEXTSYSTEM"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Aggregation</property>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>NewTableGroup1</value>
                    </simple-property-list>
                    <property name="aggregateFunction">COUNT</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">row["Data Set1::Data Set::IDINEXTSYSTEM_ALN"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">Aggregation_1</property>
                    <property name="dataType">integer</property>
                    <property name="aggregateFunction">COUNT</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">row["Data Set1::Data Set::IDINEXTSYSTEM_ALN"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">Column Binding</property>
                    <expression name="expression">if (row["Data Set1::Data Set::IDINEXTSYSTEM_ALN"] == null) ("Не загружен")
else ("Лишний")</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <column id="11761"/>
            <column id="11762"/>
            <column id="11763"/>
            <column id="11764"/>
            <column id="11765"/>
            <group id="11807">
                <property name="groupName">NewTableGroup1</property>
                <property name="interval">none</property>
                <property name="sortDirection">asc</property>
                <expression name="keyExpr">row["ITEM"]</expression>
                <structure name="toc">
                    <expression name="expressionValue">row["ITEM"]</expression>
                </structure>
                <property name="repeatHeader">true</property>
                <property name="hideDetail">false</property>
                <property name="pageBreakAfter">auto</property>
                <property name="pageBreakBefore">auto</property>
                <property name="pageBreakInside">auto</property>
                <header>
                    <row id="11808">
                        <cell id="11809">
                            <data id="11742">
                                <property name="fontSize">small</property>
                                <property name="fontWeight">bold</property>
                                <property name="resultSetColumn">ITEMDESC</property>
                            </data>
                        </cell>
                        <cell id="11810">
                            <data id="11836">
                                <property name="fontSize">small</property>
                                <property name="fontWeight">bold</property>
                                <property name="resultSetColumn">ITEM</property>
                            </data>
                        </cell>
                        <cell id="11811"/>
                        <cell id="11812"/>
                        <cell id="11813"/>
                    </row>
                    <row id="11847">
                        <cell id="11848">
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <label id="11862">
                                <property name="fontWeight">bold</property>
                                <property name="textAlign">center</property>
                                <text-property name="text">ID актива в ЕТБ</text-property>
                            </label>
                        </cell>
                        <cell id="11849">
                            <property name="colSpan">2</property>
                            <property name="rowSpan">1</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <label id="11863">
                                <property name="fontWeight">bold</property>
                                <property name="textAlign">center</property>
                                <text-property name="text">ID во внешней системе</text-property>
                            </label>
                        </cell>
                        <cell id="11877">
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <label id="11867">
                                <property name="fontWeight">bold</property>
                                <property name="textAlign">center</property>
                                <text-property name="text">ID актива в АСУЭ</text-property>
                            </label>
                        </cell>
                        <cell id="11852">
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <label id="11875">
                                <property name="fontWeight">bold</property>
                                <property name="textAlign">center</property>
                                <text-property name="text">Комментарий</text-property>
                            </label>
                        </cell>
                    </row>
                </header>
                <footer>
                    <row id="11822">
                        <cell id="11823"/>
                        <cell id="11824"/>
                        <cell id="11825"/>
                        <cell id="11826"/>
                        <cell id="11827"/>
                    </row>
                </footer>
            </group>
            <detail>
                <row id="11708">
                    <cell id="11709">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="11718">
                            <property name="resultSetColumn">Data Set1::Data Set::ASSETNUM</property>
                        </data>
                    </cell>
                    <cell id="11711">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="11720">
                            <property name="resultSetColumn">Data Set1::Data Set::IDINEXTSYSTEM_ALN</property>
                        </data>
                    </cell>
                    <cell id="11713">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="11734">
                            <property name="resultSetColumn">Data Set1::Data Set2::IDINEXT</property>
                        </data>
                    </cell>
                    <cell id="11715">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="11732">
                            <property name="resultSetColumn">Data Set1::Data Set2::ID_OBJ</property>
                        </data>
                    </cell>
                    <cell id="11717">
                        <property name="borderBottomColor">#000000</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">thin</property>
                        <property name="borderLeftColor">#000000</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">thin</property>
                        <property name="borderRightColor">#000000</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">thin</property>
                        <property name="borderTopColor">#000000</property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">thin</property>
                        <data id="11876">
                            <property name="resultSetColumn">Column Binding</property>
                        </data>
                    </cell>
                </row>
            </detail>
            <footer>
                <row id="11743">
                    <cell id="11744"/>
                    <cell id="11745"/>
                    <cell id="11746"/>
                    <cell id="11747"/>
                    <cell id="11748"/>
                </row>
            </footer>
        </table>
    </body>
</report>
