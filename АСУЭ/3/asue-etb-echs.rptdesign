<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.17" id="1">
    <property name="createdBy">Eclipse BIRT Designer Version 2.3.2.r232_20090202 Build &lt;2.3.2.v20090218-0730></property>
    <property name="units">in</property>
    <property name="comments">IBM Confidential

OCO Source Materials

5724-M19

(C) COPYRIGHT IBM CORP. 2006

The source code for this program is not published or otherwise
divested of its trade secrets, irrespective of what has been
deposited with the U.S. Copyright Office.</property>
    <html-property name="description">This template will create a report with one or more groups, each having identical data fields, and contains three styles of charts.</html-property>
    <list-property name="userProperties">
        <structure>
            <property name="name">Data Cube.1.x</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.1.y</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.1.width</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.1.height</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set1.x</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set1.y</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set1.width</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set1.height</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.webservice.x</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.webservice.y</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.webservice.width</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.webservice.height</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set5.x</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set5.y</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set5.width</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.Data Set5.height</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
    </list-property>
    <property name="Data Cube.1.x">135</property>
    <property name="Data Cube.1.y">59</property>
    <property name="Data Cube.1.width">150</property>
    <property name="Data Cube.1.height">200</property>
    <property name="Data Cube.Data Set1.x">106</property>
    <property name="Data Cube.Data Set1.y">37</property>
    <property name="Data Cube.Data Set1.width">150</property>
    <property name="Data Cube.Data Set1.height">200</property>
    <property name="Data Cube.webservice.x">85</property>
    <property name="Data Cube.webservice.y">72</property>
    <property name="Data Cube.webservice.width">150</property>
    <property name="Data Cube.webservice.height">200</property>
    <property name="Data Cube.Data Set5.x">123</property>
    <property name="Data Cube.Data Set5.y">103</property>
    <property name="Data Cube.Data Set5.width">150</property>
    <property name="Data Cube.Data Set5.height">200</property>
    <list-property name="propertyBindings">
        <structure>
            <property name="name">odaURL</property>
            <property name="id">9434</property>
            <expression name="value">var siteid = "";
siteid = (params["mroSite"]);
if (siteid == "10") 
{ "jdbc:inetdae7a:10.10.1.120:1433" }
else if (siteid == "17") 
{ "jdbc:inetdae7a:10.23.250.56:1433" }
else if (siteid == "24") 
{ "jdbc:inetdae7a:10.24.223.234:1433" }
else if (siteid == "28") 
{ "jdbc:inetdae7a:10.43.195.99:1433" }
else if (siteid == "51") 
{ "jdbc:inetdae7a:10.51.5.67:1433" }
else if (siteid == "58") 
{ "jdbc:inetdae7a:10.58.1.198:1433" }
else if (siteid == "63") 
{ "jdbc:inetdae7a:10.64.24.179:1433" }
else if (siteid == "76") 
{ "jdbc:inetdae7a:10.76.0.129:1433" }
else if (siteid == "80") 
{ "jdbc:inetdae7a:10.81.28.126:1433" }
else if (siteid == "83") 
{ "jdbc:inetdae7a:10.132.71.29:1433" }
else if (siteid == "88") 
{ "jdbc:inetdae7a:10.89.250.175:1433" }
else if (siteid == "92") 
{ "jdbc:inetdae7a:10.111.24.226:1433" }
else if (siteid == "94") 
{ "jdbc:inetdae7a:10.123.169.124:1433" }
else if (siteid == "96") 
{ "jdbc:inetdae7a:10.99.253.180:1433" }
else { " - " }</expression>
        </structure>
        <structure>
            <property name="name">odaUser</property>
            <property name="id">9434</property>
            <expression name="value">var siteid = "";
siteid = (params["mroSite"]);
if (siteid == "10") 
{ "asui" }
else if (siteid == "17") 
{ "ocrv" }
else if (siteid == "24") 
{ "trset" }
else if (siteid == "28") 
{ "asui" }
else if (siteid == "51") 
{ "ASUEOCSKZD" }
else if (siteid == "58") 
{ "ASUE_OCRV" }
else if (siteid == "63") 
{ "ekasui" }
else if (siteid == "76") 
{ "asui" }
else if (siteid == "80") 
{ "chel" }
else if (siteid == "83") 
{ "asui" }
else if (siteid == "88") 
{ "asui" }
else if (siteid == "92") 
{ "asui" }
else if (siteid == "94") 
{ "asui" }
else if (siteid == "96") 
{ "asui" }
else { " - " }</expression>
        </structure>
        <structure>
            <property name="name">odaPassword</property>
            <property name="id">9434</property>
            <expression name="value">var siteid = "";
siteid = (params["mroSite"]);
if (siteid == "10") 
{ "asui" }
else if (siteid == "17") 
{ "ocrvuser" }
else if (siteid == "24") 
{ "tr_set" }
else if (siteid == "28") 
{ "asui" }
else if (siteid == "51") 
{ "As16Eo98Z45" }
else if (siteid == "58") 
{ "D2_12345678" }
else if (siteid == "63") 
{ "ekasui" }
else if (siteid == "76") 
{ "asui" }
else if (siteid == "80") 
{ "chelchel" }
else if (siteid == "83") 
{ "asui" }
else if (siteid == "88") 
{ "asui" }
else if (siteid == "92") 
{ "asui" }
else if (siteid == "94") 
{ "ZrwElectro-75" }
else if (siteid == "96") 
{ "asui96" }
else { " - " }</expression>
        </structure>
    </list-property>
    <method name="initialize"><![CDATA[importPackage(Packages.com.ibm.tivoli.maximo.report.script);

mxReportScriptContext = MXReportScriptContext.initialize(reportContext);
mxReportScriptContext.setDefaultLogLevel("DEBUG");
mxReportScriptContext.setDefaultLogFile("c:/temp/tetttt.txt");

]]></method>
    <method name="afterFactory"><![CDATA[MXReportScriptContext.close();]]></method>
    <property name="theme">MaximoSystemLibrary.maximoTheme</property>
    <text-property name="displayName">Tivoli Maximo Grouped Chart Template</text-property>
    <property name="bidiLayoutOrientation">ltr</property>
    <list-property name="libraries">
        <structure>
            <property name="fileName">MaximoSystemLibrary.rptlibrary</property>
            <property name="namespace">MaximoSystemLibrary</property>
        </structure>
    </list-property>
    <parameters>
        <scalar-parameter name="where" id="25">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <property name="defaultValue">1=1</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="appname" id="240">
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="paramdelimiter" id="241">
            <property name="hidden">true</property>
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="paramstring" id="242">
            <property name="hidden">true</property>
            <property name="valueType">static</property>
            <property name="dataType">string</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="mroSite" id="10179">
            <property name="valueType">static</property>
            <property name="dataType">integer</property>
            <property name="paramType">simple</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="ech" id="10182">
            <property name="valueType">static</property>
            <property name="dataType">integer</property>
            <property name="paramType">simple</property>
            <property name="isRequired">false</property>
            <property name="controlType">text-box</property>
            <property name="distinct">true</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <script-data-source name="maximoDataSource" id="64" extends="MaximoSystemLibrary.maximoDataSource"/>
        <oda-data-source extensionID="org.eclipse.birt.report.data.oda.jdbc" name="Data Source" id="9434">
            <property name="odaDriverClass">com.inet.tds.TdsDriver</property>
            <property name="odaURL">jdbc:inetdae7a:10.32.1.223:1433</property>
            <property name="odaUser">asui</property>
            <encrypted-property name="odaPassword" encryptionID="base64">YXN1aQ==</encrypted-property>
            <property name="odaJndiName">com.inet.tds.TdsDriver</property>
        </oda-data-source>
    </data-sources>
    <data-sets>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="Data Set2" id="9435">
            <list-property name="computedColumns">
                <structure>
                    <property name="name">JOI</property>
                    <expression name="expression">row["LOCATION"]+row["ITEMNUM"]</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">LOCATION</property>
                    <property name="displayName">LOCATION</property>
                </structure>
                <structure>
                    <property name="columnName">ECH</property>
                    <property name="displayName">ECH</property>
                </structure>
                <structure>
                    <property name="columnName">ID_ECH</property>
                    <property name="displayName">ID_ECH</property>
                </structure>
                <structure>
                    <property name="columnName">PODR</property>
                    <property name="displayName">PODR</property>
                </structure>
                <structure>
                    <property name="columnName">ITEMNUM</property>
                    <property name="displayName">ITEMNUM</property>
                </structure>
                <structure>
                    <property name="columnName">COUNT</property>
                    <property name="displayName">COUNT</property>
                </structure>
                <structure>
                    <property name="columnName">JOI</property>
                    <property name="displayName">JOI</property>
                </structure>
            </list-property>
            <list-property name="filter">
                <structure>
                    <property name="operator">is-not-null</property>
                    <expression name="expr">row["LOCATION"]</expression>
                </structure>
                <structure>
                    <property name="operator">eq</property>
                    <expression name="expr">row["ID_ECH"]</expression>
                    <simple-property-list name="value1">
                        <value>params["ech"].value</value>
                    </simple-property-list>
                </structure>
                <structure>
                    <property name="operator">eq</property>
                    <expression name="expr">if (row["PODR"].substring(0,3)== 'ЭЧС') (1)
else if (row["PODR"].substring(0,2)== 'МП') (1)
else (0)</expression>
                    <simple-property-list name="value1">
                        <value>1</value>
                    </simple-property-list>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">LOCATION</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">ECH</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">ID_ECH</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">PODR</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">COUNT</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">JOI</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data Source</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">LOCATION</property>
                    <property name="nativeName">LOCATION</property>
                    <property name="dataType">integer</property>
                    <property name="nativeDataType">4</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">ECH</property>
                    <property name="nativeName">ECH</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">ID_ECH</property>
                    <property name="nativeName">ID_ECH</property>
                    <property name="dataType">integer</property>
                    <property name="nativeDataType">4</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">PODR</property>
                    <property name="nativeName">PODR</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">ITEMNUM</property>
                    <property name="nativeName">ITEMNUM</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">COUNT</property>
                    <property name="nativeName">COUNT</property>
                    <property name="dataType">integer</property>
                    <property name="nativeDataType">4</property>
                </structure>
            </list-property>
            <property name="queryText">--Вывод Дополнительный провод(Additional_Wires)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
from (
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH, d.name AS PODR,'ДОП_ПРОВ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Additional_Wires A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_DRIVINGS,0) is not null
group by D.ID_REC,D.name, E.name, E.ID_REC
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ДОП_ПРОВ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Additional_Wires A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_STATION,0) is not null and NULLIF(B.ID_DRIVINGS,0) is null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Воздушных стрелок (Air_Arrows)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ВОЗДУШ_СТРЕЛКИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Air_Arrows A
Left JOIN Drivings_ECHK b ON a.id_drivings = b.id_rec 
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_DRIVINGS,0) is not null
group by C.ID_REC,C.name, D.name, D.ID_REC
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ВОЗДУШ_СТРЕЛКИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Air_Arrows A 
Left JOIN Station_ECHK b ON a.id_station = b.id_rec
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_STATION,0) is not null and NULLIF(a.ID_DRIVINGS,0) is null
GROUP BY c.id_rec,c.name, d.name, d.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Пересечения (Air_intersections)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ПЕРЕСЕЧЕНИЯ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Air_intersections A
Left JOIN Drivings_ECHK b ON a.id_drivings = b.id_rec 
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_DRIVINGS,0) is not null
group by C.ID_REC,C.name, D.name, D.ID_REC
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ПЕРЕСЕЧЕНИЯ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Air_intersections A 
Left JOIN Station_ECHK b ON a.id_station = b.id_rec
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_STATION,0) is not null and NULLIF(a.ID_DRIVINGS,0) is null
GROUP BY c.id_rec,c.name, d.name, d.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод ВЛ(Air_Lines)
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'ВОЗД_ЛИНИИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Air_Lines A 
Left JOIN ECHK b ON b.id_rec = a.id_ECHK
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.ID_ECHK is not null
and (nullif(a.location_station1,0) is not null
OR NULLIF(A.LOCATION_STATION2,0) IS NOT NULL)
GROUP BY b.id_rec,b.name,c.name, c.id_rec
union all
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'ВОЗД_ЛИНИИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Air_Lines A 
Left JOIN ECHS b ON b.id_rec = a.id_ECHS
Left JOIN ECH c ON c.id_rec = b.id_parent
WHERE A.ID_ECHS IS NOT NULL
and (nullif(a.location_station1,0) is not null
or nullif(a.location_station2,0) is not null)
GROUP BY b.id_rec,b.name,c.name, c.id_rec
union all
--Вывод Выключатель постоянного тока (Breaker_Const)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ВЫКЛ_ПОСТ_ТОКА' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Breaker_Const a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
LEFT JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null 
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'ВЫКЛ_ПОСТ_ТОКА' AS ITEMNUM, Count(A.id_rec) AS COUNT
from Breaker_Const a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null
GROUP BY d.id_rec, c.name,d.name, c.id_rec
union all
--Вывод Выключатель переменного тока(Breaker_Variable)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ВЫКЛ_ПЕР_ТОКА' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Breaker_Variable a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ВЫКЛ_ПЕР_ТОКА' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Breaker_Variable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ВЫКЛ_ПЕР_ТОКА' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Breaker_Variable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ВЫКЛ_ПЕР_ТОКА' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Breaker_Variable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'ВЫКЛ_ПЕР_ТОКА' AS ITEMNUM, Count(A.id_rec) AS COUNT
from Breaker_Variable a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null
GROUP BY d.id_rec, c.NAME, d.NAME, c.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Контрольный кабель(Cable и Cable2)

SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'КОНТР_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Cable a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null and a.PURPOSE =3
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОНТР_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null and a.PURPOSE =3
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОНТР_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null and a.PURPOSE =3
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОНТР_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null and a.PURPOSE =3
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'КОНТР_КАБЕЛ' AS ITEMNUM, Count(A.id_rec) AS COUNT
from Cable a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null and a.PURPOSE =3
GROUP BY d.id_rec, c.NAME, d.NAME, c.id_rec
--Cable2
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'КОНТР_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cable2 A 
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where B.ID_ECHK is not null and a.PURPOSE =3
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'КОНТР_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cable2 A 
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where B.ID_ECHS is not null and a.PURPOSE =3
GROUP BY c.id_rec, d.name, c.name,  d.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОНТР_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cable2 A
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null and a.PURPOSE =3
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОНТР_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cable2 A
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null and a.PURPOSE =3
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
--Вывод Силовой кабель(Cable и Cable2)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'СИЛ_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Cable a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null and a.PURPOSE =2
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'СИЛ_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null and a.PURPOSE =2
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'СИЛ_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null and a.PURPOSE =2
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'СИЛ_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null and a.PURPOSE =2
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'СИЛ_КАБЕЛ' AS ITEMNUM, Count(A.id_rec) AS COUNT
from Cable a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null and a.PURPOSE =2
GROUP BY d.id_rec, c.NAME, d.NAME, c.id_rec
--Cable2
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'СИЛ_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cable2 A 
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where B.ID_ECHK is not null and a.PURPOSE =2
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'СИЛ_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cable2 A 
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where B.ID_ECHS is not null and a.PURPOSE =2
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'СИЛ_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cable2 A
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null and a.PURPOSE =2
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'СИЛ_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cable2 A
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null and a.PURPOSE =2
GROUP BY e.id_rec,f.name,e.name, f.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Высоковольтный кабель(Cable и Cable2)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Cable a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null and a.PURPOSE =1
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null and a.PURPOSE =1
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null and a.PURPOSE =1
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Cable a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null and a.PURPOSE =1
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM, Count(A.id_rec) AS COUNT
from Cable a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null and a.PURPOSE =1
GROUP BY d.id_rec, c.NAME, d.NAME, c.id_rec
--Cable2
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cable2 A 
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where B.ID_ECHK is not null and a.PURPOSE =1
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cable2 A 
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where B.ID_ECHS is not null and a.PURPOSE =1
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cable2 A
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null and a.PURPOSE =1
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ВЫСОКОВОЛ_КАБЕЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cable2 A
Left JOIN Cable_Lines b ON b.id_rec = a.id_cableline
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null and a.PURPOSE =1
GROUP BY e.id_rec,f.name,e.name, f.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Кабельные вставки(Cable_Insertions)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'КАБ_ВСТАВ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cable_Insertions A
inner JOIN Air_Lines b ON b.id_rec=a.id_airline 
      and (nullif(b.location_station1,0) is not null
      or nullif(b.location_station2,0) is not null)
      AND b.ID_ECHK IS NOT NULL
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_AIRLINE is not null 
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'КАБ_ВСТАВ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cable_Insertions A
inner JOIN Air_Lines b ON b.id_rec=a.id_airline 
      and (nullif(b.location_station1,0) is not null
      or nullif(b.location_station2,0) is not null)
      AND b.ID_ECHS IS NOT NULL
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_AIRLINE is not null 
GROUP BY  c.id_rec,c.name, d.name, d.id_rec
union all
--Вывод Кабельные линии(Cable_Lines)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'КАБ_ЛИНИИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cable_Lines A 
Left JOIN ECHK b ON b.id_rec = a.id_ECHK
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.ID_ECHK is not null
    and (nullif(name_station1,0) is not null 
    OR NULLIF(NAME_STATION2,0) IS NOT NULL)

GROUP BY b.id_rec,b.name,c.name, c.id_rec
union all
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'КАБ_ЛИНИИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cable_Lines A 
Left JOIN ECHS b ON b.id_rec = a.id_ECHS
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.ID_ECHS is not null
    and (nullif(name_station1,0) is not null 
    OR NULLIF(NAME_STATION2,0) IS NOT NULL)

GROUP BY b.id_rec,b.name,c.name, c.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КАБ_ЛИНИИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cable_Lines A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_DRIVINGS,0) is not null and a.ID_ECHK is null and a.ID_ECHK is null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КАБ_ЛИНИИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cable_Lines A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_STATION,0) is not null and NULLIF(B.ID_DRIVINGS,0) is null and a.ID_ECHK is null and a.ID_ECHK is null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Кабельные муфты(Cables_Muffs)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'КАБ_МУФ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cables_Muffs A
Left JOIN Air_Lines b ON b.id_rec=a.id_airline
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_AIRLINE is not null and ID_ECHK is not null
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'КАБ_МУФ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cables_Muffs A
Left JOIN Air_Lines b ON b.id_rec=a.id_airline
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_AIRLINE is not null and ID_ECHS is not null 
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КАБ_МУФ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Cables_Muffs a
Left JOIN Cable b ON b.id_rec = a.id_cable
Left JOIN Distributing_Devices c ON c.id_rec = b.id_device
Left JOIN ECHE d ON c.id_parent = d.id_rec
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_DEVICE is not null and a.ID_CABLE is not null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
union all
--Device2
SELECT f.id_rec AS LOCATION,g.name AS ECH, g.id_rec as ID_ECH, f.name AS PODR,'КАБ_МУФ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Cables_Muffs a
Left JOIN Cable b ON b.id_rec = a.id_cable
Left JOIN Distributing_Devices2 c ON c.id_rec = b.id_device2
Left JOIN Gen_Inf_TP d ON c.id_parent = d.id_echs
Left JOIN TP_Echs e ON d.id_echs = e.id_rec
Left JOIN Echs f ON f.id_rec = e.id_echs
Left JOIN ECH g ON g.id_rec = f.id_parent
where B.ID_DEVICE2 is not null and NULLIF(E.ID_ECHS,0) is not null and NULLIF(E.ID_ECHK,0) is null and NULLIF(E.ID_ECHE,0) is null and a.ID_CABLE is not null
GROUP BY f.id_rec,g.name, f.name, g.id_rec
union all
SELECT f.id_rec AS LOCATION,g.name AS ECH, g.id_rec as ID_ECH,f.name AS PODR,'КАБ_МУФ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Cables_Muffs a
Left JOIN Cable b ON b.id_rec = a.id_cable
Left JOIN Distributing_Devices2 c ON c.id_rec = b.id_device2
Left JOIN Gen_Inf_TP d ON c.id_parent = d.id_echs
Left JOIN TP_Echs e ON d.id_echs = e.id_rec
Left JOIN ECHK f ON f.id_rec = e.id_ECHK
Left JOIN ECH g ON g.id_rec = f.id_parent
where B.ID_DEVICE2 is not null and NULLIF(E.ID_ECHK,0) is not null and NULLIF(E.ID_ECHS,0) is null and NULLIF(E.ID_ECHE,0) is null and a.ID_CABLE is not null
GROUP BY f.id_rec,g.name, f.name, g.id_rec
union all
SELECT f.id_rec AS LOCATION,g.name AS ECH, g.id_rec as ID_ECH,f.name AS PODR,'КАБ_МУФ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Cables_Muffs a
Left JOIN Cable b ON b.id_rec = a.id_cable
Left JOIN Distributing_Devices2 c ON c.id_rec = b.id_device2
Left JOIN Gen_Inf_TP d ON c.id_parent = d.id_echs
Left JOIN TP_Echs e ON d.id_echs = e.id_rec
Left JOIN EchE f ON f.id_rec = e.id_echE
Left JOIN ECH g ON g.id_rec = f.id_parent
where B.ID_DEVICE2 is not null and NULLIF(E.ID_ECHE,0) is not null and NULLIF(E.ID_ECHK,0) is null and NULLIF(E.ID_ECHS,0) is null and a.ID_CABLE is not null
GROUP BY f.id_rec,g.name, f.name, g.id_rec
union all
--object
SELECT e.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,e.NAME AS PODR,'КАБ_МУФ' AS ITEMNUM, Count(A.id_rec) AS COUNT
from Cables_Muffs a
Left JOIN Cable b ON b.id_rec = a.id_cable
Left JOIN Line_Objects c ON c.id_rec = b.id_object
Left JOIN ECH d ON d.id_rec = c.id_parent
LEFT JOIN ECHE e ON e.id_rec = c.belong_ECHE
where B.ID_OBJECT is not null and a.ID_CABLE2 is not null
GROUP BY e.id_rec, d.NAME, e.NAME, d.id_rec
--Cable2
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КАБ_МУФ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cables_Muffs A 
Left JOIN Cable2 b ON b.id_rec = a.id_cable2
Left JOIN Cable_Lines c ON c.id_rec = b.id_cableline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where C.ID_ECHK is not null and a.ID_CABLE2 is not null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КАБ_МУФ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cables_Muffs A 
Left JOIN Cable2 b ON b.id_rec = a.id_cable2
Left JOIN Cable_Lines c ON c.id_rec = b.id_cableline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where C.ID_ECHS is not null and a.ID_CABLE2 is not null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
union all
SELECT f.id_rec AS LOCATION,g.name AS ECH, g.id_rec as ID_ECH,f.name AS PODR,'КАБ_МУФ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cables_Muffs A
Left JOIN Cable2 b ON b.id_rec = a.id_cable2
Left JOIN Cable_Lines c ON c.id_rec = b.id_cableline
Left JOIN Ways d ON c.id_way = d.id_rec 
Left JOIN Drivings_ECHK e ON d.id_drivings = e.id_rec 
Left JOIN ECHK f ON f.id_rec = e.id_ECHK
Left JOIN ECH g ON g.id_rec = f.id_parent
where NULLIF(D.ID_DRIVINGS,0) is not null and a.ID_CABLE2 is not null
GROUP BY f.id_rec,g.name, f.name, g.id_rec
union all
SELECT f.id_rec AS LOCATION,g.name AS ECH, g.id_rec as ID_ECH,f.name AS PODR,'КАБ_МУФ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cables_Muffs A
Left JOIN Cable2 b ON b.id_rec = a.id_cable2
Left JOIN Cable_Lines c ON c.id_rec = b.id_cableline
Left JOIN Ways d ON c.id_way = d.id_rec 
Left JOIN Station_ECHK e ON d.id_station = e.id_rec
Left JOIN ECHK f ON f.id_rec = e.id_ECHK
Left JOIN ECH g ON g.id_rec = f.id_parent
where NULLIF(D.ID_STATION,0) is not null and NULLIF(D.ID_DRIVINGS,0) is null and a.ID_CABLE2 is not null
GROUP BY f.id_rec,g.name, f.name, g.id_rec
union all
--Add_ware 
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КАБ_МУФ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cables_Muffs A
Left JOIN Additional_Wires b ON a.id_add = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null and a.ID_ADD is not null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КАБ_МУФ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Cables_Muffs A
Left JOIN Additional_Wires b ON a.id_add = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null and a.ID_ADD is not null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Компенсирующее устройство (Compensating_Devices)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'КОМП_УСТР' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Compensating_Devices a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'КОМП_УСТР' AS ITEMNUM, Count(A.id_rec) AS COUNT
from Compensating_Devices a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null
GROUP BY d.id_rec, c.NAME, d.NAME, c.id_rec
union all
--Вывод Консоли(Console)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОНСОЛЬ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Console A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null
GROUP BY e.id_rec,e.name, f.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОНСОЛЬ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Console A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null
GROUP BY e.id_rec, e.name, f.name, f.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КОНСОЛЬ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Console A
Left JOIN Hard_crossbeams b ON a.zhp = b.id_rec
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_DRIVINGS,0) is not null
GROUP BY d.id_rec, d.name, e.name, e.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КОНСОЛЬ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Console A
Left JOIN Hard_crossbeams b ON a.zhp = b.id_rec
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_STATION,0) is not null and NULLIF(B.ID_DRIVINGS,0) is null
GROUP BY d.id_rec, d.name, e.name, e.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Счетчик электроэнергии(Counters)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'СЧЕТ_Э' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Counters a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'СЧЕТ_Э' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Counters a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'СЧЕТ_Э' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Counters a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'СЧЕТ_Э' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Counters a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'СЧЕТ_Э' AS ITEMNUM, Count(A.id_rec) AS COUNT
from Counters a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null
GROUP BY d.id_rec, c.NAME, d.NAME, c.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Токопровод (Current_Wire)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ТОКОПРОВОД' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Current_Wire a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null
group by C.ID_REC, D.name, C.name, D.ID_REC
union all
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТОКОПРОВОД' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Current_Wire a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТОКОПРОВОД' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Current_Wire a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТОКОПРОВОД' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Current_Wire a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'ТОКОПРОВОД' AS ITEMNUM, Count(A.id_rec) AS COUNT
from Current_Wire a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null
GROUP BY d.id_rec, c.NAME, d.NAME, c.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Дизель-генер(Dies_Gen)
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'ДИЗ_ГЕН' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Dies_Gen A 
Left JOIN ECHE b ON b.id_rec = a.id_parent
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.ID_PARENT is not null 
GROUP BY b.id_rec, c.name, b.name, c.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ДИЗ_ГЕН' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Dies_Gen a
Left JOIN Gen_Inf_TP c ON a.id_tp_echs = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec, e.name, f.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ДИЗ_ГЕН' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Dies_Gen a
Left JOIN Gen_Inf_TP c ON a.id_tp_echs = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec, e.name, f.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ДИЗ_ГЕН' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Dies_Gen a
Left JOIN Gen_Inf_TP c ON a.id_tp_echs = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null
GROUP BY e.id_rec, e.name, f.name, f.id_rec
union all
--Вывод Разрядники(Dischargers)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'РАЗРЯДНИКИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Dischargers A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHK is not null and a.ID_TOWER_AIRLINE is not null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'РАЗРЯДНИКИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Dischargers A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHS is not null and a.ID_TOWER_AIRLINE is not null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'РАЗРЯДНИКИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Dischargers A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'РАЗРЯДНИКИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Dischargers A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'РАЗРЯДНИКИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Dischargers a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'РАЗРЯДНИКИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Dischargers a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'РАЗРЯДНИКИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Dischargers a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'РАЗРЯДНИКИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Dischargers a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'РАЗРЯДНИКИ' AS ITEMNUM, Count(A.id_rec) AS COUNT
from Dischargers a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null
GROUP BY d.id_rec, c.NAME, d.NAME, c.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Разъединители(Disconnectors)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Disconnectors A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHK is not null and a.ID_TOWER_AIRLINE is not null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Disconnectors A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHS is not null and a.ID_TOWER_AIRLINE is not null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Disconnectors A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Disconnectors A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Disconnectors a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
--device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Disconnectors a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Disconnectors a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Disconnectors a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'РАЗЪЕДИНИТЕЛИ' AS ITEMNUM, Count(A.id_rec) AS COUNT
from Disconnectors a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null
GROUP BY d.id_rec, c.NAME, d.NAME, c.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Приводы разъединителей(Drives2)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ПРИВ_РАЗЪЕД' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Drives2 A
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Towers_Airlines c ON b.id_tower_airline = c.id_rec
Left JOIN Air_Lines d ON d.id_rec=c.id_airline
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where C.ID_AIRLINE is not null  and D.ID_ECHK is not null and B.ID_TOWER_AIRLINE is not null and a.ID_DISCONNECTOR is not null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ПРИВ_РАЗЪЕД' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Drives2 A
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Towers_Airlines c ON b.id_tower_airline = c.id_rec
Left JOIN Air_Lines d ON d.id_rec=c.id_airline
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where C.ID_AIRLINE is not null  and D.ID_ECHS is not null and B.ID_TOWER_AIRLINE is not null and a.ID_DISCONNECTOR is not null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT f.id_rec AS LOCATION,g.name AS ECH, g.id_rec as ID_ECH,f.name AS PODR,'ПРИВ_РАЗЪЕД' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Drives2 A
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Towers c ON c.id_rec = b.id_tower
Left JOIN Ways d ON c.id_way = d.id_rec 
Left JOIN Drivings_ECHK e ON d.id_drivings = e.id_rec 
Left JOIN ECHK f ON f.id_rec = e.id_ECHK
Left JOIN ECH g ON g.id_rec = f.id_parent
where NULLIF(D.ID_DRIVINGS,0) is not null and a.ID_DISCONNECTOR is not null
GROUP BY f.id_rec,g.name, f.name, g.id_rec
union all
SELECT f.id_rec AS LOCATION,g.name AS ECH, g.id_rec as ID_ECH,f.name AS PODR,'ПРИВ_РАЗЪЕД' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Drives2 A
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Towers c ON c.id_rec = b.id_tower
Left JOIN Ways d ON c.id_way = d.id_rec 
Left JOIN Station_ECHK e ON d.id_station = e.id_rec
Left JOIN ECHK f ON f.id_rec = e.id_ECHK
Left JOIN ECH g ON g.id_rec = f.id_parent
where NULLIF(D.ID_STATION,0) is not null and NULLIF(D.ID_DRIVINGS,0) is null and a.ID_DISCONNECTOR is not null
GROUP BY f.id_rec,g.name, f.name, g.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ПРИВ_РАЗЪЕД' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Drives2 a
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Distributing_Devices c ON c.id_rec = b.id_device
Left JOIN ECHE d ON c.id_parent = d.id_rec
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_DEVICE is not null and a.ID_DISCONNECTOR is not null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
union all
--Device2
SELECT f.id_rec AS LOCATION,g.name AS ECH, g.id_rec as ID_ECH,f.name AS PODR,'ПРИВ_РАЗЪЕД' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Drives2 a
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Distributing_Devices2 c ON c.id_rec = b.id_device2
Left JOIN Gen_Inf_TP d ON c.id_parent = d.id_echs
Left JOIN TP_Echs e ON d.id_echs = e.id_rec
Left JOIN Echs f ON f.id_rec = e.id_echs
Left JOIN ECH g ON g.id_rec = f.id_parent
where B.ID_DEVICE2 is not null and NULLIF(E.ID_ECHS,0) is not null and NULLIF(E.ID_ECHK,0) is null and NULLIF(E.ID_ECHE,0) is null and a.ID_DISCONNECTOR is not null
GROUP BY f.id_rec,g.name, f.name, g.id_rec
union all
SELECT f.id_rec AS LOCATION,g.name AS ECH, g.id_rec as ID_ECH,f.name AS PODR,'ПРИВ_РАЗЪЕД' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Drives2 a
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Distributing_Devices2 c ON c.id_rec = b.id_device2
Left JOIN Gen_Inf_TP d ON c.id_parent = d.id_echs
Left JOIN TP_Echs e ON d.id_echs = e.id_rec
Left JOIN ECHK f ON f.id_rec = e.id_ECHK
Left JOIN ECH g ON g.id_rec = f.id_parent
where B.ID_DEVICE2 is not null and NULLIF(E.ID_ECHK,0) is not null and NULLIF(E.ID_ECHS,0) is null and NULLIF(E.ID_ECHE,0) is null and a.ID_DISCONNECTOR is not null
GROUP BY f.id_rec,g.name, f.name, g.id_rec
union all
SELECT f.id_rec AS LOCATION,g.name AS ECH, g.id_rec as ID_ECH,f.name AS PODR,'ПРИВ_РАЗЪЕД' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Drives2 a
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Distributing_Devices2 c ON c.id_rec = b.id_device2
Left JOIN Gen_Inf_TP d ON c.id_parent = d.id_echs
Left JOIN TP_Echs e ON d.id_echs = e.id_rec
Left JOIN EchE f ON f.id_rec = e.id_echE
Left JOIN ECH g ON g.id_rec = f.id_parent
where B.ID_DEVICE2 is not null and NULLIF(E.ID_ECHE,0) is not null and NULLIF(E.ID_ECHK,0) is null and NULLIF(E.ID_ECHS,0) is null and a.ID_DISCONNECTOR is not null
GROUP BY f.id_rec,g.name, f.name, g.id_rec
union all
--object
SELECT e.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,e.NAME AS PODR,'ПРИВ_РАЗЪЕД' AS ITEMNUM, Count(A.id_rec) AS COUNT
from Drives2 a
Left JOIN Disconnectors b ON b.id_rec = a.id_disconnector
Left JOIN Line_Objects c ON c.id_rec = b.id_object
Left JOIN ECH d ON d.id_rec = c.id_parent
LEFT JOIN ECHE e ON e.id_rec = c.belong_ECHE
where B.ID_OBJECT is not null and a.ID_DISCONNECTOR is not null
GROUP BY e.id_rec, d.name, e.name, d.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Гибкая поперечина (Flexible_crossbeams)
select list.location, list.ECH, list.ID_ECH, list.PODR, list.ITEMNUM, SUM(list.COUNT) as COUNT 
FROM (
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ГИБК_ПОПЕРЕЧ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Flexible_crossbeams A
Left JOIN Drivings_ECHK b ON a.id_drivings = b.id_rec 
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_DRIVINGS,0) is not null
GROUP BY c.id_rec, c.name, d.name, d.id_rec
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ГИБК_ПОПЕРЕЧ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Flexible_crossbeams A 
Left JOIN Station_ECHK b ON a.id_station = b.id_rec
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_STATION,0) is not null and NULLIF(a.ID_DRIVINGS,0) is null
GROUP BY c.id_rec, c.name, d.name, d.id_rec
) LIST
group by list.location, list.ECH, list.ID_ECH, list.PODR, list.ITEMNUM

union all
--Вывод Трансформаторные подстанции (Gen_Inf_TP)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ТРАНСФ_ПОДСТ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Gen_Inf_TP a
Left JOIN TP_Echs b ON b.id_rec = a.id_echs
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(B.ID_ECHS,0) is not null and NULLIF(B.ID_ECHK,0) is null and NULLIF(B.ID_ECHE,0) is null
      and (nullif(a.location_station1,0) is not null
      OR NULLIF(A.LOCATION_STATION2,0) IS NOT NULL)

GROUP BY c.id_rec, c.name, d.name, d.id_rec
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ТРАНСФ_ПОДСТ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Gen_Inf_TP a
Left JOIN TP_Echs b ON b.id_rec = a.id_echs
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(B.ID_ECHK,0) is not null and NULLIF(B.ID_ECHS,0) is null and NULLIF(B.ID_ECHE,0) is null
      and (nullif(a.location_station1,0) is not null
      OR NULLIF(A.LOCATION_STATION2,0) IS NOT NULL)

GROUP BY c.id_rec, c.name, d.name, d.id_rec
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ТРАНСФ_ПОДСТ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Gen_Inf_TP a
Left JOIN TP_Echs b ON b.id_rec = a.id_echs
Left JOIN ECHE c ON c.id_rec = b.id_eche
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(B.ID_ECHE,0) is not null and NULLIF(B.ID_ECHK,0) is null and NULLIF(B.ID_ECHS,0) is null
GROUP BY c.id_rec, c.name, d.name, d.id_rec
union all
-- Вывод Заземляющее устройство (Ground_Devices)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ЗАЗЕМ_УСТР' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Ground_Devices a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ЗАЗЕМ_УСТР' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Ground_Devices a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ЗАЗЕМ_УСТР' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Ground_Devices a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ЗАЗЕМ_УСТР' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Ground_Devices a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'ЗАЗЕМ_УСТР' AS ITEMNUM, Count(A.id_rec) AS COUNT
from Ground_Devices a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null
GROUP BY d.id_rec, c.NAME, d.NAME, c.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Жесткая поперечина (Hard_crossbeams)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ЖЕСТ_ПОПЕРЕЧ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Hard_crossbeams A
Left JOIN Drivings_ECHK b ON a.id_drivings = b.id_rec 
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_DRIVINGS,0) is not null
GROUP BY c.id_rec, c.name, d.name, d.id_rec
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ЖЕСТ_ПОПЕРЕЧ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Hard_crossbeams A 
Left JOIN Station_ECHK b ON a.id_station = b.id_rec
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_STATION,0) is not null and NULLIF(a.ID_DRIVINGS,0) is null
GROUP BY c.id_rec, c.name, d.name, d.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Шкаф обогрева (Heating_shkaf)
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'ШКАФ_ОБОГР' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Heating_shkaf A 
Left JOIN ECHS b ON b.id_rec = a.id_parent
left join ECH C on C.ID_REC = B.ID_PARENT
GROUP BY b.id_rec, b.name,c.name, c.id_rec
union all
--Вывод Кронштейны(Holders)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КРОНШТЕЙН' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Holders A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null
GROUP BY e.id_rec, e.name, f.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КРОНШТЕЙН' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Holders A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null
GROUP BY e.id_rec, e.name, f.name, f.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КРОНШТЕЙН' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Holders A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null and C.ID_ECHK is not null
GROUP BY d.id_rec, d.name, e.name, e.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КРОНШТЕЙН' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Holders A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null and C.ID_ECHS is not null
GROUP BY  d.id_rec, d.name, e.name, e.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Крючья и штыри(Hooks)
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КШ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Hooks A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null and C.ID_ECHK is not null
GROUP BY  d.id_rec, d.name, e.name, e.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КШ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Hooks A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null and C.ID_ECHS is not null
GROUP BY  d.id_rec, d.name, e.name, e.id_rec
union all
--Вывод Изолирующие сопряжения и нейтральные вставки (Insertions)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ИЗОЛ_СОПР_НЕЙТР_ВСТ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Insertions A
Left JOIN Drivings_ECHK b ON a.id_drivings = b.id_rec 
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_DRIVINGS,0) is not null
GROUP BY c.id_rec, c.name, d.name, d.id_rec
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ИЗОЛ_СОПР_НЕЙТР_ВСТ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Insertions A 
Left JOIN Station_ECHK b ON a.id_station = b.id_rec
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_STATION,0) is not null and NULLIF(a.ID_DRIVINGS,0) is null
GROUP BY c.id_rec, c.name, d.name, d.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Изоляторы в целом(Insulators)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Insulators A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHK is not null and a.ID_TOWER_AIRLINE is not null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Insulators A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHS is not null and a.ID_TOWER_AIRLINE is not null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Insulators A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Insulators A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Insulators A
Left JOIN Flexible_crossbeams b ON a.gp = b.id_rec
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_DRIVINGS,0) is not null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Insulators A
Left JOIN Flexible_crossbeams b ON a.gp = b.id_rec
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_STATION,0) is not null and NULLIF(B.ID_DRIVINGS,0) is null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Insulators A
Left JOIN Hard_crossbeams b ON a.zhp = b.id_rec
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_DRIVINGS,0) is not null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Insulators A
Left JOIN Hard_crossbeams b ON a.zhp = b.id_rec
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_STATION,0) is not null and NULLIF(B.ID_DRIVINGS,0) is null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Insulators a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Insulators a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Insulators a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Insulators a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'ИЗОЛЯТОРЫ' AS ITEMNUM, Count(A.id_rec) AS COUNT
from Insulators a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null
GROUP BY d.id_rec, c.NAME, d.NAME, c.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Освещение(Lamps)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'ОСВЕЩЕНИЕ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Lamps A 
Left JOIN ECHK b ON b.id_rec = a.id_ECHK
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.ID_ECHK is not null and NULLIF(a.ID_MAST,0) is null and a.ID_TOWER_AIRLINE is null and a.ID_ECHS is null and a.ID_ECHE is null
      and (nullif(a.location_station1,0) is not null
      OR NULLIF(A.LOCATION_STATION2,0) IS NOT NULL)

GROUP BY b.id_rec, b.name,c.name, c.id_rec
union all
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'ОСВЕЩЕНИЕ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Lamps A 
Left JOIN ECHS b ON b.id_rec = a.id_ECHS
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.ID_ECHS is not null and NULLIF(a.ID_MAST,0) is null and a.ID_TOWER_AIRLINE is null and a.ID_ECHK is null and a.ID_ECHE is null
      and (nullif(a.location_station1,0) is not null
      OR NULLIF(A.LOCATION_STATION2,0) IS NOT NULL)

GROUP BY b.id_rec, b.name,c.name, c.id_rec
union all
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'ОСВЕЩЕНИЕ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Lamps A 
Left JOIN ECHE b ON b.id_rec = a.id_ECHE
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.ID_ECHE is not null and NULLIF(a.ID_MAST,0) is null and a.ID_TOWER_AIRLINE is null and a.ID_ECHK is null and a.ID_ECHS is null
GROUP BY b.id_rec, b.name,c.name, c.id_rec
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ОСВЕЩЕНИЕ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Lamps A 
Left JOIN Mast b ON b.id_rec = a.id_mast
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where B.ID_ECHK is not null and B.ID_ECHE is null and B.ID_PARENT is null
      and (nullif(a.location_station1,0) is not null
      OR NULLIF(A.LOCATION_STATION2,0) IS NOT NULL)

GROUP BY c.id_rec, c.name, d.name, d.id_rec
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ОСВЕЩЕНИЕ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Lamps A 
Left JOIN Mast b ON b.id_rec = a.id_mast
Left JOIN ECHS c ON c.id_rec = b.id_parent
Left JOIN ECH d ON d.id_rec = c.id_parent
where B.ID_PARENT is not null and B.ID_ECHE is null and B.ID_ECHK is null
      and (nullif(a.location_station1,0) is not null
      OR NULLIF(A.LOCATION_STATION2,0) IS NOT NULL)

GROUP BY c.id_rec, c.name, d.name, d.id_rec
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ОСВЕЩЕНИЕ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Lamps A 
Left JOIN Mast b ON b.id_rec = a.id_mast
Left JOIN ECHE c ON c.id_rec = b.id_eche
Left JOIN ECH d ON d.id_rec = c.id_parent
where B.ID_ECHE is not null and B.ID_PARENT is null and B.ID_ECHK is null
GROUP BY c.id_rec, c.name, d.name, d.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ОСВЕЩЕНИЕ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Lamps A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null and C.ID_ECHK is not null and a.ID_ECHK is null and a.ID_ECHS is null and a.ID_ECHE is null
      and (nullif(a.location_station1,0) is not null
      OR NULLIF(A.LOCATION_STATION2,0) IS NOT NULL)

GROUP BY  d.id_rec, d.name, e.name, e.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ОСВЕЩЕНИЕ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Lamps A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null and C.ID_ECHS is not null and a.ID_ECHK is null and a.ID_ECHS is null and a.ID_ECHE is null
      and (nullif(a.location_station1,0) is not null
      OR NULLIF(A.LOCATION_STATION2,0) IS NOT NULL)

GROUP BY  d.id_rec, d.name, e.name, e.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Прожекторные мачты(Mast)
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'ПРОЖ_МАЧТ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Mast A 
Left JOIN ECHK b ON b.id_rec = a.id_ECHK
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.ID_ECHK is not null
      and (nullif(a.location_station1,0) is not null
      OR NULLIF(A.LOCATION_STATION2,0) IS NOT NULL)

GROUP BY b.id_rec, b.name,c.name, c.id_rec
union all
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'ПРОЖ_МАЧТ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Mast A 
Left JOIN ECHS b ON b.id_rec = a.id_parent
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.ID_PARENT is not null
      and (nullif(a.location_station1,0) is not null
      OR NULLIF(A.LOCATION_STATION2,0) IS NOT NULL)

GROUP BY b.id_rec, b.name,c.name, c.id_rec
union all
SELECT b.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,b.name AS PODR,'ПРОЖ_МАЧТ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Mast A 
Left JOIN ECHE b ON b.id_rec = a.id_ECHE
Left JOIN ECH c ON c.id_rec = b.id_parent
where a.ID_ECHE is not null
GROUP BY b.id_rec, b.name,c.name, c.id_rec
union all
--Вывод Контактные подвески (Podveska)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КОНТ_ПОДВЕС' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Podveska A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_DRIVINGS,0) is not null --and (label_wire1 ='0' and label_wire2 ='0' and type_wire = '0' and type_wire_1 = '0' and type_wire_2 ='0' and type_cable = '0' and type_cable2 = '0')
GROUP BY d.id_rec, d.name, e.name, e.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'КОНТ_ПОДВЕС' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Podveska A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_STATION,0) is not null and NULLIF(B.ID_DRIVINGS,0) is null --and (label_wire1 ='0' and label_wire2 ='0' and type_wire = '0' and type_wire_1 = '0' and type_wire_2 ='0' and type_cable = '0' and type_cable2 = '0')
GROUP BY d.id_rec, d.name, e.name, e.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Секционный изолятор (Sectional_Insulators)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'СЕКЦ_ИЗОЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Sectional_Insulators A
Left JOIN Drivings_ECHK b ON a.id_drivings = b.id_rec 
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_DRIVINGS,0) is not null
GROUP BY c.id_rec, c.name, d.name, d.id_rec
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'СЕКЦ_ИЗОЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Sectional_Insulators A 
Left JOIN Station_ECHK b ON a.id_station = b.id_rec
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where NULLIF(a.ID_STATION,0) is not null and NULLIF(a.ID_DRIVINGS,0) is null
GROUP BY c.id_rec, c.name, d.name, d.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Короткозамыкатели (ShortClosers)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'КОРОТКОЗАМЫКАТЕЛИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from ShortClosers a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null
GROUP BY c.id_rec, c.name, d.name, d.id_rec
union all
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОРОТКОЗАМЫКАТЕЛИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from ShortClosers a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec, e.name, f.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОРОТКОЗАМЫКАТЕЛИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from ShortClosers a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec, e.name, f.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОРОТКОЗАМЫКАТЕЛИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from ShortClosers a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null
GROUP BY e.id_rec, e.name, f.name, f.id_rec
union all
--Вывод Сглаживающие устройства(Smooth_Devices)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'СГЛАЖ_УСТР' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Smooth_Devices a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
left join ECH D on D.ID_REC = C.ID_PARENT
GROUP BY c.id_rec, c.name, d.name, d.id_rec
union all
--Вывод Искровые промежутки(Sparkling_Gaps)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ИСКР_ПРОМ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Sparkling_Gaps A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null
GROUP BY e.id_rec, e.name, f.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ИСКР_ПРОМ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Sparkling_Gaps A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null
GROUP BY e.id_rec, e.name, f.name, f.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Аккумуляторная батарея(Storage_Battery)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'АБ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Storage_Battery a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
left join ECH D on D.ID_REC = C.ID_PARENT
GROUP BY c.id_rec, c.name, d.name, d.id_rec
union all
--Вывод Коммутационная аппаратура (Switchgear)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'КОММ_АПП' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Switchgear a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОММ_АПП' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Switchgear a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОММ_АПП' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Switchgear a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'КОММ_АПП' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Switchgear a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'КОММ_АПП' AS ITEMNUM, Count(A.id_rec) AS COUNT
from Switchgear a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null
GROUP BY d.id_rec, c.NAME, d.NAME, c.id_rec
union all
--Вывод Опоры КС(Towers)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ОПОРЫ_КС' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Towers A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
LEFT JOIN ECHK d ON d.id_rec = c.id_ECHK
LEFT JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_DRIVINGS,0) is not null
GROUP BY d.id_rec, d.name, e.name, e.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ОПОРЫ_КС' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Towers A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
LEFT JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_STATION,0) is not null and NULLIF(B.ID_DRIVINGS,0) is null
GROUP BY d.id_rec, d.NAME, e.NAME, e.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод ОПОРЫ ВЛ(Towers_airlines)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ОПОРЫ_ВЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Towers_airlines A
inner JOIN Air_Lines b ON b.id_rec=a.id_airline 
      and (nullif(b.location_station1,0) is not null
      or nullif(b.location_station2,0) is not null)
      AND b.ID_ECHK IS NOT NULL
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_AIRLINE is not null 
GROUP BY c.id_rec, c.name, d.name, d.id_rec
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ОПОРЫ_ВЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Towers_airlines A
inner JOIN Air_Lines b ON b.id_rec=a.id_airline 
      and (nullif(b.location_station1,0) is not null
      or nullif(b.location_station2,0) is not null)
      AND b.ID_ECHS IS NOT NULL
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_AIRLINE is not null 
GROUP BY c.id_rec, c.name, d.name, d.id_rec
union all
--Вывод ОПОРЫ ДОП ПРОВ(Towers_airlines)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ОПОРЫ_ДОП_ПРОВ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Towers_airlines A
Left JOIN Additional_Wires b ON a.id_add_wire = b.id_rec
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null
GROUP BY e.id_rec, e.name, f.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ОПОРЫ_ДОП_ПРОВ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Towers_airlines A
Left JOIN Additional_Wires b ON a.id_add_wire = b.id_rec
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null
GROUP BY e.id_rec, e.name, f.name, f.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Преобразовательные трансформаторы (Transformer)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ПРЕОБ_ТРАНСФ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Transformer a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
left join ECH D on D.ID_REC = C.ID_PARENT
GROUP BY c.id_rec, c.name, d.name, d.id_rec
union all
--Вывод Трансформатор тока (Transformers_Current)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ТРАНСФ_ТОКА' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Transformers_Current a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТРАНСФ_ТОКА' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Transformers_Current a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТРАНСФ_ТОКА' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Transformers_Current a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТРАНСФ_ТОКА' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Transformers_Current a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'ТРАНСФ_ТОКА' AS ITEMNUM, Count(A.id_rec) AS COUNT
from Transformers_Current a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null
GROUP BY d.id_rec, c.NAME, d.NAME, c.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Выводы Дроссель-трансформатор (Transformers_Suction purpose=11)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ДРОСС_ТРАНСФ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Transformers_Suction A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_DRIVINGS,0) is not null and a.PURPOSE = '11'
GROUP BY d.id_rec, d.name, e.name, e.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ДРОСС_ТРАНСФ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Transformers_Suction A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_STATION,0) is not null and NULLIF(B.ID_DRIVINGS,0) is null and a.PURPOSE = '11'
GROUP BY d.id_rec, d.name, e.name, e.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Выводы Отсасывающий трансформатор(Transformers_Suction purpose=2)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ОТСАСЫВ_ТРАНСФ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Transformers_Suction A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Drivings_ECHK c ON b.id_drivings = c.id_rec 
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_DRIVINGS,0) is not null and a.PURPOSE = '2'
GROUP BY d.id_rec, d.name, e.name, e.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ОТСАСЫВ_ТРАНСФ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Transformers_Suction A
Left JOIN Ways b ON a.id_way = b.id_rec 
Left JOIN Station_ECHK c ON b.id_station = c.id_rec
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where NULLIF(B.ID_STATION,0) is not null and NULLIF(B.ID_DRIVINGS,0) is null and a.PURPOSE = '2'
GROUP BY d.id_rec, d.name, e.name, e.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Трансформаторы напряжения (Transformers_Voltage)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ТРАНС_НАПР' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Transformers_Voltage a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТРАНС_НАПР' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Transformers_Voltage a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТРАНС_НАПР' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Transformers_Voltage a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТРАНС_НАПР' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Transformers_Voltage a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'ТРАНС_НАПР' AS ITEMNUM, Count(A.id_rec) AS COUNT
from Transformers_Voltage a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null
GROUP BY d.id_rec, c.NAME, d.NAME, c.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Трансформаторы и автотрансформаторы силовые(transformers2)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ТРАНС_АВТОТРАНС' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM transformers2 A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHK is not null and a.ID_TOWER_AIRLINE is not null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ТРАНС_АВТОТРАНС' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM transformers2 A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHS is not null and a.ID_TOWER_AIRLINE is not null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ТРАНС_АВТОТРАНС' AS ITEMNUM, Count(a.id_rec) AS COUNT
from transformers2 a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТРАНС_АВТОТРАНС' AS ITEMNUM, Count(a.id_rec) AS COUNT
from transformers2 a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТРАНС_АВТОТРАНС' AS ITEMNUM, Count(a.id_rec) AS COUNT
from transformers2 a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ТРАНС_АВТОТРАНС' AS ITEMNUM, Count(a.id_rec) AS COUNT
from transformers2 a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'ТРАНС_АВТОТРАНС' AS ITEMNUM, Count(A.id_rec) AS COUNT
from transformers2 a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null
GROUP BY d.id_rec, c.NAME, d.NAME, c.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Траверсы(Traverses)
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ТРАВЕРСЫ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Traverses A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null and C.ID_ECHK is not null
GROUP BY  d.id_rec, d.name, e.name, e.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ТРАВЕРСЫ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Traverses A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null and C.ID_ECHS is not null
GROUP BY  d.id_rec, d.name, e.name, e.id_rec
union all
--Вывод Грузокомпенсирующие устройства(Weight_Compensating)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ГРУЗОКОМ_УСТР' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Weight_Compensating A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null
GROUP BY e.id_rec, e.name, f.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ГРУЗОКОМ_УСТР' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Weight_Compensating A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null
GROUP BY e.id_rec, e.name, f.name, f.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Провода воздушных линий(Wires)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ПРОВОДА_ВЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Wires A
inner JOIN Air_Lines b ON b.id_rec=a.id_airline 
      and (nullif(b.location_station1,0) is not null
      or nullif(b.location_station2,0) is not null)
      AND b.ID_ECHK IS NOT NULL
Left JOIN ECHK c ON c.id_rec = b.id_ECHK
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_AIRLINE is not null 
GROUP BY c.id_rec, c.name, d.name, d.id_rec
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ПРОВОДА_ВЛ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Wires A
inner JOIN Air_Lines b ON b.id_rec=a.id_airline 
      and (nullif(b.location_station1,0) is not null
      or nullif(b.location_station2,0) is not null)
      AND b.ID_ECHS IS NOT NULL
Left JOIN ECHS c ON c.id_rec = b.id_ECHS
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_AIRLINE is not null 
GROUP BY c.id_rec, c.name, d.name, d.id_rec
union all
--Вывод ЗПУ (ZPU)
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ЗПУ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from ZPU a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
left join ECH D on D.ID_REC = C.ID_PARENT
GROUP BY c.id_rec, c.name, d.name, d.id_rec
union all
--Вывод Ограничители перенапряжений(OPN)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
FROM (
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ОПН' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM OPN A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHK is not null and a.ID_TOWER_AIRLINE is not null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
union all
SELECT d.id_rec AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH,d.name AS PODR,'ОПН' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM OPN A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHS is not null and a.ID_TOWER_AIRLINE is not null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ОПН' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM OPN A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ОПН' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM OPN A
Left JOIN Towers b ON a.id_tower = b.id_rec 
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT c.id_rec AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH,c.name AS PODR,'ОПН' AS ITEMNUM, Count(a.id_rec) AS COUNT
from OPN a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
--Device2
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ОПН' AS ITEMNUM, Count(a.id_rec) AS COUNT
from OPN a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ОПН' AS ITEMNUM, Count(a.id_rec) AS COUNT
from OPN a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ОПН' AS ITEMNUM, Count(a.id_rec) AS COUNT
from OPN a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
--object
SELECT d.id_rec AS LOCATION,c.name AS ECH, c.id_rec as ID_ECH,d.NAME AS PODR,'ОПН' AS ITEMNUM, Count(A.id_rec) AS COUNT
from OPN a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null
GROUP BY d.id_rec, c.NAME, d.NAME, c.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Электрические соединители (Electric_Connector)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
from (
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ЭЛ_СОЕД' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Electric_Connector A
Left JOIN Podveska b ON a.id_podveska = b.id_rec
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null and (a.PURPOSE =7 or a.PURPOSE = 8)
GROUP BY e.id_rec, e.name, f.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'ЭЛ_СОЕД' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Electric_Connector A
Left JOIN Podveska b ON a.id_podveska = b.id_rec
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null and (a.PURPOSE =7 or a.PURPOSE = 8)
GROUP BY e.id_rec, e.name, f.name, f.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
--Вывод Струны (Electric_Connector)
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
from (
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'СТРУНЫ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Electric_Connector A
Left JOIN Podveska b ON a.id_podveska = b.id_rec
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Drivings_ECHK d ON c.id_drivings = d.id_rec 
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_DRIVINGS,0) is not null and a.PURPOSE not in (7,8)
GROUP BY e.id_rec, e.name, f.name, f.id_rec
union all
SELECT e.id_rec AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,e.name AS PODR,'СТРУНЫ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Electric_Connector A
Left JOIN Podveska b ON a.id_podveska = b.id_rec
Left JOIN Ways c ON b.id_way = c.id_rec 
Left JOIN Station_ECHK d ON c.id_station = d.id_rec
Left JOIN ECHK e ON e.id_rec = d.id_ECHK
Left JOIN ECH f ON f.id_rec = e.id_parent
where NULLIF(C.ID_STATION,0) is not null and NULLIF(C.ID_DRIVINGS,0) is null and a.PURPOSE not in (7,8)
group by E.ID_REC, E.name, F.name, F.ID_REC
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM
union all
SELECT c.id_rec  AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH, c.name AS PODR,'ОПОР_КОНСТР' AS ITEMNUM, Count(a.id_rec) AS COUNT
from support a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
left join ECH D on D.ID_REC = C.ID_PARENT
GROUP BY c.id_rec, c.name, d.name, d.id_rec
union all
SELECT LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM, SUM(LIST.COUNT) AS COUNT 
from (
SELECT  d.id_rec   AS LOCATION, e.name AS ECH, e.id_rec as ID_ECH, d.name AS PODR,'ПРЕДОХРАНИТЕЛИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Fuzes A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHK d ON d.id_rec = c.id_ECHK
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHK is not null and a.ID_TOWER_AIRLINE is not null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
union all
SELECT  d.id_rec  AS LOCATION,e.name AS ECH, e.id_rec as ID_ECH, d.name AS PODR,'ПРЕДОХРАНИТЕЛИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
FROM Fuzes A
Left JOIN Towers_Airlines b ON a.id_tower_airline = b.id_rec
Left JOIN Air_Lines c ON c.id_rec=b.id_airline
Left JOIN ECHS d ON d.id_rec = c.id_ECHS
Left JOIN ECH e ON e.id_rec = d.id_parent
where B.ID_AIRLINE is not null  and C.ID_ECHS is not null and a.ID_TOWER_AIRLINE is not null
GROUP BY d.id_rec,d.name, e.name, e.id_rec
union all
SELECT  c.id_rec   AS LOCATION,d.name AS ECH, d.id_rec as ID_ECH, c.name AS PODR,'ПРЕДОХРАНИТЕЛИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Fuzes a
Left JOIN Distributing_Devices b ON b.id_rec = a.id_device
Left JOIN ECHE c ON b.id_parent = c.id_rec
Left JOIN ECH d ON d.id_rec = c.id_parent
where a.ID_DEVICE is not null
GROUP BY c.id_rec, d.name, c.name, d.id_rec
union all
--Device2
SELECT e.id_rec  AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,  e.name AS PODR,'ПРЕДОХРАНИТЕЛИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Fuzes a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN Echs e ON e.id_rec = d.id_echs
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHS,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT  e.id_rec  AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH,  e.name AS PODR,'ПРЕДОХРАНИТЕЛИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Fuzes a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchK e ON e.id_rec = d.id_echK
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHK,0) is not null and NULLIF(D.ID_ECHS,0) is null and NULLIF(D.ID_ECHE,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
SELECT  e.id_rec   AS LOCATION,f.name AS ECH, f.id_rec as ID_ECH, e.name AS PODR,'ПРЕДОХРАНИТЕЛИ' AS ITEMNUM, Count(a.id_rec) AS COUNT
from Fuzes a
Left JOIN Distributing_Devices2 b ON b.id_rec = a.id_device2
Left JOIN Gen_Inf_TP c ON b.id_parent = c.id_echs
Left JOIN TP_Echs d ON c.id_echs = d.id_rec
Left JOIN EchE e ON e.id_rec = d.id_echE
Left JOIN ECH f ON f.id_rec = e.id_parent
where a.ID_DEVICE2 is not null and NULLIF(D.ID_ECHE,0) is not null and NULLIF(D.ID_ECHK,0) is null and NULLIF(D.ID_ECHS,0) is null
GROUP BY e.id_rec,f.name,e.name, f.id_rec
union all
--object
SELECT  d.id_rec   AS LOCATION, c.NAME AS ECH, c.id_rec as ID_ECH, d.NAME AS PODR,'ПРЕДОХРАНИТЕЛИ' AS ITEMNUM, Count(A.id_rec) AS COUNT
from Fuzes a
LEFT JOIN Line_Objects b ON b.id_rec = A.id_object
LEFT JOIN ECH c ON c.id_rec = b.id_parent
LEFT JOIN ECHE d ON d.id_rec = b.belong_ECHE
where a.ID_OBJECT is not null
GROUP BY d.id_rec, c.NAME, d.NAME, c.id_rec
) LIST
GROUP BY LIST.LOCATION, LIST.ECH, LIST.ID_ECH, LIST.PODR, LIST.ITEMNUM</property>
            <xml-property name="designerValues"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<model:DesignValues xmlns:design="http://www.eclipse.org/datatools/connectivity/oda/design" xmlns:model="http://www.eclipse.org/birt/report/model/adapter/odaModel">
  <Version>1.0</Version>
  <design:ResultSets derivedMetaData="true">
    <design:resultSetDefinitions>
      <design:resultSetColumns>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:name>ECH</design:name>
            <design:position>1</design:position>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>10</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>ECH</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>ECH</design:label>
            <design:formattingHints>
              <design:displaySize>10</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:name>ITEMNUM</design:name>
            <design:position>2</design:position>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>19</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>ITEMNUM</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>ITEMNUM</design:label>
            <design:formattingHints>
              <design:displaySize>19</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:name>COUNT</design:name>
            <design:position>3</design:position>
            <design:nativeDataTypeCode>4</design:nativeDataTypeCode>
            <design:precision>10</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>COUNT</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>COUNT</design:label>
            <design:formattingHints>
              <design:displaySize>4</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
      </design:resultSetColumns>
    </design:resultSetDefinitions>
  </design:ResultSets>
</model:DesignValues>]]></xml-property>
        </oda-data-set>
        <script-data-set name="Data Set" id="9436">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">PODR</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">DESCRIPTION</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">ITEMNUM</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">ITEMDESC</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">CNT</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">JOI</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">PODR</property>
                </structure>
                <structure>
                    <property name="columnName">DESCRIPTION</property>
                </structure>
                <structure>
                    <property name="columnName">ITEMNUM</property>
                </structure>
                <structure>
                    <property name="columnName">ITEMDESC</property>
                </structure>
                <structure>
                    <property name="columnName">CNT</property>
                </structure>
                <structure>
                    <property name="columnName">JOI</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">PODR</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">ITEMDESC</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">CNT</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">JOI</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[maximoDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());
	maximoDataSet.open();
	
	var sqlText = new String();

	sqlText =  " WITH LOCLIST AS ( "
 +" SELECT  LH.LOCATION LOCATION, CONNECT_BY_ROOT LH.PARENT PRED "
 +" FROM MAXIMO.LOCHIERARCHY LH "
 +" INNER JOIN MAXIMO.LOCATIONS L ON LH.LOCATION=L.LOCATION AND L.STATUS='РАБОТАЕТ' AND L.SITEID=LH.siteid "
 +" START WITH  LH.LOCATION='PRED_" +params["ech"]+ "' "
 +"       and LH.systemid='СЭ'  "
 +"       and LH.siteid = " + params["mroSite"]
 +" connect by nocycle  prior LH.location =  LH.parent  "
 +"       AND PRIOR LH.systemid = LH.systemid  "
 +"       AND PRIOR LH.SITEID = LH.SITEID "
 +"       AND SUBSTR(LH.location,1,4) = 'ECHS' "
 +" ), "
 +" LIST AS (  "
 +" SELECT SITEID, ITEMNUM, ASSETNUM,IDINEXTSYSTEM_ALN,IDINEXTSYSTEM, PARENT, CONNECT_BY_ROOT LOCATION AS LOCATION  "
 +" FROM MAXIMO.ASSET  "
 +" START WITH PARENT IS NULL  "
 +"       AND EXTSYSTEMID='3'  "
 +"       AND STATUS='РАБОТАЕТ'  "
 +"       AND SITEID = " + params["mroSite"]
 +"       AND LOCATION IN (SELECT LOCATION FROM LOCLIST WHERE SUBSTR(LOCATION,1,4)='ECHS') "
 +" CONNECT BY NOCYCLE  PRIOR ASSETNUM =  PARENT "
 +"       AND PRIOR SITEID = SITEID "
 +"       AND PRIOR EXTSYSTEMID = EXTSYSTEMID  "
 +"       AND PRIOR STATUS = STATUS  "
 +"   )  "
 +" select   "
 +"  substr(L.LOCATION,9,9) PODR, L3.DESCRIPTION,  "
 +" CASE WHEN PD.ITEMNUM='ДОП_ПРОВ' THEN 'ОПОРЫ_ДОП_ПРОВ' ELSE L.ITEMNUM END ITEMNUM,  "
 +" case when PD.ITEMNUM='ДОП_ПРОВ' then 'Опоры дополнительных проводов' else I.DESCRIPTION end ITEMDESC,  "
 +" COUNT ( distinct L.ASSETNUM) CNT, substr(L.LOCATION,9,9)||CASE WHEN PD.ITEMNUM='ДОП_ПРОВ' THEN 'ОПОРЫ_ДОП_ПРОВ' ELSE L.ITEMNUM END JOI "
 +" FROM LIST L  "
 +" LEFT JOIN MAXIMO.LOCATIONS L3 ON L3.LOCATION=L.LOCATION AND L3.STATUS='РАБОТАЕТ' AND L3.SITEID=L.SITEID  "
 +" LEFT JOIN MAXIMO.ASSET PD ON L.PARENT=PD.ASSETNUM AND L.SITEID=PD.SITEID AND PD.EXTSYSTEMID='3' AND PD.STATUS='РАБОТАЕТ'  "
 +" LEFT JOIN MAXIMO.ITEM I ON I.ITEMNUM=L.ITEMNUM  "
 +"  "
 +" GROUP BY  L.LOCATION,L3.DESCRIPTION, "
 +" CASE WHEN PD.ITEMNUM='ДОП_ПРОВ' THEN 'ОПОРЫ_ДОП_ПРОВ' ELSE L.ITEMNUM END,  "
 +" CASE WHEN PD.ITEMNUM='ДОП_ПРОВ' THEN 'Опоры дополнительных проводов' ELSE I.DESCRIPTION END    "

;

	maximoDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[if (!maximoDataSet.fetch())
	   return (false);

row["PODR"] = maximoDataSet.getString("PODR");
row["DESCRIPTION"] = maximoDataSet.getString("DESCRIPTION");
row["ITEMNUM"] = maximoDataSet.getString("ITEMNUM");
row["ITEMDESC"] = maximoDataSet.getString("ITEMDESC");
row["CNT"] = maximoDataSet.getInteger("CNT");
row["JOI"] = maximoDataSet.getString("JOI");


return (true);]]></method>
        </script-data-set>
        <joint-data-set name="Data Set1" id="9616">
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">Data Set::PODR</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">Data Set::DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">Data Set::ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">Data Set::ITEMDESC</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">Data Set::CNT</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">Data Set::JOI</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">Data Set2::LOCATION</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">Data Set2::ECH</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">Data Set2::ID_ECH</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">10</property>
                        <property name="name">Data Set2::PODR</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">11</property>
                        <property name="name">Data Set2::ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">12</property>
                        <property name="name">Data Set2::COUNT</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">13</property>
                        <property name="name">Data Set2::JOI</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <simple-property-list name="dataSets">
                <value>Data Set</value>
                <value>Data Set2</value>
            </simple-property-list>
            <list-property name="joinConditions">
                <structure>
                    <property name="joinType">full-out</property>
                    <property name="joinOperator">eq</property>
                    <property name="leftDataSet">Data Set</property>
                    <property name="rightDataSet">Data Set2</property>
                    <expression name="leftExpression">dataSetRow["JOI"]</expression>
                    <expression name="rightExpression">dataSetRow["JOI"]</expression>
                </structure>
            </list-property>
        </joint-data-set>
        <script-data-set name="Data Set3" id="9618">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">LOC</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">DESCRIPTION</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">LOC</property>
                </structure>
                <structure>
                    <property name="columnName">DESCRIPTION</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">LOC</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[maximoDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());
	maximoDataSet.open();
	
	var sqlText = new String();

	sqlText =  " select distinct substr(locations.location,9,9) loc, LOCATIONS.DESCRIPTION from MAXIMO.LOCATIONS "
 +" left join MAXIMO.LOCHIERARCHY LH on LOCATIONS.location = LH.location "
 +" where locations.location like 'ECHS%' and lh.parent = 'PRED_"+params["ech"]+"' and locations.siteid = " + params["mroSite"]


;

	maximoDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[if (!maximoDataSet.fetch())
	   return (false);

row["LOC"] = maximoDataSet.getString("LOC");
row["DESCRIPTION"] = maximoDataSet.getString("DESCRIPTION");


return (true);]]></method>
        </script-data-set>
        <script-data-set name="Data Set31" id="9674">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">ITEMNUM</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">DESCRIPTION</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">ITEMNUM</property>
                </structure>
                <structure>
                    <property name="columnName">DESCRIPTION</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[maximoDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());
	maximoDataSet.open();
	
	var sqlText = new String();

	sqlText =  " select distinct asset.itemnum, item.description from maximo.asset "
 +" left join maximo.item on item.itemnum = asset.itemnum "
 +" where extsystemid = 3 "
 +" union all"
 +" select 'ОПОРЫ_ДОП_ПРОВ' itemnum, 'Опоры дополнительных проводов' description from dual "
 +" union all"
 +" select 'ЭЛ_СОЕД' itemnum, 'Электрические соединители' description from dual "

;

	maximoDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[if (!maximoDataSet.fetch())
	   return (false);

row["ITEMNUM"] = maximoDataSet.getString("ITEMNUM");
row["DESCRIPTION"] = maximoDataSet.getString("DESCRIPTION");


return (true);]]></method>
        </script-data-set>
        <joint-data-set name="Data Set4" id="10651">
            <list-property name="computedColumns">
                <structure>
                    <property name="name">ECHE</property>
                    <expression name="expression">if (row["Data Set1::Data Set::DESCRIPTION"] == null) (row["Data Set3::DESCRIPTION"])
else (row["Data Set1::Data Set::DESCRIPTION"])</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">IDECHE</property>
                    <expression name="expression">if (row["Data Set1::Data Set::PODR"] == null) (row["Data Set3::LOC"])
else (row["Data Set1::Data Set::PODR"])</expression>
                    <property name="dataType">integer</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">Data Set1::Data Set::PODR</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">Data Set1::Data Set::DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">Data Set1::Data Set::ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">Data Set1::Data Set::ITEMDESC</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">Data Set1::Data Set::CNT</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">Data Set1::Data Set::JOI</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">Data Set1::Data Set2::LOCATION</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">Data Set1::Data Set2::ECH</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">Data Set1::Data Set2::ID_ECH</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">10</property>
                        <property name="name">Data Set1::Data Set2::PODR</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">11</property>
                        <property name="name">Data Set1::Data Set2::ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">12</property>
                        <property name="name">Data Set1::Data Set2::COUNT</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">13</property>
                        <property name="name">Data Set1::Data Set2::JOI</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">14</property>
                        <property name="name">Data Set3::LOC</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">15</property>
                        <property name="name">Data Set3::DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">16</property>
                        <property name="name">ECHE</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">17</property>
                        <property name="name">IDECHE</property>
                        <property name="dataType">integer</property>
                    </structure>
                </list-property>
            </structure>
            <simple-property-list name="dataSets">
                <value>Data Set1</value>
                <value>Data Set3</value>
            </simple-property-list>
            <list-property name="joinConditions">
                <structure>
                    <property name="joinType">left-out</property>
                    <property name="joinOperator">eq</property>
                    <property name="leftDataSet">Data Set1</property>
                    <property name="rightDataSet">Data Set3</property>
                    <expression name="leftExpression">dataSetRow["Data Set2::LOCATION"]</expression>
                    <expression name="rightExpression">dataSetRow["LOC"]</expression>
                </structure>
            </list-property>
        </joint-data-set>
        <joint-data-set name="Data Set5" id="10652">
            <list-property name="computedColumns">
                <structure>
                    <property name="name">Model</property>
                    <expression name="expression">if (row["Data Set4::Data Set1::Data Set::ITEMDESC"] == null) (row["Data Set31::DESCRIPTION"])
else (row["Data Set4::Data Set1::Data Set::ITEMDESC"])</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">CNT</property>
                    <expression name="expression">if (row["Data Set4::Data Set1::Data Set::CNT"] == null) (0)
else (row["Data Set4::Data Set1::Data Set::CNT"])</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">COUNT</property>
                    <expression name="expression">if (row["Data Set4::Data Set1::Data Set2::COUNT"] == null) (0)
else (row["Data Set4::Data Set1::Data Set2::COUNT"])</expression>
                    <property name="dataType">integer</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">Data Set4::Data Set1::Data Set::PODR</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">Data Set4::Data Set1::Data Set::DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">Data Set4::Data Set1::Data Set::ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">Data Set4::Data Set1::Data Set::ITEMDESC</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">Data Set4::Data Set1::Data Set::CNT</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">Data Set4::Data Set1::Data Set::JOI</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">Data Set4::Data Set1::Data Set2::LOCATION</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">Data Set4::Data Set1::Data Set2::ECH</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">Data Set4::Data Set1::Data Set2::ID_ECH</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">10</property>
                        <property name="name">Data Set4::Data Set1::Data Set2::PODR</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">11</property>
                        <property name="name">Data Set4::Data Set1::Data Set2::ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">12</property>
                        <property name="name">Data Set4::Data Set1::Data Set2::COUNT</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">13</property>
                        <property name="name">Data Set4::Data Set1::Data Set2::JOI</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">14</property>
                        <property name="name">Data Set4::Data Set3::LOC</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">15</property>
                        <property name="name">Data Set4::Data Set3::DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">16</property>
                        <property name="name">Data Set4::ECHE</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">17</property>
                        <property name="name">Data Set4::IDECHE</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">18</property>
                        <property name="name">Data Set31::ITEMNUM</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">19</property>
                        <property name="name">Data Set31::DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">20</property>
                        <property name="name">Model</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">21</property>
                        <property name="name">CNT</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">22</property>
                        <property name="name">COUNT</property>
                        <property name="dataType">integer</property>
                    </structure>
                </list-property>
            </structure>
            <simple-property-list name="dataSets">
                <value>Data Set4</value>
                <value>Data Set31</value>
            </simple-property-list>
            <list-property name="joinConditions">
                <structure>
                    <property name="joinType">left-out</property>
                    <property name="joinOperator">eq</property>
                    <property name="leftDataSet">Data Set4</property>
                    <property name="rightDataSet">Data Set31</property>
                    <expression name="leftExpression">dataSetRow["Data Set1::Data Set2::ITEMNUM"]</expression>
                    <expression name="rightExpression">dataSetRow["ITEMNUM"]</expression>
                </structure>
            </list-property>
        </joint-data-set>
        <script-data-set name="Data Set32" id="11148">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">1</property>
                    <property name="name">LOC</property>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">DESCRIPTION</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">LOC</property>
                </structure>
                <structure>
                    <property name="columnName">DESCRIPTION</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">LOC</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">DESCRIPTION</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">maximoDataSource</property>
            <method name="open"><![CDATA[maximoDataSet = MXReportDataSetProvider.create(this.getDataSource().getName(), this.getName());
	maximoDataSet.open();
	
	var sqlText = new String();

	sqlText =  " select locations.idinextsystem loc, locations.description from maximo.locations "
 +" left join maximo.locationspec on locationspec.location = locations.location "
 +" and locations.siteid = locationspec.siteid "
 +" where locations.siteid = " + params["mroSite"] + " and locationspec.assetattrid = 'TIP_PREDPR' and locationspec.numvalue = 4 and locations.location = 'PRED_"+params["ech"]+"'"
 +" and locations.description like 'ЭЧ-%' "


;

	maximoDataSet.setQuery(sqlText);]]></method>
            <method name="fetch"><![CDATA[if (!maximoDataSet.fetch())
	   return (false);

row["LOC"] = maximoDataSet.getString("LOC");
row["DESCRIPTION"] = maximoDataSet.getString("DESCRIPTION");


return (true);]]></method>
        </script-data-set>
    </data-sets>
    <cubes>
        <tabular-cube name="Data Cube" id="10917">
            <property name="dimensions">
                <tabular-dimension name="Group" id="10918">
                    <property name="defaultHierarchy">NewTabularHierarchy</property>
                    <property name="hierarchies">
                        <tabular-hierarchy name="NewTabularHierarchy" id="10919">
                            <property name="levels">
                                <tabular-level name="Data Set4::ECHE" id="10920">
                                    <property name="dataType">string</property>
                                    <property name="columnName">Data Set4::ECHE</property>
                                </tabular-level>
                            </property>
                        </tabular-hierarchy>
                    </property>
                </tabular-dimension>
                <tabular-dimension name="Group1" id="10921">
                    <property name="defaultHierarchy">NewTabularHierarchy1</property>
                    <property name="hierarchies">
                        <tabular-hierarchy name="NewTabularHierarchy1" id="10922">
                            <property name="levels">
                                <tabular-level name="Model" id="10923">
                                    <property name="dataType">string</property>
                                    <property name="columnName">Model</property>
                                </tabular-level>
                            </property>
                        </tabular-hierarchy>
                    </property>
                </tabular-dimension>
                <tabular-dimension name="Group2" id="11151">
                    <property name="defaultHierarchy">NewTabularHierarchy2</property>
                    <property name="hierarchies">
                        <tabular-hierarchy name="NewTabularHierarchy2" id="11152">
                            <property name="levels">
                                <tabular-level name="Data Set4::IDECHE" id="11153">
                                    <property name="dataType">integer</property>
                                    <property name="columnName">Data Set4::IDECHE</property>
                                </tabular-level>
                            </property>
                        </tabular-hierarchy>
                    </property>
                </tabular-dimension>
            </property>
            <property name="measureGroups">
                <tabular-measure-group name="Summary Field" id="10924">
                    <property name="measures">
                        <tabular-measure name="CNT" id="10925">
                            <expression name="measureExpression">dataSetRow["CNT"]</expression>
                            <property name="dataType">integer</property>
                        </tabular-measure>
                        <tabular-measure name="COUNT" id="10926">
                            <expression name="measureExpression">dataSetRow["COUNT"]</expression>
                            <property name="dataType">integer</property>
                        </tabular-measure>
                        <tabular-measure name="delta" id="11079">
                            <property name="function">sum</property>
                            <expression name="measureExpression">dataSetRow["CNT"]-dataSetRow["COUNT"]</expression>
                            <property name="dataType">integer</property>
                        </tabular-measure>
                        <tabular-measure name="%%" id="11080">
                            <property name="function">sum</property>
                            <expression name="measureExpression">if (dataSetRow["COUNT"] == 0)  (0)
else (dataSetRow["CNT"]/dataSetRow["COUNT"]*100)</expression>
                            <property name="dataType">string</property>
                        </tabular-measure>
                    </property>
                </tabular-measure-group>
            </property>
            <property name="dataSet">Data Set5</property>
        </tabular-cube>
    </cubes>
    <page-setup>
        <simple-master-page name="maximoLandscape" id="47" extends="MaximoSystemLibrary.maximoLandscape">
            <property name="type">a4</property>
            <property name="leftMargin">0.0625in</property>
            <property name="rightMargin">0.0625in</property>
            <overridden-values>
                <ref-entry baseId="304" name="NewGrid2" id="304">
                    <list-property name="visibility">
                        <structure>
                            <property name="format">all</property>
                            <expression name="valueExpr">true</expression>
                        </structure>
                    </list-property>
                </ref-entry>
                <ref-entry baseId="305" id="305"/>
                <ref-entry baseId="306" id="306"/>
                <ref-entry baseId="307" id="307"/>
                <ref-entry baseId="308" id="308"/>
                <ref-entry baseId="340" name="NewImage1" id="340">
                    <list-property name="visibility">
                        <structure>
                            <property name="format">all</property>
                            <expression name="valueExpr">true</expression>
                        </structure>
                    </list-property>
                </ref-entry>
                <ref-entry baseId="309" id="309"/>
                <ref-entry baseId="310" name="NewImage" id="310">
                    <list-property name="visibility">
                        <structure>
                            <property name="format">all</property>
                            <expression name="valueExpr">true</expression>
                        </structure>
                    </list-property>
                </ref-entry>
                <ref-entry baseId="322" name="NewGrid" id="322"/>
                <ref-entry baseId="323" id="323"/>
                <ref-entry baseId="324" id="324"/>
                <ref-entry baseId="325" id="325"/>
                <ref-entry baseId="326" id="326"/>
                <ref-entry baseId="328" name="NewText" id="328">
                    <list-property name="visibility">
                        <structure>
                            <property name="format">all</property>
                            <expression name="valueExpr">true</expression>
                        </structure>
                    </list-property>
                </ref-entry>
                <ref-entry baseId="327" id="327"/>
                <ref-entry baseId="329" name="NewGrid1" id="329"/>
                <ref-entry baseId="330" id="330"/>
                <ref-entry baseId="331" id="331"/>
                <ref-entry baseId="332" id="332"/>
                <ref-entry baseId="333" id="333"/>
                <ref-entry baseId="334" id="334"/>
                <ref-entry baseId="335" name="NewAutoText" id="335"/>
                <ref-entry baseId="336" id="336"/>
                <ref-entry baseId="337" name="NewText1" id="337"/>
                <ref-entry baseId="338" id="338"/>
                <ref-entry baseId="339" name="NewAutoText1" id="339"/>
            </overridden-values>
        </simple-master-page>
    </page-setup>
    <body>
        <data id="10181">
            <property name="fontSize">medium</property>
            <property name="fontWeight">bold</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">Column Binding</property>
                    <expression name="expression">if ( params["mroSite"] == 1 ) {
     "Загрузка ЕТБ-Э Октябрьской ЖД";
} else if ( params["mroSite"] == 24 ) {
     "Загрузка ЕТБ-Э Горьковской ЖД";
} else if ( params["mroSite"] == 61 ) {
     "Загрузка ЕТБ-Э Приволжской ЖД";
} else if ( params["mroSite"] == 10 ) {
     "Загрузка ЕТБ-Э Калининградской ЖД";
} else if ( params["mroSite"] == 17 ) {
     "Загрузка ЕТБ-Э Московской ЖД";
} else if ( params["mroSite"] == 28 ) {
     "Загрузка ЕТБ-Э Северной ЖД";
} else if ( params["mroSite"] == 51 ) {
     "Загрузка ЕТБ-Э Северо-Кавказской ЖД";
} else if ( params["mroSite"] == 58 ) {
     "Загрузка ЕТБ-Э Юго-Восточной ЖД";
} else if ( params["mroSite"] == 63 ) {
     "Загрузка ЕТБ-Э Куйбышевской ЖД";
} else if ( params["mroSite"] == 76 ) {
     "Загрузка ЕТБ-Э Свердловской ЖД";
} else if ( params["mroSite"] == 80 ) {
     "Загрузка ЕТБ-Э Южно-Уральской ЖД";
} else if ( params["mroSite"] == 83 ) {
     "Загрузка ЕТБ-Э Западно-Сибирской ЖД";
} else if ( params["mroSite"] == 88 ) {
     "Загрузка ЕТБ-Э Красноярской ЖД";
} else if ( params["mroSite"] == 92 ) {
     "Загрузка ЕТБ-Э Восточно-Сибирской ЖД";
} else if ( params["mroSite"] == 94 ) {
     "Загрузка ЕТБ-Э Забайкальской ЖД";
} else if ( params["mroSite"] == 96 ) {
     "Загрузка ЕТБ-Э Дальневосточной ЖД";
}</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <property name="resultSetColumn">Column Binding</property>
        </data>
        <data id="11149">
            <property name="fontSize">medium</property>
            <property name="fontWeight">bold</property>
            <property name="dataSet">Data Set32</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">DESCRIPTION</property>
                    <property name="displayName">DESCRIPTION</property>
                    <expression name="expression">"на " + dataSetRow["DESCRIPTION"] + " по ЭЧС"</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <property name="resultSetColumn">DESCRIPTION</property>
        </data>
        <extended-item extensionName="Crosstab" extensionVersion="2.3.0" id="11081">
            <property name="emptyCellValue">0</property>
            <property name="measures">
                <extended-item extensionName="MeasureView" id="11092">
                    <property name="measure">CNT</property>
                    <property name="detail">
                        <extended-item extensionName="AggregationCell" id="11093">
                            <property name="aggregationOnRow">Group1/Model</property>
                            <property name="aggregationOnColumn">Group2/Data Set4::IDECHE</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="11094">
                                    <property name="resultSetColumn">CNT_Group1/Model_Group2/Data Set4::IDECHE</property>
                                </data>
                            </property>
                        </extended-item>
                    </property>
                    <property name="aggregations">
                        <extended-item extensionName="AggregationCell" id="11124">
                            <property name="aggregationOnRow">Group1/Model</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">medium</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="11125">
                                    <property name="resultSetColumn">CNT_Group1/Model</property>
                                </data>
                            </property>
                        </extended-item>
                        <extended-item extensionName="AggregationCell" id="11126">
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="11127">
                                    <property name="resultSetColumn">CNT</property>
                                </data>
                            </property>
                        </extended-item>
                        <extended-item extensionName="AggregationCell" id="11177">
                            <property name="aggregationOnColumn">Group2/Data Set4::IDECHE</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">medium</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="11178">
                                    <property name="resultSetColumn">CNT_Group2/Data Set4::IDECHE</property>
                                </data>
                            </property>
                        </extended-item>
                    </property>
                    <property name="header">
                        <extended-item extensionName="CrosstabCell" id="11095">
                            <property name="content">
                                <label id="11096">
                                    <property name="fontWeight">bold</property>
                                    <text-property name="text">ЕТБ</text-property>
                                </label>
                            </property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                        </extended-item>
                    </property>
                </extended-item>
                <extended-item extensionName="MeasureView" id="11097">
                    <property name="measure">COUNT</property>
                    <property name="detail">
                        <extended-item extensionName="AggregationCell" id="11098">
                            <property name="aggregationOnRow">Group1/Model</property>
                            <property name="aggregationOnColumn">Group2/Data Set4::IDECHE</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="11099">
                                    <property name="resultSetColumn">COUNT_Group1/Model_Group2/Data Set4::IDECHE</property>
                                </data>
                            </property>
                        </extended-item>
                    </property>
                    <property name="aggregations">
                        <extended-item extensionName="AggregationCell" id="11129">
                            <property name="aggregationOnRow">Group1/Model</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="11130">
                                    <property name="resultSetColumn">COUNT_Group1/Model</property>
                                </data>
                            </property>
                        </extended-item>
                        <extended-item extensionName="AggregationCell" id="11131">
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="11132">
                                    <property name="resultSetColumn">COUNT</property>
                                </data>
                            </property>
                        </extended-item>
                        <extended-item extensionName="AggregationCell" id="11179">
                            <property name="aggregationOnColumn">Group2/Data Set4::IDECHE</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">medium</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="11180">
                                    <property name="resultSetColumn">COUNT_Group2/Data Set4::IDECHE</property>
                                </data>
                            </property>
                        </extended-item>
                    </property>
                    <property name="header">
                        <extended-item extensionName="CrosstabCell" id="11100">
                            <property name="content">
                                <label id="11101">
                                    <property name="fontWeight">bold</property>
                                    <text-property name="text">АСУЭ</text-property>
                                </label>
                            </property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                        </extended-item>
                    </property>
                </extended-item>
                <extended-item extensionName="MeasureView" id="11107">
                    <property name="measure">%%</property>
                    <property name="detail">
                        <extended-item extensionName="AggregationCell" id="11108">
                            <property name="aggregationOnRow">Group1/Model</property>
                            <property name="aggregationOnColumn">Group2/Data Set4::IDECHE</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="11109">
                                    <property name="resultSetColumn">%%_Group1/Model_Group2/Data Set4::IDECHE</property>
                                </data>
                            </property>
                        </extended-item>
                    </property>
                    <property name="aggregations">
                        <extended-item extensionName="AggregationCell" id="11133">
                            <property name="aggregationOnRow">Group1/Model</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="11141">
                                    <property name="resultSetColumn">Column Binding</property>
                                </data>
                            </property>
                        </extended-item>
                        <extended-item extensionName="AggregationCell" id="11135">
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="11147">
                                    <property name="resultSetColumn">Column Binding_4</property>
                                </data>
                            </property>
                        </extended-item>
                        <extended-item extensionName="AggregationCell" id="11181">
                            <property name="aggregationOnColumn">Group2/Data Set4::IDECHE</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">medium</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="11187">
                                    <property name="resultSetColumn">Column Binding_6</property>
                                </data>
                            </property>
                        </extended-item>
                    </property>
                    <property name="header">
                        <extended-item extensionName="CrosstabCell" id="11110">
                            <property name="content">
                                <label id="11111">
                                    <property name="fontWeight">bold</property>
                                    <text-property name="text">%%</text-property>
                                </label>
                            </property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                        </extended-item>
                    </property>
                </extended-item>
                <extended-item extensionName="MeasureView" id="11102">
                    <property name="measure">delta</property>
                    <property name="detail">
                        <extended-item extensionName="AggregationCell" id="11103">
                            <property name="aggregationOnRow">Group1/Model</property>
                            <property name="aggregationOnColumn">Group2/Data Set4::IDECHE</property>
                            <property name="backgroundColor">#91F38B</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <list-property name="highlightRules">
                                <structure>
                                    <property name="operator">not-in</property>
                                    <expression name="testExpr">data["delta_Group1/Model_Group/Data Set4::ECHE"]</expression>
                                    <simple-property-list name="value1">
                                        <value>0</value>
                                        <value>null</value>
                                    </simple-property-list>
                                    <property name="backgroundColor">#F3F18B</property>
                                </structure>
                            </list-property>
                            <property name="content">
                                <data id="11104">
                                    <property name="resultSetColumn">delta_Group1/Model_Group2/Data Set4::IDECHE</property>
                                </data>
                            </property>
                        </extended-item>
                    </property>
                    <property name="aggregations">
                        <extended-item extensionName="AggregationCell" id="11137">
                            <property name="aggregationOnRow">Group1/Model</property>
                            <property name="backgroundColor">#91F38B</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <list-property name="highlightRules">
                                <structure>
                                    <property name="operator">not-in</property>
                                    <expression name="testExpr">data["delta_Group1/Model"]</expression>
                                    <simple-property-list name="value1">
                                        <value>0</value>
                                        <value>null</value>
                                    </simple-property-list>
                                    <property name="backgroundColor">#F3F18B</property>
                                </structure>
                            </list-property>
                            <property name="content">
                                <data id="11138">
                                    <property name="resultSetColumn">delta_Group1/Model</property>
                                </data>
                            </property>
                        </extended-item>
                        <extended-item extensionName="AggregationCell" id="11139">
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="11140">
                                    <property name="backgroundColor">#91F38B</property>
                                    <list-property name="highlightRules">
                                        <structure>
                                            <property name="operator">not-in</property>
                                            <property name="backgroundColor">#F3F18B</property>
                                            <expression name="testExpr">data["delta"]</expression>
                                            <simple-property-list name="value1">
                                                <value>0</value>
                                                <value>null</value>
                                            </simple-property-list>
                                        </structure>
                                    </list-property>
                                    <property name="resultSetColumn">delta</property>
                                </data>
                                <data id="11145">
                                    <property name="backgroundColor">#91F38B</property>
                                    <list-property name="highlightRules">
                                        <structure>
                                            <property name="operator">not-in</property>
                                            <property name="backgroundColor">#F3F18B</property>
                                            <expression name="testExpr">data["Column Binding_2"]</expression>
                                            <simple-property-list name="value1">
                                                <value>0</value>
                                                <value>null</value>
                                            </simple-property-list>
                                        </structure>
                                    </list-property>
                                    <property name="resultSetColumn">Column Binding_2</property>
                                </data>
                            </property>
                        </extended-item>
                        <extended-item extensionName="AggregationCell" id="11183">
                            <property name="aggregationOnColumn">Group2/Data Set4::IDECHE</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">medium</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                            <property name="content">
                                <data id="11184">
                                    <property name="backgroundColor">#91F38B</property>
                                    <list-property name="highlightRules">
                                        <structure>
                                            <property name="operator">not-in</property>
                                            <property name="backgroundColor">#F3F18B</property>
                                            <expression name="testExpr">data["delta_Group2/Data Set4::IDECHE"]</expression>
                                            <simple-property-list name="value1">
                                                <value>0</value>
                                                <value>null</value>
                                            </simple-property-list>
                                        </structure>
                                    </list-property>
                                    <property name="resultSetColumn">delta_Group2/Data Set4::IDECHE</property>
                                </data>
                                <data id="11186">
                                    <property name="backgroundColor">#91F38B</property>
                                    <list-property name="highlightRules">
                                        <structure>
                                            <property name="operator">not-in</property>
                                            <property name="backgroundColor">#F3F18B</property>
                                            <expression name="testExpr">data["Column Binding_5"]</expression>
                                            <simple-property-list name="value1">
                                                <value>0</value>
                                                <value>null</value>
                                            </simple-property-list>
                                        </structure>
                                    </list-property>
                                    <property name="resultSetColumn">Column Binding_5</property>
                                </data>
                            </property>
                        </extended-item>
                    </property>
                    <property name="header">
                        <extended-item extensionName="CrosstabCell" id="11105">
                            <property name="content">
                                <label id="11106">
                                    <property name="fontWeight">bold</property>
                                    <text-property name="text">Δ</text-property>
                                </label>
                            </property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                        </extended-item>
                    </property>
                </extended-item>
            </property>
            <property name="rows">
                <extended-item extensionName="CrosstabView" id="11083">
                    <property name="grandTotal">
                        <extended-item extensionName="CrosstabCell" id="11113">
                            <property name="content">
                                <label id="11122">
                                    <property name="fontWeight">bold</property>
                                    <text-property name="text">Итого (лишних)</text-property>
                                </label>
                                <label id="11150">
                                    <property name="fontWeight">bold</property>
                                    <text-property name="text">Итого (незагруженных)</text-property>
                                </label>
                            </property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">medium</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                        </extended-item>
                    </property>
                    <property name="views">
                        <extended-item extensionName="DimensionView" id="11088">
                            <property name="dimension">Group1</property>
                            <property name="levels">
                                <extended-item extensionName="LevelView" name="NewLevel View1" id="11089">
                                    <property name="level">Group1/Model</property>
                                    <property name="member">
                                        <extended-item extensionName="CrosstabCell" id="11090">
                                            <property name="content">
                                                <data name="Model" id="11091">
                                                    <property name="fontWeight">bold</property>
                                                    <property name="resultSetColumn">Model</property>
                                                </data>
                                            </property>
                                            <property name="borderTopStyle">solid</property>
                                            <property name="borderTopWidth">thin</property>
                                            <property name="borderTopColor">#000000</property>
                                            <property name="borderLeftStyle">solid</property>
                                            <property name="borderLeftWidth">thin</property>
                                            <property name="borderLeftColor">#000000</property>
                                            <property name="borderBottomStyle">solid</property>
                                            <property name="borderBottomWidth">thin</property>
                                            <property name="borderBottomColor">#000000</property>
                                            <property name="borderRightStyle">solid</property>
                                            <property name="borderRightWidth">thin</property>
                                            <property name="borderRightColor">#000000</property>
                                        </extended-item>
                                    </property>
                                </extended-item>
                            </property>
                        </extended-item>
                    </property>
                </extended-item>
            </property>
            <property name="columns">
                <extended-item extensionName="CrosstabView" id="11112">
                    <property name="grandTotal">
                        <extended-item extensionName="CrosstabCell" id="11123">
                            <property name="content">
                                <label id="11128">
                                    <property name="fontWeight">bold</property>
                                    <property name="textAlign">center</property>
                                    <text-property name="text">Итого</text-property>
                                </label>
                            </property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">thin</property>
                            <property name="borderTopColor">#000000</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">thin</property>
                            <property name="borderLeftColor">#000000</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">thin</property>
                            <property name="borderBottomColor">#000000</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">thin</property>
                            <property name="borderRightColor">#000000</property>
                        </extended-item>
                    </property>
                    <property name="views">
                        <extended-item extensionName="DimensionView" id="11084">
                            <property name="dimension">Group</property>
                            <property name="levels">
                                <extended-item extensionName="LevelView" name="NewLevel View" id="11085">
                                    <property name="level">Group/Data Set4::ECHE</property>
                                    <property name="member">
                                        <extended-item extensionName="CrosstabCell" id="11086">
                                            <property name="content">
                                                <data name="Data Set4::ECHE" id="11087">
                                                    <property name="fontWeight">bold</property>
                                                    <property name="textAlign">center</property>
                                                    <property name="resultSetColumn">Data Set4::ECHE</property>
                                                    <structure name="action">
                                                        <property name="linkType">drill-through</property>
                                                        <property name="reportName">asue-etb-echs-det.rptdesign</property>
                                                        <property name="targetWindow">_blank</property>
                                                        <property name="targetFileType">report-design</property>
                                                        <list-property name="paramBindings">
                                                            <structure>
                                                                <property name="paramName">mroSite</property>
                                                                <expression name="expression">params["mroSite"].value</expression>
                                                            </structure>
                                                            <structure>
                                                                <property name="paramName">podr</property>
                                                                <expression name="expression">data["Data Set4::IDECHE"]</expression>
                                                            </structure>
                                                            <structure>
                                                                <property name="paramName">appname</property>
                                                                <expression name="expression">"ASSET_E"</expression>
                                                            </structure>
                                                            <structure>
                                                                <property name="paramName">where</property>
                                                                <expression name="expression">"1=1"</expression>
                                                            </structure>
                                                        </list-property>
                                                    </structure>
                                                </data>
                                            </property>
                                            <property name="borderTopStyle">solid</property>
                                            <property name="borderTopWidth">thin</property>
                                            <property name="borderTopColor">#000000</property>
                                            <property name="borderLeftStyle">solid</property>
                                            <property name="borderLeftWidth">thin</property>
                                            <property name="borderLeftColor">#000000</property>
                                            <property name="borderRightStyle">solid</property>
                                            <property name="borderRightWidth">thin</property>
                                            <property name="borderRightColor">#000000</property>
                                        </extended-item>
                                    </property>
                                </extended-item>
                            </property>
                        </extended-item>
                        <extended-item extensionName="DimensionView" id="11174">
                            <property name="dimension">Group2</property>
                            <property name="levels">
                                <extended-item extensionName="LevelView" name="NewLevel View2" id="11175">
                                    <property name="level">Group2/Data Set4::IDECHE</property>
                                    <property name="member">
                                        <extended-item extensionName="CrosstabCell" id="11176">
                                            <property name="content">
                                                <data name="Data Set4::IDECHE" id="11185">
                                                    <list-property name="visibility">
                                                        <structure>
                                                            <property name="format">all</property>
                                                            <expression name="valueExpr">true</expression>
                                                        </structure>
                                                    </list-property>
                                                    <property name="resultSetColumn">Data Set4::IDECHE</property>
                                                </data>
                                            </property>
                                        </extended-item>
                                    </property>
                                </extended-item>
                            </property>
                        </extended-item>
                    </property>
                </extended-item>
            </property>
            <property name="header">
                <extended-item extensionName="CrosstabCell" id="11082">
                    <property name="borderTopStyle">solid</property>
                    <property name="borderTopWidth">thin</property>
                    <property name="borderTopColor">#000000</property>
                    <property name="borderLeftStyle">solid</property>
                    <property name="borderLeftWidth">thin</property>
                    <property name="borderLeftColor">#000000</property>
                    <property name="borderBottomStyle">solid</property>
                    <property name="borderBottomWidth">thin</property>
                    <property name="borderBottomColor">#000000</property>
                    <property name="borderRightStyle">solid</property>
                    <property name="borderRightWidth">thin</property>
                    <property name="borderRightColor">#000000</property>
                </extended-item>
            </property>
            <property name="cube">Data Cube</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">Data Set4::ECHE</property>
                    <expression name="expression">dimension["Group"]["Data Set4::ECHE"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Model</property>
                    <expression name="expression">dimension["Group1"]["Model"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">CNT_Group1/Model</property>
                    <expression name="expression">measure["CNT"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">COUNT_Group1/Model</property>
                    <expression name="expression">measure["COUNT"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">delta_Group1/Model</property>
                    <expression name="expression">measure["delta"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">%%_Group1/Model</property>
                    <expression name="expression">measure["%%"]</expression>
                    <property name="dataType">string</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">CNT_Group1/Model_Group/Data Set4::ECHE</property>
                    <expression name="expression">measure["CNT"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                        <value>Group/Data Set4::ECHE</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">COUNT_Group1/Model_Group/Data Set4::ECHE</property>
                    <expression name="expression">measure["COUNT"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                        <value>Group/Data Set4::ECHE</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">delta_Group1/Model_Group/Data Set4::ECHE</property>
                    <expression name="expression">measure["delta"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                        <value>Group/Data Set4::ECHE</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">%%_Group1/Model_Group/Data Set4::ECHE</property>
                    <expression name="expression">measure["%%"]</expression>
                    <property name="dataType">string</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                        <value>Group/Data Set4::ECHE</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">CNT_Group/Data Set4::ECHE</property>
                    <expression name="expression">measure["CNT"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group/Data Set4::ECHE</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">COUNT_Group/Data Set4::ECHE</property>
                    <expression name="expression">measure["COUNT"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group/Data Set4::ECHE</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">%%_Group/Data Set4::ECHE</property>
                    <expression name="expression">measure["%%"]</expression>
                    <property name="dataType">string</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group/Data Set4::ECHE</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">delta_Group/Data Set4::ECHE</property>
                    <expression name="expression">measure["delta"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group/Data Set4::ECHE</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">CNT</property>
                    <expression name="expression">measure["CNT"]</expression>
                    <property name="dataType">integer</property>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">COUNT</property>
                    <expression name="expression">measure["COUNT"]</expression>
                    <property name="dataType">integer</property>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">%%</property>
                    <expression name="expression">measure["%%"]</expression>
                    <property name="dataType">string</property>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">delta</property>
                    <property name="dataType">integer</property>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">measure["delta"]</expression>
                        </structure>
                    </list-property>
                    <expression name="filterExpr">if (measure["delta"] > 0 ) {measure["delta"]}</expression>
                </structure>
                <structure>
                    <property name="name">Column Binding</property>
                    <expression name="expression">if (data["COUNT_Group1/Model"] == 0) (0)
else (data["CNT_Group1/Model"]/data["COUNT_Group1/Model"]*100)</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">Aggregation</property>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group/Data Set4::ECHE</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">measure["delta"]</expression>
                        </structure>
                    </list-property>
                    <expression name="filterExpr">if (measure["delta"] >= 0 ) {measure["delta"]}</expression>
                </structure>
                <structure>
                    <property name="name">Column Binding_1</property>
                    <expression name="expression">data["CNT_Group/Data Set4::ECHE"]-data["Aggregation"]-data["COUNT_Group/Data Set4::ECHE"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">Column Binding_2</property>
                    <expression name="expression">data["CNT"]-data["delta"]-data["COUNT"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">Column Binding_3</property>
                    <expression name="expression">if (data["COUNT_Group/Data Set4::ECHE"] == 0) (0)
else ((data["CNT_Group/Data Set4::ECHE"]-data["delta_Group/Data Set4::ECHE"])/data["COUNT_Group/Data Set4::ECHE"]*100)</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">Column Binding_4</property>
                    <expression name="expression">if (data["COUNT"] == 0) (0)
else ((data["CNT"]-data["delta"])/data["COUNT"]*100)</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">delta_Group/Data Set4::ECHE_1</property>
                    <expression name="expression">measure["delta"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group/Data Set4::ECHE</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                </structure>
                <structure>
                    <property name="name">Data Set4::IDECHE</property>
                    <expression name="expression">dimension["Group2"]["Data Set4::IDECHE"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">CNT_Group2/Data Set4::IDECHE</property>
                    <expression name="expression">measure["CNT"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group2/Data Set4::IDECHE</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">COUNT_Group2/Data Set4::IDECHE</property>
                    <expression name="expression">measure["COUNT"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group2/Data Set4::IDECHE</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">%%_Group2/Data Set4::IDECHE</property>
                    <expression name="expression">measure["%%"]</expression>
                    <property name="dataType">string</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group2/Data Set4::IDECHE</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">delta_Group2/Data Set4::IDECHE</property>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group2/Data Set4::IDECHE</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">measure["delta"]</expression>
                        </structure>
                    </list-property>
                    <expression name="filterExpr">if (measure["delta"] >= 0 ) {measure["delta"]}</expression>
                </structure>
                <structure>
                    <property name="name">CNT_Group1/Model_Group2/Data Set4::IDECHE</property>
                    <expression name="expression">measure["CNT"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                        <value>Group2/Data Set4::IDECHE</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">COUNT_Group1/Model_Group2/Data Set4::IDECHE</property>
                    <expression name="expression">measure["COUNT"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                        <value>Group2/Data Set4::IDECHE</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">%%_Group1/Model_Group2/Data Set4::IDECHE</property>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                        <value>Group2/Data Set4::IDECHE</value>
                    </simple-property-list>
                    <property name="aggregateFunction">SUM</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value">measure["%%"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">delta_Group1/Model_Group2/Data Set4::IDECHE</property>
                    <expression name="expression">measure["delta"]</expression>
                    <property name="dataType">integer</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group1/Model</value>
                        <value>Group2/Data Set4::IDECHE</value>
                    </simple-property-list>
                    <property name="aggregateFunction">sum</property>
                </structure>
                <structure>
                    <property name="name">Column Binding_5</property>
                    <expression name="expression">data["CNT_Group/Data Set4::ECHE"]-data["Aggregation"]-data["COUNT_Group/Data Set4::ECHE"]</expression>
                    <property name="dataType">integer</property>
                </structure>
                <structure>
                    <property name="name">Column Binding_6</property>
                    <expression name="expression">if (data["COUNT_Group/Data Set4::ECHE"] == 0) (0)
else ((data["CNT_Group/Data Set4::ECHE"]-data["delta_Group/Data Set4::ECHE"])/data["COUNT_Group/Data Set4::ECHE"]*100)</expression>
                    <property name="dataType">integer</property>
                </structure>
            </list-property>
        </extended-item>
    </body>
</report>
